"use strict";(()=>{var Bn=Object.create;var St=Object.defineProperty,_n=Object.defineProperties,On=Object.getOwnPropertyDescriptor,Un=Object.getOwnPropertyDescriptors,Pn=Object.getOwnPropertyNames,Wt=Object.getOwnPropertySymbols,Cn=Object.getPrototypeOf,Vt=Object.prototype.hasOwnProperty,Rn=Object.prototype.propertyIsEnumerable;var qt=(t,e,n)=>e in t?St(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,It=(t,e)=>{for(var n in e||(e={}))Vt.call(e,n)&&qt(t,n,e[n]);if(Wt)for(var n of Wt(e))Rn.call(e,n)&&qt(t,n,e[n]);return t},bt=(t,e)=>_n(t,Un(e));var Ge=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var $n=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Pn(e))!Vt.call(t,i)&&i!==n&&St(t,i,{get:()=>e[i],enumerable:!(r=On(e,i))||r.enumerable});return t};var zt=(t,e,n)=>(n=t!=null?Bn(Cn(t)):{},$n(e||!t||!t.__esModule?St(n,"default",{value:t,enumerable:!0}):n,t));var ln=Ge((an,ft)=>{((t,e)=>{typeof define=="function"&&define.amd?define([],e):typeof ft=="object"&&ft.exports?ft.exports=e():t.fuzzysort=e()})(an,t=>{"use strict";var e=(p,h)=>{if(!p||!h)return K;var v=y(p);Z(h)||(h=g(h));var S=v.bitflags;return(S&h._bitflags)!==S?K:A(v,h)},n=(p,h,v)=>{if(!p)return v!=null&&v.all?L(h,v):At;var S=y(p),I=S.bitflags,T=S.containsSpace,w=f((v==null?void 0:v.threshold)||0),x=(v==null?void 0:v.limit)||R,b=0,B=0,_=h.length;function fe(ke){b<x?(tt.add(ke),++b):(++B,ke._score>tt.peek()._score&&tt.replaceTop(ke))}if(v!=null&&v.key)for(var ie=v.key,P=0;P<_;++P){var le=h[P],H=_e(le,ie);if(H&&(Z(H)||(H=g(H)),(I&H._bitflags)===I)){var W=A(S,H);W!==K&&(W._score<w||(W.obj=le,fe(W)))}}else if(v!=null&&v.keys){var Oe=v.keys,ye=Oe.length;e:for(var P=0;P<_;++P){var le=h[P];{for(var re=0,O=0;O<ye;++O){var ie=Oe[O],H=_e(le,ie);if(!H){Be[O]=Ye;continue}Z(H)||(H=g(H)),Be[O]=H,re|=H._bitflags}if((I&re)!==I)continue}if(T)for(let k=0;k<S.spaceSearches.length;k++)me[k]=pe;for(var O=0;O<ye;++O){if(H=Be[O],H===Ye){Te[O]=Ye;continue}if(Te[O]=A(S,H,!1,T),Te[O]===K){Te[O]=Ye;continue}if(T)for(let q=0;q<S.spaceSearches.length;q++){if(J[q]>-1e3&&me[q]>pe){var te=(me[q]+J[q])/4;te>me[q]&&(me[q]=te)}J[q]>me[q]&&(me[q]=J[q])}}if(T){for(let k=0;k<S.spaceSearches.length;k++)if(me[k]===pe)continue e}else{var N=!1;for(let k=0;k<ye;k++)if(Te[k]._score!==pe){N=!0;break}if(!N)continue}var ve=new a(ye);for(let k=0;k<ye;k++)ve[k]=Te[k];if(T){var Y=0;for(let k=0;k<S.spaceSearches.length;k++)Y+=me[k]}else{var Y=pe;for(let q=0;q<ye;q++){var W=ve[q];if(W._score>-1e3&&Y>pe){var te=(Y+W._score)/4;te>Y&&(Y=te)}W._score>Y&&(Y=W._score)}}if(ve.obj=le,ve._score=Y,v!=null&&v.scoreFn){if(Y=v.scoreFn(ve),!Y)continue;Y=f(Y),ve._score=Y}Y<w||fe(ve)}}else for(var P=0;P<_;++P){var H=h[P];if(H&&(Z(H)||(H=g(H)),(I&H._bitflags)===I)){var W=A(S,H);W!==K&&(W._score<w||fe(W))}}if(b===0)return At;for(var Ue=new Array(b),P=b-1;P>=0;--P)Ue[P]=tt.poll();return Ue.total=b+B,Ue},r=(p,h="<b>",v="</b>")=>{for(var S=typeof h=="function"?h:void 0,I=p.target,T=I.length,w=p.indexes,x="",b=0,B=0,_=!1,fe=[],ie=0;ie<T;++ie){var P=I[ie];if(w[B]===ie){if(++B,_||(_=!0,S?(fe.push(x),x=""):x+=h),B===w.length){S?(x+=P,fe.push(S(x,b++)),x="",fe.push(I.substr(ie+1))):x+=P+v+I.substr(ie+1);break}}else _&&(_=!1,S?(fe.push(S(x,b++)),x=""):x+=v);x+=P}return S?fe:x},i=p=>{typeof p=="number"?p=""+p:typeof p!="string"&&(p="");var h=X(p);return l(p,{_targetLower:h._lower,_targetLowerCodes:h.lowerCodes,_bitflags:h.bitflags})},o=()=>{Ne.clear(),ge.clear()};class s{get indexes(){return this._indexes.slice(0,this._indexes.len).sort((h,v)=>h-v)}set indexes(h){return this._indexes=h}highlight(h,v){return r(this,h,v)}get score(){return d(this._score)}set score(h){this._score=f(h)}}class a extends Array{get score(){return d(this._score)}set score(h){this._score=f(h)}}var l=(p,h)=>{var S,I,T,w,x,b,B;let v=new s;return v.target=p,v.obj=(S=h.obj)!=null?S:K,v._score=(I=h._score)!=null?I:pe,v._indexes=(T=h._indexes)!=null?T:[],v._targetLower=(w=h._targetLower)!=null?w:"",v._targetLowerCodes=(x=h._targetLowerCodes)!=null?x:K,v._nextBeginningIndexes=(b=h._nextBeginningIndexes)!=null?b:K,v._bitflags=(B=h._bitflags)!=null?B:0,v},d=p=>p===pe?0:p>1?p:Math.E**(((-p+1)**.04307-1)*-2),f=p=>p===0?pe:p>1?p:1-Math.pow(Math.log(p)/-2+1,1/.04307),u=p=>{typeof p=="number"?p=""+p:typeof p!="string"&&(p=""),p=p.trim();var h=X(p),v=[];if(h.containsSpace){var S=p.split(/\s+/);S=[...new Set(S)];for(var I=0;I<S.length;I++)if(S[I]!==""){var T=X(S[I]);v.push({lowerCodes:T.lowerCodes,_lower:S[I].toLowerCase(),containsSpace:!1})}}return{lowerCodes:h.lowerCodes,_lower:h._lower,containsSpace:h.containsSpace,bitflags:h.bitflags,spaceSearches:v}},g=p=>{if(p.length>999)return i(p);var h=Ne.get(p);return h!==void 0||(h=i(p),Ne.set(p,h)),h},y=p=>{if(p.length>999)return u(p);var h=ge.get(p);return h!==void 0||(h=u(p),ge.set(p,h)),h},L=(p,h)=>{var v=[];v.total=p.length;var S=(h==null?void 0:h.limit)||R;if(h!=null&&h.key)for(var I=0;I<p.length;I++){var T=p[I],w=_e(T,h.key);if(w!=K){Z(w)||(w=g(w));var x=l(w.target,{_score:w._score,obj:T});if(v.push(x),v.length>=S)return v}}else if(h!=null&&h.keys)for(var I=0;I<p.length;I++){for(var T=p[I],b=new a(h.keys.length),B=h.keys.length-1;B>=0;--B){var w=_e(T,h.keys[B]);if(!w){b[B]=Ye;continue}Z(w)||(w=g(w)),w._score=pe,w._indexes.len=0,b[B]=w}if(b.obj=T,b._score=pe,v.push(b),v.length>=S)return v}else for(var I=0;I<p.length;I++){var w=p[I];if(w!=K&&(Z(w)||(w=g(w)),w._score=pe,w._indexes.len=0,v.push(w),v.length>=S))return v}return v},A=(p,h,v=!1,S=!1)=>{if(v===!1&&p.containsSpace)return z(p,h,S);for(var I=p._lower,T=p.lowerCodes,w=T[0],x=h._targetLowerCodes,b=T.length,B=x.length,P=0,_=0,fe=0;;){var ie=w===x[_];if(ie){if(he[fe++]=_,++P,P===b)break;w=T[P]}if(++_,_>=B)return K}var P=0,le=!1,H=0,W=h._nextBeginningIndexes;W===K&&(W=h._nextBeginningIndexes=j(h.target)),_=he[0]===0?0:W[he[0]-1];var Oe=0;if(_!==B)for(;;)if(_>=B){if(P<=0||(++Oe,Oe>200))break;--P;var ye=xe[--H];_=W[ye]}else{var ie=T[P]===x[_];if(ie){if(xe[H++]=_,++P,P===b){le=!0;break}++_}else _=W[_]}var re=b<=1?-1:h._targetLower.indexOf(I,he[0]),O=!!~re,te=O?re===0||h._nextBeginningIndexes[re-1]===re:!1;if(O&&!te){for(var N=0;N<W.length;N=W[N])if(!(N<=re)){for(var ve=0;ve<b&&T[ve]===h._targetLowerCodes[N+ve];ve++);if(ve===b){re=N,te=!0;break}}}var Y=k=>{for(var q=0,kt=0,Me=1;Me<b;++Me)k[Me]-k[Me-1]!==1&&(q-=k[Me],++kt);var Nn=k[b-1]-k[0]-(b-1);if(q-=(12+Nn)*kt,k[0]!==0&&(q-=k[0]*k[0]*.2),!le)q*=1e3;else{for(var Tt=1,Me=W[0];Me<B;Me=W[Me])++Tt;Tt>24&&(q*=(Tt-24)*10)}return q-=(B-b)/2,O&&(q/=1+b*b*1),te&&(q/=1+b*b*1),q-=(B-b)/2,q};if(le)if(te){for(var N=0;N<b;++N)he[N]=re+N;var Ue=he,ke=Y(he)}else var Ue=xe,ke=Y(xe);else{if(O)for(var N=0;N<b;++N)he[N]=re+N;var Ue=he,ke=Y(Ue)}h._score=ke;for(var N=0;N<b;++N)h._indexes[N]=Ue[N];h._indexes.len=b;let nt=new s;return nt.target=h.target,nt._score=h._score,nt._indexes=h._indexes,nt},z=(p,h,v)=>{for(var S=new Set,I=0,T=K,w=0,x=p.spaceSearches,b=x.length,B=0,_=()=>{for(let te=B-1;te>=0;te--)h._nextBeginningIndexes[Ie[te*2+0]]=Ie[te*2+1]},fe=!1,O=0;O<b;++O){J[O]=pe;var ie=x[O];if(T=A(ie,h),v){if(T===K)continue;fe=!0}else if(T===K)return _(),K;var P=O===b-1;if(!P){var le=T._indexes,H=!0;for(let N=0;N<le.len-1;N++)if(le[N+1]-le[N]!==1){H=!1;break}if(H){var W=le[le.len-1]+1,Oe=h._nextBeginningIndexes[W-1];for(let N=W-1;N>=0&&Oe===h._nextBeginningIndexes[N];N--)h._nextBeginningIndexes[N]=W,Ie[B*2+0]=N,Ie[B*2+1]=Oe,B++}}I+=T._score/b,J[O]=T._score/b,T._indexes[0]<w&&(I-=(w-T._indexes[0])*2),w=T._indexes[0];for(var ye=0;ye<T._indexes.len;++ye)S.add(T._indexes[ye])}if(v&&!fe)return K;_();var re=A(p,h,!0);if(re!==K&&re._score>I){if(v)for(var O=0;O<b;++O)J[O]=re._score/b;return re}v&&(T=h),T._score=I;var O=0;for(let te of S)T._indexes[O++]=te;return T._indexes.len=O,T},C=p=>p.replace(new RegExp("\\p{Script=Latin}+","gu"),h=>h.normalize("NFD")).replace(/[\u0300-\u036f]/g,""),X=p=>{p=C(p);for(var h=p.length,v=p.toLowerCase(),S=[],I=0,T=!1,w=0;w<h;++w){var x=S[w]=v.charCodeAt(w);if(x===32){T=!0;continue}var b=x>=97&&x<=122?x-97:x>=48&&x<=57?26:x<=127?30:31;I|=1<<b}return{lowerCodes:S,bitflags:I,containsSpace:T,_lower:v}},$=p=>{for(var h=p.length,v=[],S=0,I=!1,T=!1,w=0;w<h;++w){var x=p.charCodeAt(w),b=x>=65&&x<=90,B=b||x>=97&&x<=122||x>=48&&x<=57,_=b&&!I||!T||!B;I=b,T=B,_&&(v[S++]=w)}return v},j=p=>{p=C(p);for(var h=p.length,v=$(p),S=[],I=v[0],T=0,w=0;w<h;++w)I>w?S[w]=I:(I=v[++T],S[w]=I===void 0?h:I);return S},Ne=new Map,ge=new Map,he=[],xe=[],Ie=[],me=[],J=[],Be=[],Te=[],_e=(p,h)=>{var v=p[h];if(v!==void 0)return v;if(typeof h=="function")return h(p);var S=h;Array.isArray(h)||(S=h.split("."));for(var I=S.length,T=-1;p&&++T<I;)p=p[S[T]];return p},Z=p=>typeof p=="object"&&typeof p._bitflags=="number",R=1/0,pe=-R,At=[];At.total=0;var K=null,Ye=i(""),Dn=p=>{var h=[],v=0,S={},I=T=>{for(var w=0,x=h[w],b=1;b<v;){var B=b+1;w=b,B<v&&h[B]._score<h[b]._score&&(w=B),h[w-1>>1]=h[w],b=1+(w<<1)}for(var _=w-1>>1;w>0&&x._score<h[_]._score;_=(w=_)-1>>1)h[w]=h[_];h[w]=x};return S.add=(T=>{var w=v;h[v++]=T;for(var x=w-1>>1;w>0&&T._score<h[x]._score;x=(w=x)-1>>1)h[w]=h[x];h[w]=T}),S.poll=(T=>{if(v!==0){var w=h[0];return h[0]=h[--v],I(),w}}),S.peek=(T=>{if(v!==0)return h[0]}),S.replaceTop=(T=>{h[0]=T,I()}),S},tt=Dn();return{single:e,go:n,prepare:i,cleanup:o}})});var un=Ge((ar,_t)=>{"use strict";var _i=(function(){function t(e,n){var r=[],i=!0,o=!1,s=void 0;try{for(var a=e[Symbol.iterator](),l;!(i=(l=a.next()).done)&&(r.push(l.value),!(n&&r.length===n));i=!0);}catch(d){o=!0,s=d}finally{try{!i&&a.return&&a.return()}finally{if(o)throw s}}return r}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),ct="[\x1B\x9B][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-PRZcf-nqry=><]",dn="\0-\b\v-\x1B\x9B\xAD\u200B\u2028\u2029\uFEFF\uFE00-\uFE0F",Bt=`
`+dn,Oi=new RegExp("(?:"+ct+")|["+dn+"]","g"),Dt=new RegExp("(?:"+ct+")|["+Bt+"]","g"),Nt=new RegExp("((?:"+ct+")|[	"+Bt+"])?([^	"+Bt+"]*)","g");_t.exports={zeroWidthCharacters:Dt,ansiEscapeCodes:new RegExp(ct,"g"),strlen:t=>Array.from(t.replace(Dt,"")).length,isBlank:t=>t.replace(Dt,"").replace(/\s/g,"").length===0,blank:t=>Array.from(t.replace(Oi,"")).map(e=>e==="	"||e===`
`?e:" ").join(""),partition(t){for(var e,n=[];Nt.lastIndex!==t.length&&(e=Nt.exec(t));)n.push([e[1]||"",e[2]]);return Nt.lastIndex=0,n},first(t,e){let n="",r=0;for(let o of _t.exports.partition(t)){var i=_i(o,2);let s=i[0],a=i[1],l=Array.from(a).slice(0,e-r);n+=s+l.join(""),r+=l.length}return n}}});var cn=Ge((lr,fn)=>{var Ui=[{name:"none",borders:{top:{left:"",center:" ",right:"",colSeparator:" "},middle:{left:"",center:" ",right:"",colSeparator:" "},bottom:{left:"",center:" ",right:"",colSeparator:" "},data:{left:"",center:" ",right:"",colSeparator:" "}}},{name:"compact",borders:{top:{left:"",center:"-",right:"",colSeparator:"-"},middle:{left:"",center:"-",right:"",colSeparator:" "},bottom:{left:"",center:"",right:"",colSeparator:""},data:{left:"",center:" ",right:"",colSeparator:" "}}},{name:"ramac",borders:{top:{left:"+",center:"-",right:"+",colSeparator:"+"},middle:{left:"+",center:"-",right:"+",colSeparator:"+"},bottom:{left:"+",center:"-",right:"+",colSeparator:"+"},data:{left:"|",center:" ",right:"|",colSeparator:"|"}}},{name:"ascii-table",borders:{top:{left:".",center:"-",right:".",colSeparator:"-"},middle:{left:"|",center:"-",right:"|",colSeparator:"-"},bottom:{left:".",center:"-",right:".",colSeparator:"-"},data:{left:"|",center:" ",right:"|",colSeparator:"|"}}},{name:"ascii-reStructuredText",borders:{top:{left:"+",center:"-",right:"+",colSeparator:"+"},middle:{left:"+",center:"=",right:"+",colSeparator:"+"},bottom:{left:"+",center:"-",right:"+",colSeparator:"+"},data:{left:"|",center:" ",right:"|",colSeparator:"|"}}},{name:"ascii-reStructuredText-simple",borders:{top:{left:"=",center:"=",right:"=",colSeparator:" "},middle:{left:"=",center:"=",right:"=",colSeparator:" "},bottom:{left:"=",center:"=",right:"=",colSeparator:" "},data:{left:" ",center:" ",right:" ",colSeparator:" "}}},{name:"ascii-dots",borders:{top:{left:".",center:".",right:".",colSeparator:"."},middle:{left:":",center:".",right:":",colSeparator:":"},bottom:{left:":",center:".",right:":",colSeparator:":"},data:{left:":",center:" ",right:":",colSeparator:":"}}},{name:"ascii-rounded",borders:{top:{left:".",center:"-",right:".",colSeparator:"."},middle:{left:":",center:"-",right:":",colSeparator:"+"},bottom:{left:"'",center:"-",right:"'",colSeparator:"'"},data:{left:"|",center:" ",right:"|",colSeparator:"|"}}},{name:"ascii-clean",borders:{top:{left:"",center:"-",right:"",colSeparator:"|"},middle:{left:"",center:"-",right:"",colSeparator:"|"},bottom:{left:"",center:"-",right:"",colSeparator:"|"},data:{left:"",center:" ",right:"",colSeparator:"|"}}},{name:"ascii-girder",borders:{top:{left:"//",center:"=",right:"\\\\",colSeparator:"[]"},middle:{left:"|]",center:"=",right:"[|",colSeparator:"[]"},bottom:{left:"\\\\",center:"=",right:"//",colSeparator:"[]"},data:{left:"||",center:" ",right:"||",colSeparator:"||"}}},{name:"unicode-single",borders:{top:{left:"\u250C",center:"\u2500",right:"\u2510",colSeparator:"\u252C"},middle:{left:"\u251C",center:"\u2500",right:"\u2524",colSeparator:"\u253C"},bottom:{left:"\u2514",center:"\u2500",right:"\u2518",colSeparator:"\u2534"},data:{left:"\u2502",center:" ",right:"\u2502",colSeparator:"\u2502"}}},{name:"unicode-double",borders:{top:{left:"\u2554",center:"\u2550",right:"\u2557",colSeparator:"\u2566"},middle:{left:"\u2560",center:"\u2550",right:"\u2563",colSeparator:"\u256C"},bottom:{left:"\u255A",center:"\u2550",right:"\u255D",colSeparator:"\u2569"},data:{left:"\u2551",center:" ",right:"\u2551",colSeparator:"\u2551"}}},{name:"unicode-mix",borders:{top:{left:"\u2554",center:"\u2550",right:"\u2557",colSeparator:"\u2564"},middle:{left:"\u255F",center:"\u2500",right:"\u2562",colSeparator:"\u253C"},bottom:{left:"\u255A",center:"\u2550",right:"\u255D",colSeparator:"\u2567"},data:{left:"\u2551",center:" ",right:"\u2551",colSeparator:"\u2502"}}},{name:"unicode-round",borders:{top:{left:"\u256D",center:"\u2500",right:"\u256E",colSeparator:"\u252C"},middle:{left:"\u251C",center:"\u2500",right:"\u2524",colSeparator:"\u253C"},bottom:{left:"\u2570",center:"\u2500",right:"\u256F",colSeparator:"\u2534"},data:{left:"\u2502",center:" ",right:"\u2502",colSeparator:"\u2502"}}},{name:"github-markdown",borders:{top:{left:"",center:"",right:"",colSeparator:""},middle:{left:"|",center:"-",right:"|",colSeparator:"|"},bottom:{left:"",center:"",right:"",colSeparator:""},data:{left:"|",center:" ",right:"|",colSeparator:"|"}}},{name:"reddit-markdown",borders:{top:{left:"",center:" ",right:"",colSeparator:" "},middle:{left:"",center:"-",right:"",colSeparator:"|"},bottom:{left:"",center:"",right:"",colSeparator:""},data:{left:"",center:" ",right:"",colSeparator:"|"}}}];fn.exports={styles:Ui}});var hn=Ge((dr,gn)=>{var Q={LEFT:0,RIGHT:1,CENTER:2,AUTO:3},{strlen:se,isBlank:Pi,partition:gt}=un(),{styles:Ci}=cn(),Ot=class t{constructor(e=""){this.styles=Ci,this.clear(),this.setTitle(e)}static isNumeric(e){return!isNaN(parseFloat(e))&&isFinite(e)}static padStart(e,n,r=" "){if(se(e)>=n)return e;{let l=gt(e);var i;if(l.length>0){for(var o=0,s=1;s<l.length;s++)o+=se(l[s][1]);var a=l[0][1];a=r.repeat(n-o-se(a)).concat(a),l[0][1]=a,i="",l.forEach(d=>i+=d[0]+d[1])}else i=r.repeat(n);return i}}static padEnd(e,n,r=" "){if(se(e)>=n)return e;{let l=gt(e);var i="";if(l.length>1){for(var o=0,s=0;s<l.length-2;s++)o+=se(l[s][1]);var a=l[l.length-2][1];a=a.concat(r.repeat(n-o-se(a))),l[l.length-2][1]=a,l.forEach(d=>i+=d[0]+d[1])}else i=e.concat(r.repeat(n-se(e)));return i}}static align(e,n,r,i=" "){let o=""+n;return e==Q.RIGHT?t.padStart(o,r,i):e==Q.LEFT?t.padEnd(o,r,i):e==Q.CENTER?t.padEnd(t.padStart(o,se(o)+Math.floor((r-se(o))/2),i),r,i):t.alignAuto(n,r,i)}static alignLeft(e,n,r=" "){return this.align(Q.LEFT,e,n,r)}static alignRight(e,n,r=" "){return this.align(Q.RIGHT,e,n,r)}static alignCenter(e,n,r=" "){return this.align(Q.CENTER,e,n,r)}static alignAuto(e,n,r=" "){return t.isNumeric(e)?this.alignRight(e,n,r):typeof e=="string"?this.alignLeft(e,n,r):this.alignLeft(e,n,r)}static wordWrap(e,n){let r=gt(String(e));var i="";if(r.length>1)for(var o=0;o<r.length-1;o+=2){let[s,a]=r[o],l=r[o+1][0],d=t.wordWrapBasic(a,n);i+=s+d.split(`
`).join(l+`
`+s)+l}else i=t.wordWrapBasic(e,n);return i}static wordWrapBasic(e,n){e=""+e;for(var i=!1,o="";se(e)>n;){i=!1;for(var s=n-1;s>=0;s--)if(Pi(e.charAt(s))){o+=e.substring(0,s).trimStart()+`
`,e=e.slice(s+1),i=!0;break}i||(o+=e.substring(0,n).trimStart()+`
`,e=e.slice(n))}return o+e.trimStart()}static truncateString(e,n){if(se(e)>n){var i="",o=0;for(let[s,a]of gt(e)){let l=Array.from(a.substring(0,n-3).concat("...")).slice(0,n-o);i+=s+l.join(""),o+=l.length}return i}else return e}static arrayFill(e,n){let r=[];for(var i=0;i<e;i++)r.push(n);return r}static arrayResize(e,n,r){for(;n>e.length;)e.push(r)}setStyle(e){let n=this.styles.find(r=>r.name==e);return this.style=n||this.styles.find(r=>r.name=="ramac"),this}getStyle(){return this.style}getStyles(){return Array.from(this.styles)}addStyle(e){return this.styles.push(e),this}removeBorder(){return this.setStyle("none")}clear(){return this.setStyle("ramac"),this.setTitle(),this.setHeading(),this.clearRows(),this.setTitleAlignCenter(),this.setHeadingAlignCenter(),this.setCellMargin(1),this.dataAlign=void 0,this.colWidths=void 0,this.wrapping=void 0,this.setJustify(!1),this}clearRows(){return this.rows=[],this}setTitle(e=""){return this.title=e,this}getTitle(){return this.title?this.title:""}setTitleAlign(e){return this.titleAlignment=e,this}setTitleAlignLeft(){return this.setTitleAlign(Q.LEFT)}setTitleAlignRight(){return this.setTitleAlign(Q.RIGHT)}setTitleAlignCenter(){return this.setTitleAlign(Q.CENTER)}getTitleAlign(){return this.titleAlignment}setHeading(...e){this.heading=t.arrayFill(e.length);for(var n=0;n<e.length;n++)this.heading[n]=e[n];return this}getHeading(){return Array.from(this.heading)}setHeadingAlign(e){return this.headingAlign=e,this}setHeadingAlignLeft(){return this.setHeadingAlign(Q.LEFT)}setHeadingAlignRight(){return this.setHeadingAlign(Q.RIGHT)}setHeadingAlignCenter(){return this.setHeadingAlign(Q.CENTER)}getHeadingAlign(){return this.headingAlign}addRow(...e){let n=t.arrayFill(e.length);for(var r=0;r<e.length;r++)n[r]=e[r];return this.rows.push(n),this}addNonZeroRow(...e){var n=!0;let r=t.arrayFill(e.length);for(var i=0;i<e.length;i++){let o=e[i];t.isNumeric(o)&&o!=0&&(n=!1),r[i]=e[i]}return n||this.rows.push(r),this}addRowMatrix(e){return e.forEach(n=>this.rows.push(n)),this}getRows(){return Array.from(this.rows)}setCell(e,n,r){this.rows[e-1][n-1]=r}getCell(e,n){return this.getRows()[e-1][n-1]}setWidth(e,n){return this.colWidths?t.arrayResize(this.colWidths,e):this.colWidths=t.arrayFill(e),this.colWidths[e-1]=n,this}getWidth(e){var n;return this.colWidths&&e<=this.colWidths.length&&(n=this.colWidths[e-1]),n}setWidths(e){return this.colWidths=e,this}getWidths(){return this.colWidths?this.colWidths:[]}setCellMargin(e){return this.cellMargin=e,this}getCellMargin(){return this.cellMargin}setAlign(e,n){return this.dataAlign?this.dataAlign.concat(t.arrayFill(e-this.dataAlign.length,Q.AUTO)):this.dataAlign=t.arrayFill(e),this.dataAlign[e-1]=n,this}getAlign(e){var n=Q.AUTO;return this.dataAlign&&e<=this.dataAlign.length&&(n=this.dataAlign[e-1]),n}setAligns(e){return this.dataAlign=Array.from(e),this}getAligns(){return this.dataAlign||(this.getRows().length>0?this.dataAlign=t.arrayFill(this.getRows()[0].length,Q.AUTO):this.dataAlign=[]),Array.from(this.dataAlign)}setAlignLeft(e){return this.setAlign(e,Q.LEFT)}setAlignRight(e){return this.setAlign(e,Q.RIGHT)}setAlignCenter(e){return this.setAlign(e,Q.CENTER)}setWrapped(e,n=!0){return this.wrapping?this.wrapping.concat(t.arrayFill(e-this.wrapping.length,!1)):this.wrapping=t.arrayFill(e,!1),this.wrapping[e-1]=n,this}isWrapped(e){var n=!1;return this.wrapping&&e<=this.wrapping.length&&(n=this.wrapping[e-1]),n}setWrappings(e){return this.wrapping=Array.from(e),this}getWrappings(){return this.wrapping||(this.getRows().length>0?this.wrapping=t.arrayFill(this.getRows()[0].length,!1):this.wrapping=[]),Array.from(this.wrapping)}setJustify(e=!0){return this.justify=e,this}isJustify(){return this.justify?this.justify:!1}transpose(){if(this.getHeading().length==0&&this.getRows().length==0)return this;let e=this.getHeading().length>0?this.getHeading().length:this.getRows()[0].length,n=this.getRows().length,r=t.arrayFill(e),i=this.getHeading().length>0?1:0;for(var o=0;o<r.length;o++){r[o]=t.arrayFill(n+i),this.getHeading().length>0&&(r[o][0]=this.getHeading()[o]);for(var s=i;s<r[0].length;s++)r[o][s]=this.getCell(s+Math.abs(i-1),o+1)}return new t(this.getTitle()).setHeadingAlign(this.getHeadingAlign()).addRowMatrix(r)}toJSON(){return`{
   "title": ${JSON.stringify(this.getTitle())},
   "heading": ${JSON.stringify(this.getHeading())},
   "rows": ${JSON.stringify(this.getRows())},
   "formatting": {
       "titleAlign": ${JSON.stringify(this.getTitleAlign())},
       "headingAlign": ${JSON.stringify(this.getHeadingAlign())},
       "columns": {
           "aligns": ${JSON.stringify(this.getAligns())},
           "widths": ${JSON.stringify(this.getWidths())},
           "wrappings": ${JSON.stringify(this.getWrappings())}
       },
       "justify": ${JSON.stringify(this.isJustify())}
   }
}`}fromJSON(e){return this.clear(),this.setTitle(e.title),this.heading=Array.from(e.heading),this.addRowMatrix(e.rows),this.setTitleAlign(e.formatting.titleAlign),this.setHeadingAlign(e.formatting.headingAlign),this.setAligns(e.formatting.columns.aligns),this.setWidths(e.formatting.columns.widths),this.setWrappings(e.formatting.columns.wrappings),this.setJustify(e.formatting.justify),this}sort(e){return this.rows.sort(e),this}sortColumn(e,n=function(r,i){return r>i?1:-1}){return this.rows.sort(function(r,i){return n(r[e-1],i[e-1])}),this}sortColumnDesc(e){let n=function(r,i){return i>r?1:-1};return this.sortColumn(e,n)}getColumnsWidth(){var e;let n=this.getHeading();n.length>0?e=t.arrayFill(n.length,0):e=t.arrayFill(this.getRows()[0].length,0);for(var r=0;r<n.length;r++){let o="".padStart(this.getCellMargin())+n[r]+"".padStart(this.getCellMargin());se(o)>e[r]&&(e[r]=se(o))}this.getRows().forEach(o=>{for(var s=0;s<o.length;s++){let a="".padStart(this.getCellMargin())+o[s]+"".padStart(this.getCellMargin());se(a)>e[s]&&(e[s]=se(a))}});for(var i=0;i<e.length;i++)this.getWidth(i+1)&&(e[i]=this.getWidth(i+1));return this.isJustify()&&(e=t.arrayFill(e.length,Math.max(...e))),e}getHorizontalLine(e,n){for(var r=e.left,i=0;i<n.length;i++)r+="".padStart(n[i],e.center),i<n.length-1&&(r+=e.colSeparator);return r+=e.right,r=r.trim(),r!=""&&(r=r+`
`),r}getWrappedRows(e){let n=t.arrayFill(e.length);for(var r=1,i=0;i<e.length;i++){let d=e[i];this.getWidth(i+1)&&this.isWrapped(i+1)?(n[i]=t.wordWrap(d,this.getWidth(i+1)-this.getCellMargin()*2).split(`
`),n[i].length>r&&(r=n[i].length)):n[i]=[d]}let o=t.arrayFill(r);for(var s=0;s<r;s++)o[s]=t.arrayFill(e.length,"");for(var a=0;a<e.length;a++)for(var l=0;l<n[a].length;l++)o[l][a]=n[a][l];return o}getHeadingRowTruncated(e,n,r){for(var i=e.left,o=0;o<r.length;o++){let s=""+r[o],a=t.align(this.getHeadingAlign(),s,n[o]-this.getCellMargin()*2);i+="".padStart(this.getCellMargin())+t.truncateString(a,n[o]-this.getCellMargin()*2)+"".padStart(this.getCellMargin()),o<r.length-1&&(i+=e.colSeparator)}return i+=e.right+`
`,i}getHeadingRow(e,n){var r="";return this.getWrappedRows(this.getHeading()).forEach(o=>{r+=this.getHeadingRowTruncated(e,n,o)}),r}getDataRowTruncated(e,n,r){for(var i=e.left,o=0;o<n.length;o++){let s=""+r[o],a=t.align(this.getAlign(o+1),s,n[o]-this.getCellMargin()*2);i+="".padStart(this.getCellMargin())+t.truncateString(a,n[o]-this.getCellMargin()*2)+"".padStart(this.getCellMargin()),o<n.length-1&&(i+=e.colSeparator)}return i+=e.right+`
`,i}getDataRow(e,n,r){var i="";return this.getWrappedRows(r).forEach(s=>{i+=this.getDataRowTruncated(e,n,s)}),i}toString(){let e=this.getColumnsWidth(),n=this.getStyle(),r=e.reduce(function(o,s){return o+s},0)+(e.length-1)*se(n.borders.data.colSeparator);var i="";if(this.getTitle().length>0){i+=n.borders.top.left+"".padStart(r,n.borders.top.center)+n.borders.top.right+`
`,i.trim()==""&&(i=""),i+=n.borders.data.left+t.align(this.getTitleAlign(),this.getTitle(),r)+n.borders.data.right+`
`;let o={left:n.borders.middle.left,right:n.borders.middle.right,center:n.borders.top.center,colSeparator:n.borders.top.colSeparator};(o.center!=""||o.colSeparator!="")&&(i+=this.getHorizontalLine(o,e))}else i+=this.getHorizontalLine(n.borders.top,e);return this.getHeading().length>0&&(i+=this.getHeadingRow(n.borders.data,e),i+=this.getHorizontalLine(n.borders.middle,e)),this.getRows().forEach(o=>{i+=this.getDataRow(n.borders.data,e,o)}),i+=this.getHorizontalLine(n.borders.bottom,e),i}};gn.exports={AsciiTable3:Ot,AlignmentEnum:Q}});var pn=Ge((ur,mn)=>{mn.exports=hn()});var qe=9e15,$e=1e9,Et="0123456789abcdef",ot="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",st="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Lt={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-qe,maxE:qe,crypto:!1},Gt,De,M=!0,lt="[DecimalError] ",Re=lt+"Invalid argument: ",Qt=lt+"Precision limit exceeded",Xt=lt+"crypto unavailable",jt="[object Decimal]",oe=Math.floor,G=Math.pow,Hn=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,kn=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Wn=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Kt=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Se=1e7,F=7,qn=9007199254740991,Vn=ot.length-1,Ft=st.length-1,m={toStringTag:jt};m.absoluteValue=m.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),E(t)};m.ceil=function(){return E(new this.constructor(this),this.e+1,2)};m.clampedTo=m.clamp=function(t,e){var n,r=this,i=r.constructor;if(t=new i(t),e=new i(e),!t.s||!e.s)return new i(NaN);if(t.gt(e))throw Error(Re+e);return n=r.cmp(t),n<0?t:r.cmp(e)>0?e:new i(r)};m.comparedTo=m.cmp=function(t){var e,n,r,i,o=this,s=o.d,a=(t=new o.constructor(t)).d,l=o.s,d=t.s;if(!s||!a)return!l||!d?NaN:l!==d?l:s===a?0:!s^l<0?1:-1;if(!s[0]||!a[0])return s[0]?l:a[0]?-d:0;if(l!==d)return l;if(o.e!==t.e)return o.e>t.e^l<0?1:-1;for(r=s.length,i=a.length,e=0,n=r<i?r:i;e<n;++e)if(s[e]!==a[e])return s[e]>a[e]^l<0?1:-1;return r===i?0:r>i^l<0?1:-1};m.cosine=m.cos=function(){var t,e,n=this,r=n.constructor;return n.d?n.d[0]?(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+F,r.rounding=1,n=zn(r,on(r,n)),r.precision=t,r.rounding=e,E(De==2||De==3?n.neg():n,t,e,!0)):new r(1):new r(NaN)};m.cubeRoot=m.cbrt=function(){var t,e,n,r,i,o,s,a,l,d,f=this,u=f.constructor;if(!f.isFinite()||f.isZero())return new u(f);for(M=!1,o=f.s*G(f.s*f,1/3),!o||Math.abs(o)==1/0?(n=ne(f.d),t=f.e,(o=(t-n.length+1)%3)&&(n+=o==1||o==-2?"0":"00"),o=G(n,1/3),t=oe((t+1)/3)-(t%3==(t<0?-1:2)),o==1/0?n="5e"+t:(n=o.toExponential(),n=n.slice(0,n.indexOf("e")+1)+t),r=new u(n),r.s=f.s):r=new u(o.toString()),s=(t=u.precision)+3;;)if(a=r,l=a.times(a).times(a),d=l.plus(f),r=V(d.plus(f).times(a),d.plus(l),s+2,1),ne(a.d).slice(0,s)===(n=ne(r.d)).slice(0,s))if(n=n.slice(s-3,s+1),n=="9999"||!i&&n=="4999"){if(!i&&(E(a,t+1,0),a.times(a).times(a).eq(f))){r=a;break}s+=4,i=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(E(r,t+1,1),e=!r.times(r).times(r).eq(f));break}return M=!0,E(r,t,u.rounding,e)};m.decimalPlaces=m.dp=function(){var t,e=this.d,n=NaN;if(e){if(t=e.length-1,n=(t-oe(this.e/F))*F,t=e[t],t)for(;t%10==0;t/=10)n--;n<0&&(n=0)}return n};m.dividedBy=m.div=function(t){return V(this,new this.constructor(t))};m.dividedToIntegerBy=m.divToInt=function(t){var e=this,n=e.constructor;return E(V(e,new n(t),0,1,1),n.precision,n.rounding)};m.equals=m.eq=function(t){return this.cmp(t)===0};m.floor=function(){return E(new this.constructor(this),this.e+1,3)};m.greaterThan=m.gt=function(t){return this.cmp(t)>0};m.greaterThanOrEqualTo=m.gte=function(t){var e=this.cmp(t);return e==1||e===0};m.hyperbolicCosine=m.cosh=function(){var t,e,n,r,i,o=this,s=o.constructor,a=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return a;n=s.precision,r=s.rounding,s.precision=n+Math.max(o.e,o.sd())+4,s.rounding=1,i=o.d.length,i<32?(t=Math.ceil(i/3),e=(1/ut(4,t)).toString()):(t=16,e="2.3283064365386962890625e-10"),o=Ve(s,1,o.times(e),new s(1),!0);for(var l,d=t,f=new s(8);d--;)l=o.times(o),o=a.minus(l.times(f.minus(l.times(f))));return E(o,s.precision=n,s.rounding=r,!0)};m.hyperbolicSine=m.sinh=function(){var t,e,n,r,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(e=o.precision,n=o.rounding,o.precision=e+Math.max(i.e,i.sd())+4,o.rounding=1,r=i.d.length,r<3)i=Ve(o,2,i,i,!0);else{t=1.4*Math.sqrt(r),t=t>16?16:t|0,i=i.times(1/ut(5,t)),i=Ve(o,2,i,i,!0);for(var s,a=new o(5),l=new o(16),d=new o(20);t--;)s=i.times(i),i=i.times(a.plus(s.times(l.times(s).plus(d))))}return o.precision=e,o.rounding=n,E(i,e,n,!0)};m.hyperbolicTangent=m.tanh=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+7,r.rounding=1,V(n.sinh(),n.cosh(),r.precision=t,r.rounding=e)):new r(n.s)};m.inverseCosine=m.acos=function(){var t=this,e=t.constructor,n=t.abs().cmp(1),r=e.precision,i=e.rounding;return n!==-1?n===0?t.isNeg()?be(e,r,i):new e(0):new e(NaN):t.isZero()?be(e,r+4,i).times(.5):(e.precision=r+6,e.rounding=1,t=new e(1).minus(t).div(t.plus(1)).sqrt().atan(),e.precision=r,e.rounding=i,t.times(2))};m.inverseHyperbolicCosine=m.acosh=function(){var t,e,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(t=r.precision,e=r.rounding,r.precision=t+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,M=!1,n=n.times(n).minus(1).sqrt().plus(n),M=!0,r.precision=t,r.rounding=e,n.ln()):new r(n)};m.inverseHyperbolicSine=m.asinh=function(){var t,e,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,M=!1,n=n.times(n).plus(1).sqrt().plus(n),M=!0,r.precision=t,r.rounding=e,n.ln())};m.inverseHyperbolicTangent=m.atanh=function(){var t,e,n,r,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(t=o.precision,e=o.rounding,r=i.sd(),Math.max(r,t)<2*-i.e-1?E(new o(i),t,e,!0):(o.precision=n=r-i.e,i=V(i.plus(1),new o(1).minus(i),n+t,1),o.precision=t+4,o.rounding=1,i=i.ln(),o.precision=t,o.rounding=e,i.times(.5))):new o(NaN)};m.inverseSine=m.asin=function(){var t,e,n,r,i=this,o=i.constructor;return i.isZero()?new o(i):(e=i.abs().cmp(1),n=o.precision,r=o.rounding,e!==-1?e===0?(t=be(o,n+4,r).times(.5),t.s=i.s,t):new o(NaN):(o.precision=n+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=n,o.rounding=r,i.times(2)))};m.inverseTangent=m.atan=function(){var t,e,n,r,i,o,s,a,l,d=this,f=d.constructor,u=f.precision,g=f.rounding;if(d.isFinite()){if(d.isZero())return new f(d);if(d.abs().eq(1)&&u+4<=Ft)return s=be(f,u+4,g).times(.25),s.s=d.s,s}else{if(!d.s)return new f(NaN);if(u+4<=Ft)return s=be(f,u+4,g).times(.5),s.s=d.s,s}for(f.precision=a=u+10,f.rounding=1,n=Math.min(28,a/F+2|0),t=n;t;--t)d=d.div(d.times(d).plus(1).sqrt().plus(1));for(M=!1,e=Math.ceil(a/F),r=1,l=d.times(d),s=new f(d),i=d;t!==-1;)if(i=i.times(l),o=s.minus(i.div(r+=2)),i=i.times(l),s=o.plus(i.div(r+=2)),s.d[e]!==void 0)for(t=e;s.d[t]===o.d[t]&&t--;);return n&&(s=s.times(2<<n-1)),M=!0,E(s,f.precision=u,f.rounding=g,!0)};m.isFinite=function(){return!!this.d};m.isInteger=m.isInt=function(){return!!this.d&&oe(this.e/F)>this.d.length-2};m.isNaN=function(){return!this.s};m.isNegative=m.isNeg=function(){return this.s<0};m.isPositive=m.isPos=function(){return this.s>0};m.isZero=function(){return!!this.d&&this.d[0]===0};m.lessThan=m.lt=function(t){return this.cmp(t)<0};m.lessThanOrEqualTo=m.lte=function(t){return this.cmp(t)<1};m.logarithm=m.log=function(t){var e,n,r,i,o,s,a,l,d=this,f=d.constructor,u=f.precision,g=f.rounding,y=5;if(t==null)t=new f(10),e=!0;else{if(t=new f(t),n=t.d,t.s<0||!n||!n[0]||t.eq(1))return new f(NaN);e=t.eq(10)}if(n=d.d,d.s<0||!n||!n[0]||d.eq(1))return new f(n&&!n[0]?-1/0:d.s!=1?NaN:n?0:1/0);if(e)if(n.length>1)o=!0;else{for(i=n[0];i%10===0;)i/=10;o=i!==1}if(M=!1,a=u+y,s=Ce(d,a),r=e?at(f,a+10):Ce(t,a),l=V(s,r,a,1),Qe(l.d,i=u,g))do if(a+=10,s=Ce(d,a),r=e?at(f,a+10):Ce(t,a),l=V(s,r,a,1),!o){+ne(l.d).slice(i+1,i+15)+1==1e14&&(l=E(l,u+1,0));break}while(Qe(l.d,i+=10,g));return M=!0,E(l,u,g)};m.minus=m.sub=function(t){var e,n,r,i,o,s,a,l,d,f,u,g,y=this,L=y.constructor;if(t=new L(t),!y.d||!t.d)return!y.s||!t.s?t=new L(NaN):y.d?t.s=-t.s:t=new L(t.d||y.s!==t.s?y:NaN),t;if(y.s!=t.s)return t.s=-t.s,y.plus(t);if(d=y.d,g=t.d,a=L.precision,l=L.rounding,!d[0]||!g[0]){if(g[0])t.s=-t.s;else if(d[0])t=new L(y);else return new L(l===3?-0:0);return M?E(t,a,l):t}if(n=oe(t.e/F),f=oe(y.e/F),d=d.slice(),o=f-n,o){for(u=o<0,u?(e=d,o=-o,s=g.length):(e=g,n=f,s=d.length),r=Math.max(Math.ceil(a/F),s)+2,o>r&&(o=r,e.length=1),e.reverse(),r=o;r--;)e.push(0);e.reverse()}else{for(r=d.length,s=g.length,u=r<s,u&&(s=r),r=0;r<s;r++)if(d[r]!=g[r]){u=d[r]<g[r];break}o=0}for(u&&(e=d,d=g,g=e,t.s=-t.s),s=d.length,r=g.length-s;r>0;--r)d[s++]=0;for(r=g.length;r>o;){if(d[--r]<g[r]){for(i=r;i&&d[--i]===0;)d[i]=Se-1;--d[i],d[r]+=Se}d[r]-=g[r]}for(;d[--s]===0;)d.pop();for(;d[0]===0;d.shift())--n;return d[0]?(t.d=d,t.e=dt(d,n),M?E(t,a,l):t):new L(l===3?-0:0)};m.modulo=m.mod=function(t){var e,n=this,r=n.constructor;return t=new r(t),!n.d||!t.s||t.d&&!t.d[0]?new r(NaN):!t.d||n.d&&!n.d[0]?E(new r(n),r.precision,r.rounding):(M=!1,r.modulo==9?(e=V(n,t.abs(),0,3,1),e.s*=t.s):e=V(n,t,0,r.modulo,1),e=e.times(t),M=!0,n.minus(e))};m.naturalExponential=m.exp=function(){return xt(this)};m.naturalLogarithm=m.ln=function(){return Ce(this)};m.negated=m.neg=function(){var t=new this.constructor(this);return t.s=-t.s,E(t)};m.plus=m.add=function(t){var e,n,r,i,o,s,a,l,d,f,u=this,g=u.constructor;if(t=new g(t),!u.d||!t.d)return!u.s||!t.s?t=new g(NaN):u.d||(t=new g(t.d||u.s===t.s?u:NaN)),t;if(u.s!=t.s)return t.s=-t.s,u.minus(t);if(d=u.d,f=t.d,a=g.precision,l=g.rounding,!d[0]||!f[0])return f[0]||(t=new g(u)),M?E(t,a,l):t;if(o=oe(u.e/F),r=oe(t.e/F),d=d.slice(),i=o-r,i){for(i<0?(n=d,i=-i,s=f.length):(n=f,r=o,s=d.length),o=Math.ceil(a/F),s=o>s?o+1:s+1,i>s&&(i=s,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(s=d.length,i=f.length,s-i<0&&(i=s,n=f,f=d,d=n),e=0;i;)e=(d[--i]=d[i]+f[i]+e)/Se|0,d[i]%=Se;for(e&&(d.unshift(e),++r),s=d.length;d[--s]==0;)d.pop();return t.d=d,t.e=dt(d,r),M?E(t,a,l):t};m.precision=m.sd=function(t){var e,n=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Re+t);return n.d?(e=en(n.d),t&&n.e+1>e&&(e=n.e+1)):e=NaN,e};m.round=function(){var t=this,e=t.constructor;return E(new e(t),t.e+1,e.rounding)};m.sine=m.sin=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+F,r.rounding=1,n=Jn(r,on(r,n)),r.precision=t,r.rounding=e,E(De>2?n.neg():n,t,e,!0)):new r(NaN)};m.squareRoot=m.sqrt=function(){var t,e,n,r,i,o,s=this,a=s.d,l=s.e,d=s.s,f=s.constructor;if(d!==1||!a||!a[0])return new f(!d||d<0&&(!a||a[0])?NaN:a?s:1/0);for(M=!1,d=Math.sqrt(+s),d==0||d==1/0?(e=ne(a),(e.length+l)%2==0&&(e+="0"),d=Math.sqrt(e),l=oe((l+1)/2)-(l<0||l%2),d==1/0?e="5e"+l:(e=d.toExponential(),e=e.slice(0,e.indexOf("e")+1)+l),r=new f(e)):r=new f(d.toString()),n=(l=f.precision)+3;;)if(o=r,r=o.plus(V(s,o,n+2,1)).times(.5),ne(o.d).slice(0,n)===(e=ne(r.d)).slice(0,n))if(e=e.slice(n-3,n+1),e=="9999"||!i&&e=="4999"){if(!i&&(E(o,l+1,0),o.times(o).eq(s))){r=o;break}n+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(E(r,l+1,1),t=!r.times(r).eq(s));break}return M=!0,E(r,l,f.rounding,t)};m.tangent=m.tan=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+10,r.rounding=1,n=n.sin(),n.s=1,n=V(n,new r(1).minus(n.times(n)).sqrt(),t+10,0),r.precision=t,r.rounding=e,E(De==2||De==4?n.neg():n,t,e,!0)):new r(NaN)};m.times=m.mul=function(t){var e,n,r,i,o,s,a,l,d,f=this,u=f.constructor,g=f.d,y=(t=new u(t)).d;if(t.s*=f.s,!g||!g[0]||!y||!y[0])return new u(!t.s||g&&!g[0]&&!y||y&&!y[0]&&!g?NaN:!g||!y?t.s/0:t.s*0);for(n=oe(f.e/F)+oe(t.e/F),l=g.length,d=y.length,l<d&&(o=g,g=y,y=o,s=l,l=d,d=s),o=[],s=l+d,r=s;r--;)o.push(0);for(r=d;--r>=0;){for(e=0,i=l+r;i>r;)a=o[i]+y[r]*g[i-r-1]+e,o[i--]=a%Se|0,e=a/Se|0;o[i]=(o[i]+e)%Se|0}for(;!o[--s];)o.pop();return e?++n:o.shift(),t.d=o,t.e=dt(o,n),M?E(t,u.precision,u.rounding):t};m.toBinary=function(t,e){return Mt(this,2,t,e)};m.toDecimalPlaces=m.toDP=function(t,e){var n=this,r=n.constructor;return n=new r(n),t===void 0?n:(ce(t,0,$e),e===void 0?e=r.rounding:ce(e,0,8),E(n,t+n.e+1,e))};m.toExponential=function(t,e){var n,r=this,i=r.constructor;return t===void 0?n=Ee(r,!0):(ce(t,0,$e),e===void 0?e=i.rounding:ce(e,0,8),r=E(new i(r),t+1,e),n=Ee(r,!0,t+1)),r.isNeg()&&!r.isZero()?"-"+n:n};m.toFixed=function(t,e){var n,r,i=this,o=i.constructor;return t===void 0?n=Ee(i):(ce(t,0,$e),e===void 0?e=o.rounding:ce(e,0,8),r=E(new o(i),t+i.e+1,e),n=Ee(r,!1,t+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n};m.toFraction=function(t){var e,n,r,i,o,s,a,l,d,f,u,g,y=this,L=y.d,A=y.constructor;if(!L)return new A(y);if(d=n=new A(1),r=l=new A(0),e=new A(r),o=e.e=en(L)-y.e-1,s=o%F,e.d[0]=G(10,s<0?F+s:s),t==null)t=o>0?e:d;else{if(a=new A(t),!a.isInt()||a.lt(d))throw Error(Re+a);t=a.gt(e)?o>0?e:d:a}for(M=!1,a=new A(ne(L)),f=A.precision,A.precision=o=L.length*F*2;u=V(a,e,0,1,1),i=n.plus(u.times(r)),i.cmp(t)!=1;)n=r,r=i,i=d,d=l.plus(u.times(i)),l=i,i=e,e=a.minus(u.times(i)),a=i;return i=V(t.minus(n),r,0,1,1),l=l.plus(i.times(d)),n=n.plus(i.times(r)),l.s=d.s=y.s,g=V(d,r,o,1).minus(y).abs().cmp(V(l,n,o,1).minus(y).abs())<1?[d,r]:[l,n],A.precision=f,M=!0,g};m.toHexadecimal=m.toHex=function(t,e){return Mt(this,16,t,e)};m.toNearest=function(t,e){var n=this,r=n.constructor;if(n=new r(n),t==null){if(!n.d)return n;t=new r(1),e=r.rounding}else{if(t=new r(t),e===void 0?e=r.rounding:ce(e,0,8),!n.d)return t.s?n:t;if(!t.d)return t.s&&(t.s=n.s),t}return t.d[0]?(M=!1,n=V(n,t,0,e,1).times(t),M=!0,E(n)):(t.s=n.s,n=t),n};m.toNumber=function(){return+this};m.toOctal=function(t,e){return Mt(this,8,t,e)};m.toPower=m.pow=function(t){var e,n,r,i,o,s,a=this,l=a.constructor,d=+(t=new l(t));if(!a.d||!t.d||!a.d[0]||!t.d[0])return new l(G(+a,d));if(a=new l(a),a.eq(1))return a;if(r=l.precision,o=l.rounding,t.eq(1))return E(a,r,o);if(e=oe(t.e/F),e>=t.d.length-1&&(n=d<0?-d:d)<=qn)return i=tn(l,a,n,r),t.s<0?new l(1).div(i):E(i,r,o);if(s=a.s,s<0){if(e<t.d.length-1)return new l(NaN);if((t.d[e]&1)==0&&(s=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=s,a}return n=G(+a,d),e=n==0||!isFinite(n)?oe(d*(Math.log("0."+ne(a.d))/Math.LN10+a.e+1)):new l(n+"").e,e>l.maxE+1||e<l.minE-1?new l(e>0?s/0:0):(M=!1,l.rounding=a.s=1,n=Math.min(12,(e+"").length),i=xt(t.times(Ce(a,r+n)),r),i.d&&(i=E(i,r+5,1),Qe(i.d,r,o)&&(e=r+10,i=E(xt(t.times(Ce(a,e+n)),e),e+5,1),+ne(i.d).slice(r+1,r+15)+1==1e14&&(i=E(i,r+1,0)))),i.s=s,M=!0,l.rounding=o,E(i,r,o))};m.toPrecision=function(t,e){var n,r=this,i=r.constructor;return t===void 0?n=Ee(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(ce(t,1,$e),e===void 0?e=i.rounding:ce(e,0,8),r=E(new i(r),t,e),n=Ee(r,t<=r.e||r.e<=i.toExpNeg,t)),r.isNeg()&&!r.isZero()?"-"+n:n};m.toSignificantDigits=m.toSD=function(t,e){var n=this,r=n.constructor;return t===void 0?(t=r.precision,e=r.rounding):(ce(t,1,$e),e===void 0?e=r.rounding:ce(e,0,8)),E(new r(n),t,e)};m.toString=function(){var t=this,e=t.constructor,n=Ee(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()&&!t.isZero()?"-"+n:n};m.truncated=m.trunc=function(){return E(new this.constructor(this),this.e+1,1)};m.valueOf=m.toJSON=function(){var t=this,e=t.constructor,n=Ee(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()?"-"+n:n};function ne(t){var e,n,r,i=t.length-1,o="",s=t[0];if(i>0){for(o+=s,e=1;e<i;e++)r=t[e]+"",n=F-r.length,n&&(o+=Pe(n)),o+=r;s=t[e],r=s+"",n=F-r.length,n&&(o+=Pe(n))}else if(s===0)return"0";for(;s%10===0;)s/=10;return o+s}function ce(t,e,n){if(t!==~~t||t<e||t>n)throw Error(Re+t)}function Qe(t,e,n,r){var i,o,s,a;for(o=t[0];o>=10;o/=10)--e;return--e<0?(e+=F,i=0):(i=Math.ceil((e+1)/F),e%=F),o=G(10,F-e),a=t[i]%o|0,r==null?e<3?(e==0?a=a/100|0:e==1&&(a=a/10|0),s=n<4&&a==99999||n>3&&a==49999||a==5e4||a==0):s=(n<4&&a+1==o||n>3&&a+1==o/2)&&(t[i+1]/o/100|0)==G(10,e-2)-1||(a==o/2||a==0)&&(t[i+1]/o/100|0)==0:e<4?(e==0?a=a/1e3|0:e==1?a=a/100|0:e==2&&(a=a/10|0),s=(r||n<4)&&a==9999||!r&&n>3&&a==4999):s=((r||n<4)&&a+1==o||!r&&n>3&&a+1==o/2)&&(t[i+1]/o/1e3|0)==G(10,e-3)-1,s}function it(t,e,n){for(var r,i=[0],o,s=0,a=t.length;s<a;){for(o=i.length;o--;)i[o]*=e;for(i[0]+=Et.indexOf(t.charAt(s++)),r=0;r<i.length;r++)i[r]>n-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/n|0,i[r]%=n)}return i.reverse()}function zn(t,e){var n,r,i;if(e.isZero())return e;r=e.d.length,r<32?(n=Math.ceil(r/3),i=(1/ut(4,n)).toString()):(n=16,i="2.3283064365386962890625e-10"),t.precision+=n,e=Ve(t,1,e.times(i),new t(1));for(var o=n;o--;){var s=e.times(e);e=s.times(s).minus(s).times(8).plus(1)}return t.precision-=n,e}var V=(function(){function t(r,i,o){var s,a=0,l=r.length;for(r=r.slice();l--;)s=r[l]*i+a,r[l]=s%o|0,a=s/o|0;return a&&r.unshift(a),r}function e(r,i,o,s){var a,l;if(o!=s)l=o>s?1:-1;else for(a=l=0;a<o;a++)if(r[a]!=i[a]){l=r[a]>i[a]?1:-1;break}return l}function n(r,i,o,s){for(var a=0;o--;)r[o]-=a,a=r[o]<i[o]?1:0,r[o]=a*s+r[o]-i[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,o,s,a,l){var d,f,u,g,y,L,A,z,C,X,$,j,Ne,ge,he,xe,Ie,me,J,Be,Te=r.constructor,_e=r.s==i.s?1:-1,Z=r.d,R=i.d;if(!Z||!Z[0]||!R||!R[0])return new Te(!r.s||!i.s||(Z?R&&Z[0]==R[0]:!R)?NaN:Z&&Z[0]==0||!R?_e*0:_e/0);for(l?(y=1,f=r.e-i.e):(l=Se,y=F,f=oe(r.e/y)-oe(i.e/y)),J=R.length,Ie=Z.length,C=new Te(_e),X=C.d=[],u=0;R[u]==(Z[u]||0);u++);if(R[u]>(Z[u]||0)&&f--,o==null?(ge=o=Te.precision,s=Te.rounding):a?ge=o+(r.e-i.e)+1:ge=o,ge<0)X.push(1),L=!0;else{if(ge=ge/y+2|0,u=0,J==1){for(g=0,R=R[0],ge++;(u<Ie||g)&&ge--;u++)he=g*l+(Z[u]||0),X[u]=he/R|0,g=he%R|0;L=g||u<Ie}else{for(g=l/(R[0]+1)|0,g>1&&(R=t(R,g,l),Z=t(Z,g,l),J=R.length,Ie=Z.length),xe=J,$=Z.slice(0,J),j=$.length;j<J;)$[j++]=0;Be=R.slice(),Be.unshift(0),me=R[0],R[1]>=l/2&&++me;do g=0,d=e(R,$,J,j),d<0?(Ne=$[0],J!=j&&(Ne=Ne*l+($[1]||0)),g=Ne/me|0,g>1?(g>=l&&(g=l-1),A=t(R,g,l),z=A.length,j=$.length,d=e(A,$,z,j),d==1&&(g--,n(A,J<z?Be:R,z,l))):(g==0&&(d=g=1),A=R.slice()),z=A.length,z<j&&A.unshift(0),n($,A,j,l),d==-1&&(j=$.length,d=e(R,$,J,j),d<1&&(g++,n($,J<j?Be:R,j,l))),j=$.length):d===0&&(g++,$=[0]),X[u++]=g,d&&$[0]?$[j++]=Z[xe]||0:($=[Z[xe]],j=1);while((xe++<Ie||$[0]!==void 0)&&ge--);L=$[0]!==void 0}X[0]||X.shift()}if(y==1)C.e=f,Gt=L;else{for(u=1,g=X[0];g>=10;g/=10)u++;C.e=u+f*y-1,E(C,a?o+C.e+1:o,s,L)}return C}})();function E(t,e,n,r){var i,o,s,a,l,d,f,u,g,y=t.constructor;e:if(e!=null){if(u=t.d,!u)return t;for(i=1,a=u[0];a>=10;a/=10)i++;if(o=e-i,o<0)o+=F,s=e,f=u[g=0],l=f/G(10,i-s-1)%10|0;else if(g=Math.ceil((o+1)/F),a=u.length,g>=a)if(r){for(;a++<=g;)u.push(0);f=l=0,i=1,o%=F,s=o-F+1}else break e;else{for(f=a=u[g],i=1;a>=10;a/=10)i++;o%=F,s=o-F+i,l=s<0?0:f/G(10,i-s-1)%10|0}if(r=r||e<0||u[g+1]!==void 0||(s<0?f:f%G(10,i-s-1)),d=n<4?(l||r)&&(n==0||n==(t.s<0?3:2)):l>5||l==5&&(n==4||r||n==6&&(o>0?s>0?f/G(10,i-s):0:u[g-1])%10&1||n==(t.s<0?8:7)),e<1||!u[0])return u.length=0,d?(e-=t.e+1,u[0]=G(10,(F-e%F)%F),t.e=-e||0):u[0]=t.e=0,t;if(o==0?(u.length=g,a=1,g--):(u.length=g+1,a=G(10,F-o),u[g]=s>0?(f/G(10,i-s)%G(10,s)|0)*a:0),d)for(;;)if(g==0){for(o=1,s=u[0];s>=10;s/=10)o++;for(s=u[0]+=a,a=1;s>=10;s/=10)a++;o!=a&&(t.e++,u[0]==Se&&(u[0]=1));break}else{if(u[g]+=a,u[g]!=Se)break;u[g--]=0,a=1}for(o=u.length;u[--o]===0;)u.pop()}return M&&(t.e>y.maxE?(t.d=null,t.e=NaN):t.e<y.minE&&(t.e=0,t.d=[0])),t}function Ee(t,e,n){if(!t.isFinite())return rn(t);var r,i=t.e,o=ne(t.d),s=o.length;return e?(n&&(r=n-s)>0?o=o.charAt(0)+"."+o.slice(1)+Pe(r):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(t.e<0?"e":"e+")+t.e):i<0?(o="0."+Pe(-i-1)+o,n&&(r=n-s)>0&&(o+=Pe(r))):i>=s?(o+=Pe(i+1-s),n&&(r=n-i-1)>0&&(o=o+"."+Pe(r))):((r=i+1)<s&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-s)>0&&(i+1===s&&(o+="."),o+=Pe(r))),o}function dt(t,e){var n=t[0];for(e*=F;n>=10;n/=10)e++;return e}function at(t,e,n){if(e>Vn)throw M=!0,n&&(t.precision=n),Error(Qt);return E(new t(ot),e,1,!0)}function be(t,e,n){if(e>Ft)throw Error(Qt);return E(new t(st),e,n,!0)}function en(t){var e=t.length-1,n=e*F+1;if(e=t[e],e){for(;e%10==0;e/=10)n--;for(e=t[0];e>=10;e/=10)n++}return n}function Pe(t){for(var e="";t--;)e+="0";return e}function tn(t,e,n,r){var i,o=new t(1),s=Math.ceil(r/F+4);for(M=!1;;){if(n%2&&(o=o.times(e),Jt(o.d,s)&&(i=!0)),n=oe(n/2),n===0){n=o.d.length-1,i&&o.d[n]===0&&++o.d[n];break}e=e.times(e),Jt(e.d,s)}return M=!0,o}function Zt(t){return t.d[t.d.length-1]&1}function nn(t,e,n){for(var r,i,o=new t(e[0]),s=0;++s<e.length;){if(i=new t(e[s]),!i.s){o=i;break}r=o.cmp(i),(r===n||r===0&&o.s===n)&&(o=i)}return o}function xt(t,e){var n,r,i,o,s,a,l,d=0,f=0,u=0,g=t.constructor,y=g.rounding,L=g.precision;if(!t.d||!t.d[0]||t.e>17)return new g(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(e==null?(M=!1,l=L):l=e,a=new g(.03125);t.e>-2;)t=t.times(a),u+=5;for(r=Math.log(G(2,u))/Math.LN10*2+5|0,l+=r,n=o=s=new g(1),g.precision=l;;){if(o=E(o.times(t),l,1),n=n.times(++f),a=s.plus(V(o,n,l,1)),ne(a.d).slice(0,l)===ne(s.d).slice(0,l)){for(i=u;i--;)s=E(s.times(s),l,1);if(e==null)if(d<3&&Qe(s.d,l-r,y,d))g.precision=l+=10,n=o=a=new g(1),f=0,d++;else return E(s,g.precision=L,y,M=!0);else return g.precision=L,s}s=a}}function Ce(t,e){var n,r,i,o,s,a,l,d,f,u,g,y=1,L=10,A=t,z=A.d,C=A.constructor,X=C.rounding,$=C.precision;if(A.s<0||!z||!z[0]||!A.e&&z[0]==1&&z.length==1)return new C(z&&!z[0]?-1/0:A.s!=1?NaN:z?0:A);if(e==null?(M=!1,f=$):f=e,C.precision=f+=L,n=ne(z),r=n.charAt(0),Math.abs(o=A.e)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)A=A.times(t),n=ne(A.d),r=n.charAt(0),y++;o=A.e,r>1?(A=new C("0."+n),o++):A=new C(r+"."+n.slice(1))}else return d=at(C,f+2,$).times(o+""),A=Ce(new C(r+"."+n.slice(1)),f-L).plus(d),C.precision=$,e==null?E(A,$,X,M=!0):A;for(u=A,l=s=A=V(A.minus(1),A.plus(1),f,1),g=E(A.times(A),f,1),i=3;;){if(s=E(s.times(g),f,1),d=l.plus(V(s,new C(i),f,1)),ne(d.d).slice(0,f)===ne(l.d).slice(0,f))if(l=l.times(2),o!==0&&(l=l.plus(at(C,f+2,$).times(o+""))),l=V(l,new C(y),f,1),e==null)if(Qe(l.d,f-L,X,a))C.precision=f+=L,d=s=A=V(u.minus(1),u.plus(1),f,1),g=E(A.times(A),f,1),i=a=1;else return E(l,C.precision=$,X,M=!0);else return C.precision=$,l;l=d,i+=2}}function rn(t){return String(t.s*t.s/0)}function rt(t,e){var n,r,i;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;e.charCodeAt(r)===48;r++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(r,i),e){if(i-=r,t.e=n=n-r-1,t.d=[],r=(n+1)%F,n<0&&(r+=F),r<i){for(r&&t.d.push(+e.slice(0,r)),i-=F;r<i;)t.d.push(+e.slice(r,r+=F));e=e.slice(r),r=F-e.length}else r-=i;for(;r--;)e+="0";t.d.push(+e),M&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function Zn(t,e){var n,r,i,o,s,a,l,d,f;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),Kt.test(e))return rt(t,e)}else if(e==="Infinity"||e==="NaN")return+e||(t.s=NaN),t.e=NaN,t.d=null,t;if(kn.test(e))n=16,e=e.toLowerCase();else if(Hn.test(e))n=2;else if(Wn.test(e))n=8;else throw Error(Re+e);for(o=e.search(/p/i),o>0?(l=+e.slice(o+1),e=e.substring(2,o)):e=e.slice(2),o=e.indexOf("."),s=o>=0,r=t.constructor,s&&(e=e.replace(".",""),a=e.length,o=a-o,i=tn(r,new r(n),o,o*2)),d=it(e,n,Se),f=d.length-1,o=f;d[o]===0;--o)d.pop();return o<0?new r(t.s*0):(t.e=dt(d,f),t.d=d,M=!1,s&&(t=V(t,i,a*4)),l&&(t=t.times(Math.abs(l)<54?G(2,l):Xe.pow(2,l))),M=!0,t)}function Jn(t,e){var n,r=e.d.length;if(r<3)return e.isZero()?e:Ve(t,2,e,e);n=1.4*Math.sqrt(r),n=n>16?16:n|0,e=e.times(1/ut(5,n)),e=Ve(t,2,e,e);for(var i,o=new t(5),s=new t(16),a=new t(20);n--;)i=e.times(e),e=e.times(o.plus(i.times(s.times(i).minus(a))));return e}function Ve(t,e,n,r,i){var o,s,a,l,d=1,f=t.precision,u=Math.ceil(f/F);for(M=!1,l=n.times(n),a=new t(r);;){if(s=V(a.times(l),new t(e++*e++),f,1),a=i?r.plus(s):r.minus(s),r=V(s.times(l),new t(e++*e++),f,1),s=a.plus(r),s.d[u]!==void 0){for(o=u;s.d[o]===a.d[o]&&o--;);if(o==-1)break}o=a,a=r,r=s,s=o,d++}return M=!0,s.d.length=u+1,s}function ut(t,e){for(var n=t;--e;)n*=t;return n}function on(t,e){var n,r=e.s<0,i=be(t,t.precision,1),o=i.times(.5);if(e=e.abs(),e.lte(o))return De=r?4:1,e;if(n=e.divToInt(i),n.isZero())De=r?3:2;else{if(e=e.minus(n.times(i)),e.lte(o))return De=Zt(n)?r?2:3:r?4:1,e;De=Zt(n)?r?1:4:r?3:2}return e.minus(i).abs()}function Mt(t,e,n,r){var i,o,s,a,l,d,f,u,g,y=t.constructor,L=n!==void 0;if(L?(ce(n,1,$e),r===void 0?r=y.rounding:ce(r,0,8)):(n=y.precision,r=y.rounding),!t.isFinite())f=rn(t);else{for(f=Ee(t),s=f.indexOf("."),L?(i=2,e==16?n=n*4-3:e==8&&(n=n*3-2)):i=e,s>=0&&(f=f.replace(".",""),g=new y(1),g.e=f.length-s,g.d=it(Ee(g),10,i),g.e=g.d.length),u=it(f,10,i),o=l=u.length;u[--l]==0;)u.pop();if(!u[0])f=L?"0p+0":"0";else{if(s<0?o--:(t=new y(t),t.d=u,t.e=o,t=V(t,g,n,r,0,i),u=t.d,o=t.e,d=Gt),s=u[n],a=i/2,d=d||u[n+1]!==void 0,d=r<4?(s!==void 0||d)&&(r===0||r===(t.s<0?3:2)):s>a||s===a&&(r===4||d||r===6&&u[n-1]&1||r===(t.s<0?8:7)),u.length=n,d)for(;++u[--n]>i-1;)u[n]=0,n||(++o,u.unshift(1));for(l=u.length;!u[l-1];--l);for(s=0,f="";s<l;s++)f+=Et.charAt(u[s]);if(L){if(l>1)if(e==16||e==8){for(s=e==16?4:3,--l;l%s;l++)f+="0";for(u=it(f,i,e),l=u.length;!u[l-1];--l);for(s=1,f="1.";s<l;s++)f+=Et.charAt(u[s])}else f=f.charAt(0)+"."+f.slice(1);f=f+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)f="0"+f;f="0."+f}else if(++o>l)for(o-=l;o--;)f+="0";else o<l&&(f=f.slice(0,o)+"."+f.slice(o))}f=(e==16?"0x":e==2?"0b":e==8?"0o":"")+f}return t.s<0?"-"+f:f}function Jt(t,e){if(t.length>e)return t.length=e,!0}function Yn(t){return new this(t).abs()}function Gn(t){return new this(t).acos()}function Qn(t){return new this(t).acosh()}function Xn(t,e){return new this(t).plus(e)}function jn(t){return new this(t).asin()}function Kn(t){return new this(t).asinh()}function ei(t){return new this(t).atan()}function ti(t){return new this(t).atanh()}function ni(t,e){t=new this(t),e=new this(e);var n,r=this.precision,i=this.rounding,o=r+4;return!t.s||!e.s?n=new this(NaN):!t.d&&!e.d?(n=be(this,o,1).times(e.s>0?.25:.75),n.s=t.s):!e.d||t.isZero()?(n=e.s<0?be(this,r,i):new this(0),n.s=t.s):!t.d||e.isZero()?(n=be(this,o,1).times(.5),n.s=t.s):e.s<0?(this.precision=o,this.rounding=1,n=this.atan(V(t,e,o,1)),e=be(this,o,1),this.precision=r,this.rounding=i,n=t.s<0?n.minus(e):n.plus(e)):n=this.atan(V(t,e,o,1)),n}function ii(t){return new this(t).cbrt()}function ri(t){return E(t=new this(t),t.e+1,2)}function oi(t,e,n){return new this(t).clamp(e,n)}function si(t){if(!t||typeof t!="object")throw Error(lt+"Object expected");var e,n,r,i=t.defaults===!0,o=["precision",1,$e,"rounding",0,8,"toExpNeg",-qe,0,"toExpPos",0,qe,"maxE",0,qe,"minE",-qe,0,"modulo",0,9];for(e=0;e<o.length;e+=3)if(n=o[e],i&&(this[n]=Lt[n]),(r=t[n])!==void 0)if(oe(r)===r&&r>=o[e+1]&&r<=o[e+2])this[n]=r;else throw Error(Re+n+": "+r);if(n="crypto",i&&(this[n]=Lt[n]),(r=t[n])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(Xt);else this[n]=!1;else throw Error(Re+n+": "+r);return this}function ai(t){return new this(t).cos()}function li(t){return new this(t).cosh()}function sn(t){var e,n,r;function i(o){var s,a,l,d=this;if(!(d instanceof i))return new i(o);if(d.constructor=i,Yt(o)){d.s=o.s,M?!o.d||o.e>i.maxE?(d.e=NaN,d.d=null):o.e<i.minE?(d.e=0,d.d=[0]):(d.e=o.e,d.d=o.d.slice()):(d.e=o.e,d.d=o.d?o.d.slice():o.d);return}if(l=typeof o,l==="number"){if(o===0){d.s=1/o<0?-1:1,d.e=0,d.d=[0];return}if(o<0?(o=-o,d.s=-1):d.s=1,o===~~o&&o<1e7){for(s=0,a=o;a>=10;a/=10)s++;M?s>i.maxE?(d.e=NaN,d.d=null):s<i.minE?(d.e=0,d.d=[0]):(d.e=s,d.d=[o]):(d.e=s,d.d=[o]);return}if(o*0!==0){o||(d.s=NaN),d.e=NaN,d.d=null;return}return rt(d,o.toString())}if(l==="string")return(a=o.charCodeAt(0))===45?(o=o.slice(1),d.s=-1):(a===43&&(o=o.slice(1)),d.s=1),Kt.test(o)?rt(d,o):Zn(d,o);if(l==="bigint")return o<0?(o=-o,d.s=-1):d.s=1,rt(d,o.toString());throw Error(Re+o)}if(i.prototype=m,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=si,i.clone=sn,i.isDecimal=Yt,i.abs=Yn,i.acos=Gn,i.acosh=Qn,i.add=Xn,i.asin=jn,i.asinh=Kn,i.atan=ei,i.atanh=ti,i.atan2=ni,i.cbrt=ii,i.ceil=ri,i.clamp=oi,i.cos=ai,i.cosh=li,i.div=di,i.exp=ui,i.floor=fi,i.hypot=ci,i.ln=gi,i.log=hi,i.log10=pi,i.log2=mi,i.max=vi,i.min=yi,i.mod=wi,i.mul=Ai,i.pow=Ti,i.random=Si,i.round=Ii,i.sign=bi,i.sin=Ei,i.sinh=Li,i.sqrt=Fi,i.sub=xi,i.sum=Mi,i.tan=Di,i.tanh=Ni,i.trunc=Bi,t===void 0&&(t={}),t&&t.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<r.length;)t.hasOwnProperty(n=r[e++])||(t[n]=this[n]);return i.config(t),i}function di(t,e){return new this(t).div(e)}function ui(t){return new this(t).exp()}function fi(t){return E(t=new this(t),t.e+1,3)}function ci(){var t,e,n=new this(0);for(M=!1,t=0;t<arguments.length;)if(e=new this(arguments[t++]),e.d)n.d&&(n=n.plus(e.times(e)));else{if(e.s)return M=!0,new this(1/0);n=e}return M=!0,n.sqrt()}function Yt(t){return t instanceof Xe||t&&t.toStringTag===jt||!1}function gi(t){return new this(t).ln()}function hi(t,e){return new this(t).log(e)}function mi(t){return new this(t).log(2)}function pi(t){return new this(t).log(10)}function vi(){return nn(this,arguments,-1)}function yi(){return nn(this,arguments,1)}function wi(t,e){return new this(t).mod(e)}function Ai(t,e){return new this(t).mul(e)}function Ti(t,e){return new this(t).pow(e)}function Si(t){var e,n,r,i,o=0,s=new this(1),a=[];if(t===void 0?t=this.precision:ce(t,1,$e),r=Math.ceil(t/F),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));o<r;)i=e[o],i>=429e7?e[o]=crypto.getRandomValues(new Uint32Array(1))[0]:a[o++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(r*=4);o<r;)i=e[o]+(e[o+1]<<8)+(e[o+2]<<16)+((e[o+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,o):(a.push(i%1e7),o+=4);o=r/4}else throw Error(Xt);else for(;o<r;)a[o++]=Math.random()*1e7|0;for(r=a[--o],t%=F,r&&t&&(i=G(10,F-t),a[o]=(r/i|0)*i);a[o]===0;o--)a.pop();if(o<0)n=0,a=[0];else{for(n=-1;a[0]===0;n-=F)a.shift();for(r=1,i=a[0];i>=10;i/=10)r++;r<F&&(n-=F-r)}return s.e=n,s.d=a,s}function Ii(t){return E(t=new this(t),t.e+1,this.rounding)}function bi(t){return t=new this(t),t.d?t.d[0]?t.s:0*t.s:t.s||NaN}function Ei(t){return new this(t).sin()}function Li(t){return new this(t).sinh()}function Fi(t){return new this(t).sqrt()}function xi(t,e){return new this(t).sub(e)}function Mi(){var t=0,e=arguments,n=new this(e[t]);for(M=!1;n.s&&++t<e.length;)n=n.plus(e[t]);return M=!0,E(n,this.precision,this.rounding)}function Di(t){return new this(t).tan()}function Ni(t){return new this(t).tanh()}function Bi(t){return E(t=new this(t),t.e+1,1)}m[Symbol.for("nodejs.util.inspect.custom")]=m.toString;m[Symbol.toStringTag]="Decimal";var Xe=m.constructor=sn(Lt);ot=new Xe(ot);st=new Xe(st);var D=Xe;var Ze=zt(ln()),Rt=zt(pn());D.set({precision:20,rounding:D.ROUND_HALF_UP});var In=(r=>(r.STANDARD="STANDARD",r.SLOW="SLOW",r.RAPID="RAPID",r))(In||{});var bn=(r=>(r.DILUTE_INITIAL="DILUTE_INITIAL",r.DILUTE_ALL="DILUTE_ALL",r.DILUTE_NONE="DILUTE_NONE",r))(bn||{}),pt=2,He=1,En={STANDARD:[1,2.5,5,10,20,40,80,120,160,240,300].map(t=>new D(t)),SLOW:[.5,1,1.5,2.5,5,10,20,30,40,60,80,100,120,140,160,190,220,260,300].map(t=>new D(t)),RAPID:[5,10,20,40,80,160,300].map(t=>new D(t))},Ri=[.2,.25,.3,.35,.4,.45,.5,1,2,5,10].map(t=>new D(t)),$i=[.5,1,1.5,2,2.5,3,3.5,4,4.5,5,6,7,8,9,10].map(t=>new D(t)),Hi=[.5,1,1.5,2,2.5,3,4,5,7,9,10,11,12].map(t=>new D(t)),vn=new D(500),we;we={minMeasurableMass:new D(.2),minMeasurableVolume:new D(.2),minServingsForMix:new D(3),PROTEIN_TOLERANCE:new D(.05),DEFAULT_FOOD_A_DILUTION_THRESHOLD:new D(.2),DEFAULT_FOOD_B_THRESHOLD:new D(.2),MAX_SOLID_CONCENTRATION:new D(.05)};var c=null,Ut=[],Pt=[],$t=[],Ln=[],Le="",ze=null,de=-1,Je="";function Ae(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function Ke(t){return new D(t).times(10)}function yn(t){return t.dividedBy(10).toNumber()}function U(t,e){return t==null?"":(typeof t=="number"?t:t.toNumber()).toFixed(e)}function ue(t,e){if(t==null)return"";let n=typeof t=="number"?t:t.toNumber();return e==="g"?n.toFixed(pt):n%1===0?n.toFixed(0):n.toFixed(He)}function Ct(t){return t.type==="LIQUID"?"ml":"g"}function ki(t,e,n){let r=[],i=e.type==="SOLID"?Ri:$i,o=e.type==="SOLID"?t.dividedBy(n.MAX_SOLID_CONCENTRATION.times(e.mgPerUnit)):null;for(let s of i){let a=s;for(let l of Hi){let d=l;if(e.type==="SOLID"){let f=a.times(e.mgPerUnit),u=f.dividedBy(t);if(u.lessThan(n.minServingsForMix))continue;let g=d.times(u),y=g;if(a.lessThan(n.minMeasurableMass)||d.lessThan(n.minMeasurableVolume)||y.greaterThan(vn)||y.lessThan(n.minMeasurableVolume)||f.dividedBy(g).times(d).dividedBy(t).minus(1).abs().greaterThan(n.PROTEIN_TOLERANCE))continue;r.push({mixFoodAmount:a,mixWaterAmount:y,dailyAmount:d,mixTotalVolume:g,servings:u})}else{let f=a.times(e.mgPerUnit),u=f.dividedBy(t);if(u.lessThan(n.minServingsForMix))continue;let g=d.times(u),y=g.minus(a);if(y.lessThan(0)||a.lessThan(n.minMeasurableVolume)||d.lessThan(n.minMeasurableVolume)||y.greaterThan(vn)||y.lessThan(n.minMeasurableVolume)||f.dividedBy(g).times(d).dividedBy(t).minus(1).abs().greaterThan(n.PROTEIN_TOLERANCE))continue;r.push({mixFoodAmount:a,mixWaterAmount:y,dailyAmount:d,mixTotalVolume:g,servings:u})}}}return r.sort((s,a)=>{if(e.type==="SOLID"&&o){let d=s.dailyAmount.greaterThanOrEqualTo(o),f=a.dailyAmount.greaterThanOrEqualTo(o);if(d&&!f)return-1;if(!d&&f)return 1}let l=s.mixFoodAmount.comparedTo(a.mixFoodAmount);return l!==0||(l=s.dailyAmount.comparedTo(a.dailyAmount),l!==0)||(l=s.mixTotalVolume.comparedTo(a.mixTotalVolume),l!==0)?l:s.mixWaterAmount.comparedTo(a.mixWaterAmount)}),r}function Ht(t,e,n,r,i,o){let s=t,a=s.dividedBy(n.mgPerUnit),l=n.type==="SOLID"?"g":"ml",d=!1;if(r==="DILUTE_INITIAL"?d=a.lessThan(i):r==="DILUTE_ALL"?d=!0:d=!1,d){let f=ki(s,n,o);if(f.length===0)return null;let u=f[0];return{stepIndex:e,targetMg:s,method:"DILUTE",dailyAmount:u.dailyAmount,dailyAmountUnit:"ml",mixFoodAmount:u.mixFoodAmount,mixWaterAmount:u.mixWaterAmount,servings:u.servings,food:"A"}}else return{stepIndex:e,targetMg:s,method:"DIRECT",dailyAmount:a,dailyAmountUnit:l,food:"A"}}function Fn(t,e){let n="STANDARD",r="DILUTE_INITIAL",i=t.type==="SOLID"?"g":"ml",o=we.DEFAULT_FOOD_A_DILUTION_THRESHOLD,s=En[n],a=[];for(let l=0;l<s.length;l++){let d=Ht(s[l],l+1,t,r,o,e);if(d)a.push(d);else{let f=s[l],u=f.dividedBy(t.mgPerUnit);a.push({stepIndex:l+1,targetMg:f,method:"DIRECT",dailyAmount:u,dailyAmountUnit:i,food:"A"})}}return{dosingStrategy:n,foodA:t,foodAStrategy:r,diThreshold:o,steps:a,config:e}}function xn(t){if(!t.foodB)return t.steps.length;for(let e=0;e<t.steps.length;e++)if(t.steps[e].food==="B")return e;return t.steps.length}function et(t,e,n){let r=n.amount.times(e.mgPerUnit);t.foodB=e,t.foodBThreshold=n;let i=-1;for(let u=0;u<t.steps.length;u++)if(t.steps[u].targetMg.greaterThanOrEqualTo(r)){i=u;break}if(i===-1)return;let o=[];for(let u=i+1;u<t.steps.length;u++)o.push(t.steps[u].targetMg);let s=t.steps[i].targetMg,a=[],l=e.type==="SOLID"?"g":"ml",d=s,f=d.dividedBy(e.mgPerUnit);a.push({stepIndex:i+2,targetMg:d,method:"DIRECT",dailyAmount:f,dailyAmountUnit:l,food:"B"});for(let u of o){let g=u.dividedBy(e.mgPerUnit);a.push({stepIndex:0,targetMg:u,method:"DIRECT",dailyAmount:g,dailyAmountUnit:l,food:"B"})}t.steps=t.steps.slice(0,i+1),t.steps.push(...a);for(let u=0;u<t.steps.length;u++)t.steps[u].stepIndex=u+1}function Mn(t){var n,r;let e=[];if(t.steps.length<5&&e.push({severity:"red",code:"R1",message:"Protocol < 5 steps, which is quite rapid for a full OIT protocol."}),t.foodA.mgPerUnit.lessThanOrEqualTo(new D(0))&&e.push({severity:"red",code:"R7",message:`${Ae(t.foodA.name)} protein concentration must be > 0 to be considered for OIT`}),(n=t.foodB)!=null&&n.mgPerUnit.lessThanOrEqualTo(new D(0))&&e.push({severity:"red",code:"R7",message:`${Ae(((r=t.foodB)==null?void 0:r.name)||"")} protein concentration must be > 0 to be considered for OIT`}),t.foodB){let i=!1;for(let o of t.steps)o.food==="B"&&(i=!0);i===!1&&e.push({severity:"yellow",code:"Y5",message:`${Ae(t.foodB.name)} has no transition point. Decrease the threshold if you want to transition.`})}for(let i of t.steps){let s=i.food==="B"?t.foodB:t.foodA;if(i.targetMg.lessThanOrEqualTo(new D(0))&&e.push({severity:"red",code:"R8",message:`Step ${i.stepIndex}: A target protein of ${U(i.targetMg,1)} mg is NOT valid. It must be >0.`,stepIndex:i.stepIndex}),i.method==="DILUTE"){let a=i.mixFoodAmount.times(s.mgPerUnit),l=s.type==="SOLID"?i.mixWaterAmount:i.mixFoodAmount.plus(i.mixWaterAmount),d=a.times(i.dailyAmount).dividedBy(l),f=d.dividedBy(i.targetMg).minus(1).abs();if(f.greaterThan(we.PROTEIN_TOLERANCE)&&e.push({severity:"red",code:"R2",message:`Step ${i.stepIndex}: Protein mismatch. Target ${U(i.targetMg,1)} mg but calculated ${U(d,1)} mg: ${U(f.times(100),0)}% difference.`,stepIndex:i.stepIndex}),i.servings.lessThan(new D(1))){let u=i.mixFoodAmount.times(s.mgPerUnit);e.push({severity:"red",code:"R5",message:`Step ${i.stepIndex}: ${ue(i.mixFoodAmount,Ct(s))} ${Ct(s)} of food only makes ${U(u,1)} mg of total protein. However, target protein is ${U(i.targetMg,1)} mg.`,stepIndex:i.stepIndex})}l.lessThan(i.dailyAmount)&&e.push({severity:"red",code:"R6",message:`Step ${i.stepIndex}: Total volume of dilution is ${U(l,He)} ml; however, daily amount is ${U(i.dailyAmount,He)} ml, which is impossible`,stepIndex:i.stepIndex}),i.dailyAmount.lessThanOrEqualTo(0)&&e.push({severity:"red",code:"R9",message:`Step ${i.stepIndex}: Daily amount cannot be <= 0 ml`,stepIndex:i.stepIndex}),i.mixFoodAmount.lessThanOrEqualTo(0)&&e.push({severity:"red",code:"R9",message:`Step ${i.stepIndex}: Amount of food to mix cannot be <= 0 ${Ct(s)}`,stepIndex:i.stepIndex}),i.mixWaterAmount.lessThan(0)&&e.push({severity:"red",code:"R9",message:`Step ${i.stepIndex}: Amount of water to mix cannot be < 0 ml`,stepIndex:i.stepIndex}),s.type==="SOLID"&&i.mixFoodAmount.lessThan(t.config.minMeasurableMass)&&e.push({severity:"yellow",code:"Y3",message:`Step ${i.stepIndex}: Measuring ${U(i.mixFoodAmount,pt)} g of food is impractical. Aim for value \u2265 ${t.config.minMeasurableMass} g`,stepIndex:i.stepIndex}),s.type==="LIQUID"&&i.mixFoodAmount.lessThan(t.config.minMeasurableVolume)&&e.push({severity:"yellow",code:"Y3",message:`Step ${i.stepIndex}: Measuring ${U(i.mixFoodAmount,He)} ml of food is impractical. Aim for value \u2265 ${t.config.minMeasurableVolume} ml`,stepIndex:i.stepIndex}),i.dailyAmount.lessThan(t.config.minMeasurableVolume)&&e.push({severity:"yellow",code:"Y3",message:`Step ${i.stepIndex}: Measuring a daily amount of ${U(i.dailyAmount,He)} ml is impractical. Aim for value \u2265 ${t.config.minMeasurableVolume} ml`,stepIndex:i.stepIndex}),i.mixWaterAmount.lessThan(t.config.minMeasurableVolume)&&e.push({severity:"yellow",code:"Y3",message:`Step ${i.stepIndex}: Measuring ${U(i.mixWaterAmount,He)} ml of water is impractical. Aim for value \u2265 ${t.config.minMeasurableVolume} ml`,stepIndex:i.stepIndex}),i.servings.lessThan(t.config.minServingsForMix)&&i.servings.greaterThan(new D(1))&&e.push({severity:"yellow",code:"Y1",message:`Step ${i.stepIndex}: Only ${U(i.servings,1)} servings (< ${we.minServingsForMix} - impractical). Consider increasing mix amounts.`,stepIndex:i.stepIndex}),s.type==="SOLID"&&i.mixFoodAmount.dividedBy(i.mixWaterAmount).greaterThan(new D(we.MAX_SOLID_CONCENTRATION))&&e.push({severity:"yellow",code:"Y4",message:`Step ${i.stepIndex}: at ${U(i.mixFoodAmount,pt)} g of food in ${U(i.mixWaterAmount,He)} ml of water, the w/v is > ${U(we.MAX_SOLID_CONCENTRATION.times(100),0)}%. The assumption that the food contributes non-negligibly to the total volume of dilution is likely violated. Consider increasing the Daily Amount`,stepIndex:i.stepIndex})}else if(i.method==="DIRECT"){let a=i.dailyAmount.times(s.mgPerUnit),l=a.dividedBy(i.targetMg).minus(1).abs();l.greaterThan(we.PROTEIN_TOLERANCE)&&e.push({severity:"red",code:"R2",message:`Step ${i.stepIndex}: Protein mismatch. Target ${U(i.targetMg,1)} mg but calculated ${U(a,1)} mg: ${U(l.times(100),0)}% difference.`,stepIndex:i.stepIndex}),s.type==="SOLID"&&i.dailyAmount.lessThan(t.config.minMeasurableMass)&&e.push({severity:"yellow",code:"Y3",message:`Step ${i.stepIndex}: Measuring ${U(i.dailyAmount,pt)} g of food is impractical. Aim for \u2265 ${t.config.minMeasurableMass} g`,stepIndex:i.stepIndex}),s.type==="LIQUID"&&i.dailyAmount.lessThan(t.config.minMeasurableVolume)&&e.push({severity:"yellow",code:"Y3",message:`Step ${i.stepIndex}: Measuring ${U(i.dailyAmount,He)} ml of food is impractical. Aim for \u2265 ${t.config.minMeasurableVolume} ml`,stepIndex:i.stepIndex})}}for(let i=1;i<t.steps.length;i++)t.steps[i].targetMg.lessThan(t.steps[i-1].targetMg)&&e.push({severity:"yellow",code:"Y2",message:`Steps must be ascending or equal \u2014 check step ${t.steps[i].stepIndex} vs step ${t.steps[i-1].stepIndex}.`,stepIndex:t.steps[i].stepIndex});return e}function vt(){if(!c)return;let t=En[c.dosingStrategy],e=[];for(let n=0;n<t.length;n++){let r=Ht(t[n],n+1,c.foodA,c.foodAStrategy,c.diThreshold,c.config);r&&e.push(r)}c.steps=e,c.foodB&&c.foodBThreshold&&et(c,c.foodB,c.foodBThreshold),ee(),ae()}function je(){if(!c)return;let t=c.steps.map(r=>r.targetMg),e=c.steps.map(r=>r.food),n=[];for(let r=0;r<t.length;r++){let i=t[r],o=e[r]==="B",s=o?c.foodB:c.foodA,a=o?"DILUTE_NONE":c.foodAStrategy,l=Ht(i,r+1,s,a,c.diThreshold,c.config);l&&(l.food=e[r],n.push(l))}c.steps=n,ee(),ae()}function Wi(t,e){if(!c)return;let n=c.steps[t-1];if(!n)return;n.targetMg=new D(e);let i=n.food==="B"?c.foodB:c.foodA;if(n.method==="DIRECT")n.dailyAmount=n.targetMg.dividedBy(i.mgPerUnit);else{let o=n.mixFoodAmount.times(i.mgPerUnit);if(n.servings=o.dividedBy(n.targetMg),i.type==="SOLID"){let s=n.dailyAmount.times(n.servings);n.mixWaterAmount=s}else{let s=n.dailyAmount.times(n.servings);n.mixWaterAmount=s.minus(n.mixFoodAmount)}}ee(),ae()}function qi(t,e){if(!c)return;let n=c.steps[t-1];if(!n)return;n.dailyAmount=new D(e);let i=n.food==="B"?c.foodB:c.foodA;if(n.method==="DIRECT")n.targetMg=n.dailyAmount.times(i.mgPerUnit);else{let o=n.mixFoodAmount.times(i.mgPerUnit);if(n.servings=o.dividedBy(n.targetMg),i.type==="SOLID"){let s=n.dailyAmount.times(n.servings);n.mixWaterAmount=s}else{let s=n.dailyAmount.times(n.servings);n.mixWaterAmount=s.minus(n.mixFoodAmount)}}ee(),ae()}function Vi(t,e){if(!c)return;let n=c.steps[t-1];if(!n||n.method!=="DILUTE")return;n.mixFoodAmount=new D(e);let i=n.food==="B"?c.foodB:c.foodA,o=n.mixFoodAmount.times(i.mgPerUnit);if(n.servings=o.dividedBy(n.targetMg),i.type==="SOLID"){let s=n.dailyAmount.times(n.servings);n.mixWaterAmount=s}else{let s=n.dailyAmount.times(n.servings);n.mixWaterAmount=s.minus(n.mixFoodAmount)}ee(),ae()}function zi(t){if(!c)return;let e=c.steps[t-1];if(!e)return;let n={stepIndex:e.stepIndex+1,targetMg:e.targetMg,method:e.method,dailyAmount:e.dailyAmount,dailyAmountUnit:e.dailyAmountUnit,food:e.food};e.method==="DILUTE"&&(n.mixFoodAmount=e.mixFoodAmount,n.mixWaterAmount=e.mixWaterAmount,n.servings=e.servings),c.steps.splice(t,0,n);for(let r=0;r<c.steps.length;r++)c.steps[r].stepIndex=r+1;ee(),ae()}function Zi(t){if(c&&!(c.steps.length<=1)){c.steps.splice(t-1,1);for(let e=0;e<c.steps.length;e++)c.steps[e].stepIndex=e+1;ee(),ae()}}function ht(t){if(!c)return;let e=t?c.foodB:c.foodA;e.type=e.type==="SOLID"?"LIQUID":"SOLID";for(let n of c.steps)if(n.food==="B"===t)if(n.method==="DILUTE"){n.dailyAmountUnit="ml";let i=n.mixFoodAmount.times(e.mgPerUnit);if(n.servings=i.dividedBy(n.targetMg),e.type==="SOLID"){let o=n.dailyAmount.times(n.servings);n.mixWaterAmount=o}else{let o=n.dailyAmount.times(n.servings);n.mixWaterAmount=o.minus(n.mixFoodAmount)}}else n.dailyAmountUnit=e.type==="SOLID"?"g":"ml";Fe(),ee(),ae()}function Fe(){if(!c)return;let t=document.querySelector(".food-a-container"),e=document.querySelector(".food-b-container"),n=`
    <div class="food-a-settings">
      <input
        type="text"
        class="food-name-input"
        id="food-a-name"
        value="${Ae(c.foodA.name)}"
      />
      <div class="setting-row">
        <label>Protein:</label>
        <input
          type="number"
          min="0"
          max="150"
          id="food-a-protein"
          value="${yn(c.foodA.mgPerUnit).toFixed(1)}"
          step="0.1"
        />
        <span>g per 100 ${c.foodA.type==="SOLID"?"g":"ml"}</span>
      </div>
      <div class="setting-row">
        <label>Form:</label>
        <div class="toggle-group">
          <button class="toggle-btn ${c.foodA.type==="SOLID"?"active":""}" data-action="toggle-food-a-solid">Solid</button>
          <button class="toggle-btn ${c.foodA.type==="LIQUID"?"active":""}" data-action="toggle-food-a-liquid">Liquid</button>
        </div>
      </div>
      <div class="setting-row">
        <label>Dilution strategy:</label>
        <div class="toggle-group">
          <button class="toggle-btn ${c.foodAStrategy==="DILUTE_INITIAL"?"active":""}" data-action="food-a-strategy-initial">Initial dilution</button>
          <button class="toggle-btn ${c.foodAStrategy==="DILUTE_ALL"?"active":""}" data-action="food-a-strategy-all">Dilution throughout</button>
          <button class="toggle-btn ${c.foodAStrategy==="DILUTE_NONE"?"active":""}" data-action="food-a-strategy-none">No dilutions</button>
        </div>
      </div>
      ${c.foodAStrategy==="DILUTE_INITIAL"?`
      <div class="setting-row threshold-setting">
        <label>Directly dose when neat amount \u2265</label>
        <input
          type="number"
          id="food-a-threshold"
          min="0"
          value="${ue(c.diThreshold,c.foodA.type==="SOLID"?"g":"ml")}"
          step="0.1"
        />
        <span>${c.foodA.type==="SOLID"?"g":"ml"}</span>
      </div>
      `:""}
    </div>
  `,r=t.querySelector(".food-a-settings");if(r?r.outerHTML=n:t.insertAdjacentHTML("beforeend",n),c.foodB){let i=`
      <div class="food-b-settings">
        <input
          type="text"
          class="food-name-input"
          id="food-b-name"
          value="${Ae(c.foodB.name)}"
        />
        <div class="setting-row">
          <label>Protein:</label>
          <input
            type="number"
            id="food-b-protein"
            min="0"
            max="150"
            value="${yn(c.foodB.mgPerUnit).toFixed(1)}"
            step="0.1"
          />
          <span>g per 100 ${c.foodB.type==="SOLID"?"g":"ml"}</span>
        </div>
        <div class="setting-row">
          <label>Form:</label>
          <div class="toggle-group">
            <button class="toggle-btn ${c.foodB.type==="SOLID"?"active":""}" data-action="toggle-food-b-solid">Solid</button>
            <button class="toggle-btn ${c.foodB.type==="LIQUID"?"active":""}" data-action="toggle-food-b-liquid">Liquid</button>
          </div>
        </div>
        <div class="setting-row threshold-setting">
          <label>Transition when daily amount \u2265</label>
          <input
            type="number"
            id="food-b-threshold"
            value="${ue(c.foodBThreshold.amount,c.foodBThreshold.unit)}"
            step="0.1"
            min="0"
          />
          <span>${c.foodBThreshold.unit}</span>
        </div>
      </div>
    `,o=e.querySelector(".food-b-settings");o?o.outerHTML=i:e.insertAdjacentHTML("beforeend",i)}else{let i=e.querySelector(".food-b-settings");i&&i.remove()}ji()}function yt(){if(!c)return;let t=document.querySelector(".dosing-strategy-container"),e=`
    <h3>Dosing Strategy (resets all steps on change)</h3>
    <div class="setting-row">
      <div class="toggle-group">
        <button class="toggle-btn ${c.dosingStrategy==="STANDARD"?"active":""}" data-strategy="STANDARD">Standard</button>
        <button class="toggle-btn ${c.dosingStrategy==="SLOW"?"active":""}" data-strategy="SLOW">Slow</button>
        <button class="toggle-btn ${c.dosingStrategy==="RAPID"?"active":""}" data-strategy="RAPID">Rapid</button>
      </div>
    </div>
  `;t.innerHTML=e,t.querySelectorAll("[data-strategy]").forEach(n=>{n.addEventListener("click",r=>{let i=r.target.getAttribute("data-strategy");c&&i!==c.dosingStrategy&&(c.dosingStrategy=i,vt(),yt())})})}function ee(){if(!c)return;let t=document.querySelector(".output-container table"),e=`
    <thead>
      <tr>
        <th>Step</th>
        <th>Protein (mg)</th>
        <th>Method</th>
        <th>Daily amount</th>
        <th>Amount for mixture</th>
        <th>Water for mixture</th>
      </tr>
    </thead>
    <tbody>
  `,n=!0,r=Mn(c),i=new Map;for(let a of r)if(a.stepIndex!==void 0){let l=i.get(a.stepIndex);(!l||a.severity==="red"&&l==="yellow")&&i.set(a.stepIndex,a.severity)}for(let a of c.steps){let l=a.food==="B",d=l?c.foodB:c.foodA;l&&n?(e+=`
        <tr class="food-section-header">
          <td colspan="6">${Ae(c.foodB.name)}</td>
        </tr>
      `,n=!1):!l&&a.stepIndex===1&&(e+=`
        <tr class="food-section-header">
          <td colspan="6">${Ae(c.foodA.name)}</td>
        </tr>
      `);let f=i.get(a.stepIndex),u=f?`warning-highlight-${f}`:"";if(e+=`<tr class="${u}">`,e+=`
      <td class="actions-cell">
        <button class="btn-add-step" data-step="${a.stepIndex}">+</button>
        <button class="btn-remove-step" data-step="${a.stepIndex}">\u2212</button>
        <span class="step-number">${a.stepIndex}</span>
      </td>
    `,e+=`
      <td>
        <input
          class="editable"
          type="number"
          data-step="${a.stepIndex}"
          data-field="targetMg"
          value="${U(a.targetMg,1)}"
          step="0.1"
          min="0"
        />
      </td>
    `,e+=`
      <td class="method-cell">${a.method}</td>
    `,e+=`
      <td>
        <input
          class="editable"
          type="number"
          data-step="${a.stepIndex}"
          data-field="dailyAmount"
          value="${ue(a.dailyAmount,a.dailyAmountUnit)}"
          step="0.1"
          min="0"
        />
        <span> ${a.dailyAmountUnit}</span>
      </td>
    `,a.method==="DILUTE"){let g=d.type==="SOLID"?"g":"ml";e+=`
        <td>
          <input
            class="editable"
            type="number"
            data-step="${a.stepIndex}"
            data-field="mixFoodAmount"
            min="0"
            value="${ue(a.mixFoodAmount,g)}"
            step="0.01"
          />
          <span> ${g}</span>
        </td>
      `}else e+='<td class="na-cell">n/a</td>';a.method==="DILUTE"?e+=`
        <td class="non-editable">
          ${ue(a.mixWaterAmount,"ml")} ml
          <span style="color: var(--oit-text-secondary); font-size: 0.85rem;"> (${U(a.servings,1)} servings)</span>
        </td>
      `:e+='<td class="na-cell">n/a</td>',e+="</tr>"}e+="</tbody>",t.innerHTML=e;let o=document.querySelector(".bottom-section");if(!o.querySelector(".export-container")){let a=`
      <div class="export-container">
        <div class="export-buttons">
          <button class="btn-export" id="export-ascii">Copy ASCII</button>
          <button class="btn-export" id="export-pdf">Export PDF</button>
        </div>
        <div class="custom-note-container">
          <label for="custom-note">Notes:</label>
          <textarea
            id="custom-note"
            class="custom-note-textarea"
            placeholder="Add any custom notes or instructions ..."
            rows="8"
          >${Ae(Le)}</textarea>
        </div>
      </div>
    `;o.insertAdjacentHTML("afterbegin",a)}Ki(),er(),tr()}function ae(){if(!c)return;let t=Mn(c),e=document.querySelector(".warnings-container");if(t.length===0){e.innerHTML=`
      <div class="no-warnings">\u2713 Protocol valid. See here for the issues we check for.<br></div>
    `;return}let n=t.filter(o=>o.severity==="red"),r=t.filter(o=>o.severity==="yellow"),i="";n.length>0&&(i+=`
      <div class="warning-section red-warnings">
        <h4>Critical Issues (Red)</h4>
        <ul>
          ${n.map(o=>`<li><strong>${o.message}</strong></li>`).join("")}
        </ul>
      </div>
    `),r.length>0&&(i+=`
      <div class="warning-section yellow-warnings">
        <h4>Cautions (Yellow)</h4>
        <ul>
          ${r.map(o=>`<li>${o.message}</li>`).join("")}
        </ul>
      </div>
    `),e.innerHTML=i}function wn(t,e){if(!t.trim())return[];if(e==="protocol")return[...Ze.default.go(t,$t,{key:"Food",limit:50,threshold:-1e4})];{let n=Ze.default.go(t,$t,{key:"Food",limit:25,threshold:-1e4});return[...Ze.default.go(t,Ln,{key:"name",limit:25,threshold:-1e4}),...n]}}function An(t,e,n){let i=document.getElementById(t).parentElement,o=i.querySelector(".search-dropdown");if(o&&o.remove(),e.length===0&&!n.trim())return;let s=document.createElement("div");s.className="search-dropdown",de=-1,Je=t;let a=document.createElement("div");a.className="search-result-item",a.setAttribute("data-index","0"),a.innerHTML=`<strong>Custom:</strong> ${Ae(n||"New food")}`,a.addEventListener("click",()=>{Gi(n||"New Food",t),We(t)}),s.appendChild(a);let l=e.slice(0,50);for(let d=0;d<l.length;d++){let f=l[d],u=document.createElement("div");if(u.className="search-result-item",u.setAttribute("data-index",String(d+1)),f.obj.name)u.innerHTML=`<strong>Protocol:</strong> ${Ae(f.obj.name)}`,u.addEventListener("click",()=>{Qi(f.obj),We(t)});else{let g=f.obj;u.innerHTML=`
        ${Ae(g.Food)}
        <span class="food-type"> - ${Ae(g.Type)} - Protein: ${g["Mean value in 100g"].toFixed(1)} g/100 ${g.Type==="Solid"?"g":"ml"}</span>
      `,u.addEventListener("click",()=>{t==="food-a-search"?Ji(g):Yi(g),We(t)})}s.appendChild(u)}i.appendChild(s)}function We(t){let r=document.getElementById(t).parentElement.querySelector(".search-dropdown");r&&r.remove(),de=-1,Je=""}function mt(t){if(!Je)return;let e=document.getElementById(Je);if(!e)return;let r=e.parentElement.querySelector(".search-dropdown");if(!r)return;let i=Array.from(r.querySelectorAll(".search-result-item"));i.length!==0&&(de>=0&&de<i.length&&i[de].classList.remove("highlighted"),t==="down"?de=(de+1)%i.length:de=de<=0?i.length-1:de-1,i[de].classList.add("highlighted"),i[de].scrollIntoView({block:"nearest",behavior:"smooth"}))}function Tn(){if(!Je||de<0)return;let t=document.getElementById(Je);if(!t)return;let n=t.parentElement.querySelector(".search-dropdown");if(!n)return;let r=Array.from(n.querySelectorAll(".search-result-item"));de<r.length&&r[de].click()}function Ji(t){let e={name:t.Food,type:t.Type==="Solid"?"SOLID":"LIQUID",mgPerUnit:Ke(t["Mean value in 100g"])};c=Fn(e,we),Fe(),yt(),ee(),ae(),wt(),document.getElementById("food-a-search").value=""}function Yi(t){if(!c)return;let e={name:t.Food,type:t.Type==="Solid"?"SOLID":"LIQUID",mgPerUnit:Ke(t["Mean value in 100g"])},n={unit:e.type==="SOLID"?"g":"ml",amount:we.DEFAULT_FOOD_B_THRESHOLD};et(c,e,n),Fe(),ee(),ae(),document.getElementById("food-b-search").value=""}function Gi(t,e){let n={name:t||"Custom Food",type:"SOLID",mgPerUnit:Ke(10)};if(e==="food-a-search")c=Fn(n,we),Fe(),yt(),ee(),ae(),wt();else{if(!c)return;let r={unit:"g",amount:we.DEFAULT_FOOD_B_THRESHOLD};et(c,n,r),Fe(),ee(),ae()}document.getElementById(e).value=""}function Qi(t){let e={name:t.food_a.name,type:t.food_a.type==="SOLID"?"SOLID":"LIQUID",mgPerUnit:new D(t.food_a.mgPerUnit)},n={dosingStrategy:In[t.dosing_strategy],foodA:e,foodAStrategy:bn[t.food_a_strategy],diThreshold:new D(t.di_threshold),steps:[],config:we};t.custom_note&&(Le=t.custom_note);let r=[];n.foodAStrategy==="DILUTE_INITIAL"?r=t.table_di:n.foodAStrategy==="DILUTE_NONE"?r=t.table_dn:n.foodAStrategy==="DILUTE_ALL"&&(r=t.table_da);for(let i=0;i<r.length;i++){let o=r[i],s={stepIndex:i+1,targetMg:new D(o.protein),method:o.method==="DILUTE"?"DILUTE":"DIRECT",dailyAmount:new D(o.daily_amount),dailyAmountUnit:o.method==="DILUTE"?"ml":o.food===e.name?e.type==="SOLID"?"g":"ml":"g",food:o.food===e.name?"A":"B"};if(o.method==="DILUTE"){s.mixFoodAmount=new D(o.mix_amount),s.mixWaterAmount=new D(o.water_amount);let a=o.food===e.name?e:n.foodB,l=s.mixFoodAmount.times(a.mgPerUnit);s.servings=l.dividedBy(s.targetMg)}n.steps.push(s)}t.food_b&&(n.foodB={name:t.food_b.name,type:t.food_b.type==="SOLID"?"SOLID":"LIQUID",mgPerUnit:new D(t.food_b.mgPerUnit)},t.food_b_threshold&&(n.foodBThreshold={unit:n.foodB.type==="SOLID"?"g":"ml",amount:new D(t.food_b_threshold)})),c=n,Fe(),yt(),ee(),ae(),wt(),document.getElementById("food-a-search").value=""}function Xi(){c&&(c.foodB=void 0,c.foodBThreshold=void 0,vt(),Fe(),ee(),ae())}function wt(){let t=document.querySelector(".food-b-container");if(!t)return;if(c&&c.foodA){t.classList.remove("disabled");let n=document.getElementById("food-b-search"),r=document.getElementById("clear-food-b");n&&(n.disabled=!1),r&&(r.disabled=!1)}else{t.classList.add("disabled");let n=document.getElementById("food-b-search"),r=document.getElementById("clear-food-b");n&&(n.disabled=!0,n.value=""),r&&(r.disabled=!0)}}function ji(){let t=document.getElementById("food-a-name");t&&t.addEventListener("input",s=>{c&&(c.foodA.name=s.target.value,ee())});let e=document.getElementById("food-a-protein");e&&e.addEventListener("change",s=>{if(c){let a=parseFloat(s.target.value);a<0&&(a=0),a>150&&(a=150),Number.isNaN(a)&&(a=0),s.target.value=a.toFixed(1),c.foodA.mgPerUnit=Ke(a),je()}});let n=document.getElementById("food-a-threshold");n&&n.addEventListener("change",s=>{c&&(c.diThreshold=new D(s.target.value),je())});let r=document.getElementById("food-b-name");r&&r.addEventListener("input",s=>{c&&c.foodB&&(c.foodB.name=s.target.value,ee())});let i=document.getElementById("food-b-protein");i&&i.addEventListener("change",s=>{if(c&&c.foodB){let a=parseFloat(s.target.value);if(a<0&&(a=0),a>150&&(a=150),Number.isNaN(a)&&(a=0),s.target.value=a.toFixed(1),c.foodB.mgPerUnit=Ke(a),c.foodBThreshold){let l=c.foodB,d=c.foodBThreshold;c.foodB=void 0,c.foodBThreshold=void 0,vt(),et(c,l,d),ee(),ae()}}});let o=document.getElementById("food-b-threshold");o&&o.addEventListener("change",s=>{if(c&&c.foodB&&c.foodBThreshold){c.foodBThreshold.amount=new D(s.target.value);let a=c.foodB,l=c.foodBThreshold;c.foodB=void 0,c.foodBThreshold=void 0,vt(),et(c,a,l),ee(),ae()}}),document.querySelectorAll("[data-action]").forEach(s=>{s.addEventListener("click",a=>{let l=a.target.getAttribute("data-action");if(c)switch(l){case"toggle-food-a-solid":c.foodA.type!=="SOLID"&&ht(!1);break;case"toggle-food-a-liquid":c.foodA.type!=="LIQUID"&&ht(!1);break;case"toggle-food-b-solid":c.foodB&&c.foodB.type!=="SOLID"&&ht(!0);break;case"toggle-food-b-liquid":c.foodB&&c.foodB.type!=="LIQUID"&&ht(!0);break;case"food-a-strategy-initial":c.foodAStrategy="DILUTE_INITIAL",je(),Fe();break;case"food-a-strategy-all":c.foodAStrategy="DILUTE_ALL",je(),Fe();break;case"food-a-strategy-none":c.foodAStrategy="DILUTE_NONE",je(),Fe();break}})})}function Ki(){document.querySelectorAll("input.editable").forEach(t=>{t.addEventListener("blur",e=>{let n=e.target,r=parseInt(n.getAttribute("data-step")),i=n.getAttribute("data-field"),o=parseFloat(n.value);isNaN(o)||(o<0&&(o=0,n.value=o.toString()),i==="targetMg"?Wi(r,o):i==="dailyAmount"?qi(r,o):i==="mixFoodAmount"&&Vi(r,o))}),t.addEventListener("keydown",e=>{e.key==="Enter"&&e.target.blur()})}),document.querySelectorAll(".btn-add-step").forEach(t=>{t.addEventListener("click",e=>{let n=parseInt(e.target.getAttribute("data-step"));zi(n)})}),document.querySelectorAll(".btn-remove-step").forEach(t=>{t.addEventListener("click",e=>{let n=parseInt(e.target.getAttribute("data-step"));Zi(n)})})}function er(){let t=document.getElementById("export-ascii");t&&t.addEventListener("click",ir);let e=document.getElementById("export-pdf");e&&e.addEventListener("click",nr)}function tr(){let t=document.getElementById("custom-note");if(!t)return;t.value=Le;let e=null;t.addEventListener("input",n=>{e!==null&&clearTimeout(e),e=window.setTimeout(()=>{let r=n.target.value,i=document.createElement("div");i.textContent=r,Le=i.textContent||""},300)})}function nr(){if(!c)return;let{jsPDF:t}=jspdf,e=new t({unit:"pt",format:"letter"}),n=40;e.setFontSize(18),e.setFont("helvetica","bold"),e.text("Oral Immunotherapy Protocol",40,n),n+=30;let r=c.foodA.type==="SOLID"?"g":"ml",i=xn(c),o=c.steps.length,s=[];for(let u=0;u<i;u++){let g=c.steps[u],y=c.foodA,L=`${ue(g.dailyAmount,g.dailyAmountUnit)} ${g.dailyAmountUnit}`,A="N/A";if(g.method==="DILUTE"){let z=y.type==="SOLID"?"g":"ml";A=`${ue(g.mixFoodAmount,z)} ${z} food + ${ue(g.mixWaterAmount,"ml")} ml water`}u===o-1?s.push([g.stepIndex,`${U(g.targetMg,1)} mg`,g.method,L,A,"Continue long term"]):s.push([g.stepIndex,`${U(g.targetMg,1)} mg`,g.method,L,A,"2-4 weeks"])}if(e.setFontSize(14),e.setFont("helvetica","bold"),e.text(`${c.foodA.name}`,40,n),n+=20,e.setFontSize(10),e.setFont("helvetica","normal"),e.text(`Protein: ${U(c.foodA.mgPerUnit.dividedBy(new D(10)),2)} g per 100 ${r} serving.`,40,n),n+=15,e.autoTable({startY:n,head:[["Step","Protein","Method","Daily Amount","How to make mix","Interval"]],body:s,theme:"grid",headStyles:{fillColor:[66,139,202],fontStyle:"bold"},margin:{left:40,right:40},styles:{fontSize:9,cellPadding:5},columnStyles:{0:{cellWidth:40},1:{cellWidth:70},2:{cellWidth:60},3:{cellWidth:90},4:{cellWidth:180},5:{cellWidth:80}}}),n=e.lastAutoTable.finalY+20,c.foodB&&i<o){let u=c.foodB.type==="SOLID"?"g":"ml",g=[];for(let y=i;y<o;y++){let L=c.steps[y],A=c.foodB,z=`${ue(L.dailyAmount,L.dailyAmountUnit)} ${L.dailyAmountUnit}`,C="N/A";if(L.method==="DILUTE"){let X=A.type==="SOLID"?"g":"ml";C=`${ue(L.mixFoodAmount,X)} ${X} food + ${ue(L.mixWaterAmount,"ml")} ml water`}y===o-1?g.push([L.stepIndex,`${U(L.targetMg,1)} mg`,L.method,z,C,"Continue long term"]):g.push([L.stepIndex,`${U(L.targetMg,1)} mg`,L.method,z,C,"2-4 weeks"])}n>650&&(e.addPage(),n=40),n+=10,e.setFontSize(14),e.setFont("helvetica","bold"),e.text(`${c.foodB.name}`,40,n),n+=20,e.setFontSize(10),e.setFont("helvetica","normal"),e.text(`Protein: ${U(c.foodB.mgPerUnit.dividedBy(new D(10)),2)} g per 100 ${u} serving`,40,n),n+=15,e.autoTable({startY:n,head:[["Step","Protein","Method","Daily Amount","How to make mix","Interval"]],body:g,theme:"grid",headStyles:{fillColor:[66,139,202],fontStyle:"bold"},margin:{left:40,right:40},styles:{fontSize:9,cellPadding:5},columnStyles:{0:{cellWidth:40},1:{cellWidth:70},2:{cellWidth:60},3:{cellWidth:90},4:{cellWidth:180},5:{cellWidth:80}}}),n=e.lastAutoTable.finalY+20}if(Le&&Le.trim()){n>650&&(e.addPage(),n=40),e.setFontSize(14),e.setFont("helvetica","bold"),e.text("Notes",40,n),n+=15,e.setFontSize(10),e.setFont("helvetica","normal");let g=e.splitTextToSize(Le.trim(),520);for(let y of g)n>730&&(e.addPage(),n=40),e.text(y,40,n),n+=14}let a=e.internal.getNumberOfPages();for(let u=1;u<=a;u++)e.setPage(u),e.setFontSize(8),e.setFont("helvetica","italic"),e.setTextColor(100),e.text("",40,760),e.text("Always verify calculations before clinical use.",40,772),e.setTextColor(0);let l=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)||window.matchMedia&&window.matchMedia("(pointer: coarse)").matches||("ontouchstart"in window||navigator.maxTouchPoints>0)&&window.innerWidth<=1024,d=e.output("blob"),f=URL.createObjectURL(d);if(l){let u=document.createElement("a");u.href=f,u.download="protocol.pdf",u.style.display="none",document.body.appendChild(u),u.click(),document.body.removeChild(u),setTimeout(()=>{URL.revokeObjectURL(f)},100)}else{if(!window.open(f,"_blank")){let g=document.createElement("a");g.href=f,g.download="protocol.pdf",g.style.display="none",document.body.appendChild(g),g.click(),document.body.removeChild(g)}setTimeout(()=>{URL.revokeObjectURL(f)},1e3)}}function ir(){var d;if(!c)return;let t="",e="",n="",r=c.foodA.type==="SOLID"?"Solid":"Liquid",i=c.foodA.type==="SOLID"?"g":"ml";if(e+=`${c.foodA.name} (${r}). Protein: ${U(c.foodA.mgPerUnit,1)} mg/${i}`,c.foodB){let f=c.foodB.type==="SOLID"?"Solid":"Liquid",u=c.foodB.type==="SOLID"?"g":"ml";n+=`${c.foodB.name} (${f}). Protein: ${U(c.foodB.mgPerUnit,1)} mg/${u}`}let o=c.steps.length,s=xn(c),a=new Rt.AsciiTable3(c.foodA.name),l=new Rt.AsciiTable3((d=c.foodB)==null?void 0:d.name);a.setHeading("Step","Protein","Method","Daily Amount","Mix Details"),l.setHeading("Step","Protein","Method","Daily Amount","Mix Details");for(let f of c.steps){let u=f.food==="B",g=u?c.foodB:c.foodA,y;u?y=l:y=a;let L=`${ue(f.dailyAmount,f.dailyAmountUnit)} ${f.dailyAmountUnit}`,A="N/A";if(f.method==="DILUTE"){let z=g.type==="SOLID"?"g":"ml";A=`${ue(f.mixFoodAmount,z)} ${z} food + ${ue(f.mixWaterAmount,"ml")} ml water`}y.addRow(f.stepIndex,`${U(f.targetMg,1)} mg`,f.method,L,A)}c.foodB?t+=e+`
`+n+`

`:t+=e+`

`,s>0&&(t+=a.toString()),s<o&&(t+=`--- TRANSITION TO: ---
`,t+=l.toString()),Le&&Le.trim()&&(t+=`========================================
`,t+=`NOTES
`,t+=`========================================
`,t+=`${Le.trim()}`),navigator.clipboard.writeText(t).catch(()=>{alert(`Failed to copy to clipboard. Please copy manually:

`+t)})}async function rr(){try{Ut=await(await fetch("/tool_assets/typed_foods_rough.json")).json(),$t=Ut.map(n=>bt(It({},n),{prepared:Ze.default.prepare(n.Food)})),Pt=await(await fetch("/tool_assets/oit_protocols.json")).json(),Ln=Pt.map(n=>bt(It({},n),{prepared:Ze.default.prepare(n.name)})),console.log(`Loaded ${Ut.length} foods and ${Pt.length} protocols`)}catch(t){console.error("Error loading databases:",t),alert("Error loading food and protocol databases. Some features may not work.")}}async function Sn(){await rr();let t=document.getElementById("food-a-search");t&&(t.addEventListener("input",r=>{let i=r.target.value;ze&&clearTimeout(ze),ze=window.setTimeout(()=>{let o=wn(i,"food");An("food-a-search",o,i)},150)}),t.addEventListener("keydown",r=>{var o;(o=t.parentElement)!=null&&o.querySelector(".search-dropdown")&&(r.key==="ArrowDown"?(r.preventDefault(),mt("down")):r.key==="ArrowUp"?(r.preventDefault(),mt("up")):r.key==="Enter"?(r.preventDefault(),Tn()):r.key==="Escape"&&We("food-a-search"))}),t.addEventListener("blur",()=>{setTimeout(()=>We("food-a-search"),200)}));let e=document.getElementById("food-b-search");e&&(e.addEventListener("input",r=>{let i=r.target.value;ze&&clearTimeout(ze),ze=window.setTimeout(()=>{let o=wn(i,"protocol");An("food-b-search",o,i)},150)}),e.addEventListener("keydown",r=>{var o;(o=e.parentElement)!=null&&o.querySelector(".search-dropdown")&&(r.key==="ArrowDown"?(r.preventDefault(),mt("down")):r.key==="ArrowUp"?(r.preventDefault(),mt("up")):r.key==="Enter"?(r.preventDefault(),Tn()):r.key==="Escape"&&We("food-b-search"))}),e.addEventListener("blur",()=>{setTimeout(()=>We("food-b-search"),200)}));let n=document.getElementById("clear-food-b");n&&n.addEventListener("click",Xi),wt(),console.log("OIT Calculator initialized")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Sn):Sn();})();
/*! Bundled license information:

ascii-table3/src/ascii-table3.js:
  (*!
   * Module exports.
   *)

decimal.js/decimal.mjs:
  (*!
   *  decimal.js v10.6.0
   *  An arbitrary-precision Decimal type for JavaScript.
   *  https://github.com/MikeMcl/decimal.js
   *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
   *  MIT Licence
   *)
*/
