import{a as Xe,b as Rt}from"./chunks/chunk-Y6SLVHK3.js";var en=Xe((Kt,ft)=>{((t,e)=>{typeof define=="function"&&define.amd?define([],e):typeof ft=="object"&&ft.exports?ft.exports=e():t.fuzzysort=e()})(Kt,t=>{"use strict";var e=(p,m)=>{if(!p||!m)return K;var y=v(p);V(m)||(m=g(m));var I=y.bitflags;return(I&m._bitflags)!==I?K:S(y,m)},n=(p,m,y)=>{if(!p)return y?.all?x(m,y):wt;var I=v(p),b=I.bitflags,A=I.containsSpace,w=u(y?.threshold||0),F=y?.limit||P,E=0,C=0,B=m.length;function fe(ke){E<F?(tt.add(ke),++E):(++C,ke._score>tt.peek()._score&&tt.replaceTop(ke))}if(y?.key)for(var re=y.key,U=0;U<B;++U){var de=m[U],$=_e(de,re);if($&&(V($)||($=g($)),(b&$._bitflags)===b)){var k=S(I,$);k!==K&&(k._score<w||(k.obj=de,fe(k)))}}else if(y?.keys){var Oe=y.keys,ye=Oe.length;e:for(var U=0;U<B;++U){var de=m[U];{for(var oe=0,_=0;_<ye;++_){var re=Oe[_],$=_e(de,re);if(!$){Be[_]=Qe;continue}V($)||($=g($)),Be[_]=$,oe|=$._bitflags}if((b&oe)!==b)continue}if(A)for(let H=0;H<I.spaceSearches.length;H++)he[H]=pe;for(var _=0;_<ye;++_){if($=Be[_],$===Qe){Ae[_]=Qe;continue}if(Ae[_]=S(I,$,!1,A),Ae[_]===K){Ae[_]=Qe;continue}if(A)for(let W=0;W<I.spaceSearches.length;W++){if(J[W]>-1e3&&he[W]>pe){var ee=(he[W]+J[W])/4;ee>he[W]&&(he[W]=ee)}J[W]>he[W]&&(he[W]=J[W])}}if(A){for(let H=0;H<I.spaceSearches.length;H++)if(he[H]===pe)continue e}else{var N=!1;for(let H=0;H<ye;H++)if(Ae[H]._score!==pe){N=!0;break}if(!N)continue}var ve=new a(ye);for(let H=0;H<ye;H++)ve[H]=Ae[H];if(A){var Y=0;for(let H=0;H<I.spaceSearches.length;H++)Y+=he[H]}else{var Y=pe;for(let W=0;W<ye;W++){var k=ve[W];if(k._score>-1e3&&Y>pe){var ee=(Y+k._score)/4;ee>Y&&(Y=ee)}k._score>Y&&(Y=k._score)}}if(ve.obj=de,ve._score=Y,y?.scoreFn){if(Y=y.scoreFn(ve),!Y)continue;Y=u(Y),ve._score=Y}Y<w||fe(ve)}}else for(var U=0;U<B;++U){var $=m[U];if($&&(V($)||($=g($)),(b&$._bitflags)===b)){var k=S(I,$);k!==K&&(k._score<w||fe(k))}}if(E===0)return wt;for(var Ce=new Array(E),U=E-1;U>=0;--U)Ce[U]=tt.poll();return Ce.total=E+C,Ce},i=(p,m="<b>",y="</b>")=>{for(var I=typeof m=="function"?m:void 0,b=p.target,A=b.length,w=p.indexes,F="",E=0,C=0,B=!1,fe=[],re=0;re<A;++re){var U=b[re];if(w[C]===re){if(++C,B||(B=!0,I?(fe.push(F),F=""):F+=m),C===w.length){I?(F+=U,fe.push(I(F,E++)),F="",fe.push(b.substr(re+1))):F+=U+y+b.substr(re+1);break}}else B&&(B=!1,I?(fe.push(I(F,E++)),F=""):F+=y);F+=U}return I?fe:F},r=p=>{typeof p=="number"?p=""+p:typeof p!="string"&&(p="");var m=le(p);return d(p,{_targetLower:m._lower,_targetLowerCodes:m.lowerCodes,_bitflags:m.bitflags})},o=()=>{Ne.clear(),ge.clear()};class s{get indexes(){return this._indexes.slice(0,this._indexes.len).sort((m,y)=>m-y)}set indexes(m){return this._indexes=m}highlight(m,y){return i(this,m,y)}get score(){return l(this._score)}set score(m){this._score=u(m)}}class a extends Array{get score(){return l(this._score)}set score(m){this._score=u(m)}}var d=(p,m)=>{let y=new s;return y.target=p,y.obj=m.obj??K,y._score=m._score??pe,y._indexes=m._indexes??[],y._targetLower=m._targetLower??"",y._targetLowerCodes=m._targetLowerCodes??K,y._nextBeginningIndexes=m._nextBeginningIndexes??K,y._bitflags=m._bitflags??0,y},l=p=>p===pe?0:p>1?p:Math.E**(((-p+1)**.04307-1)*-2),u=p=>p===0?pe:p>1?p:1-Math.pow(Math.log(p)/-2+1,1/.04307),f=p=>{typeof p=="number"?p=""+p:typeof p!="string"&&(p=""),p=p.trim();var m=le(p),y=[];if(m.containsSpace){var I=p.split(/\s+/);I=[...new Set(I)];for(var b=0;b<I.length;b++)if(I[b]!==""){var A=le(I[b]);y.push({lowerCodes:A.lowerCodes,_lower:I[b].toLowerCase(),containsSpace:!1})}}return{lowerCodes:m.lowerCodes,_lower:m._lower,containsSpace:m.containsSpace,bitflags:m.bitflags,spaceSearches:y}},g=p=>{if(p.length>999)return r(p);var m=Ne.get(p);return m!==void 0||(m=r(p),Ne.set(p,m)),m},v=p=>{if(p.length>999)return f(p);var m=ge.get(p);return m!==void 0||(m=f(p),ge.set(p,m)),m},x=(p,m)=>{var y=[];y.total=p.length;var I=m?.limit||P;if(m?.key)for(var b=0;b<p.length;b++){var A=p[b],w=_e(A,m.key);if(w!=K){V(w)||(w=g(w));var F=d(w.target,{_score:w._score,obj:A});if(y.push(F),y.length>=I)return y}}else if(m?.keys)for(var b=0;b<p.length;b++){for(var A=p[b],E=new a(m.keys.length),C=m.keys.length-1;C>=0;--C){var w=_e(A,m.keys[C]);if(!w){E[C]=Qe;continue}V(w)||(w=g(w)),w._score=pe,w._indexes.len=0,E[C]=w}if(E.obj=A,E._score=pe,y.push(E),y.length>=I)return y}else for(var b=0;b<p.length;b++){var w=p[b];if(w!=K&&(V(w)||(w=g(w)),w._score=pe,w._indexes.len=0,y.push(w),y.length>=I))return y}return y},S=(p,m,y=!1,I=!1)=>{if(y===!1&&p.containsSpace)return Z(p,m,I);for(var b=p._lower,A=p.lowerCodes,w=A[0],F=m._targetLowerCodes,E=A.length,C=F.length,U=0,B=0,fe=0;;){var re=w===F[B];if(re){if(me[fe++]=B,++U,U===E)break;w=A[U]}if(++B,B>=C)return K}var U=0,de=!1,$=0,k=m._nextBeginningIndexes;k===K&&(k=m._nextBeginningIndexes=j(m.target)),B=me[0]===0?0:k[me[0]-1];var Oe=0;if(B!==C)for(;;)if(B>=C){if(U<=0||(++Oe,Oe>200))break;--U;var ye=xe[--$];B=k[ye]}else{var re=A[U]===F[B];if(re){if(xe[$++]=B,++U,U===E){de=!0;break}++B}else B=k[B]}var oe=E<=1?-1:m._targetLower.indexOf(b,me[0]),_=!!~oe,ee=_?oe===0||m._nextBeginningIndexes[oe-1]===oe:!1;if(_&&!ee){for(var N=0;N<k.length;N=k[N])if(!(N<=oe)){for(var ve=0;ve<E&&A[ve]===m._targetLowerCodes[N+ve];ve++);if(ve===E){oe=N,ee=!0;break}}}var Y=H=>{for(var W=0,Pt=0,Fe=1;Fe<E;++Fe)H[Fe]-H[Fe-1]!==1&&(W-=H[Fe],++Pt);var bn=H[E-1]-H[0]-(E-1);if(W-=(12+bn)*Pt,H[0]!==0&&(W-=H[0]*H[0]*.2),!de)W*=1e3;else{for(var St=1,Fe=k[0];Fe<C;Fe=k[Fe])++St;St>24&&(W*=(St-24)*10)}return W-=(C-E)/2,_&&(W/=1+E*E*1),ee&&(W/=1+E*E*1),W-=(C-E)/2,W};if(de)if(ee){for(var N=0;N<E;++N)me[N]=oe+N;var Ce=me,ke=Y(me)}else var Ce=xe,ke=Y(xe);else{if(_)for(var N=0;N<E;++N)me[N]=oe+N;var Ce=me,ke=Y(Ce)}m._score=ke;for(var N=0;N<E;++N)m._indexes[N]=Ce[N];m._indexes.len=E;let nt=new s;return nt.target=m.target,nt._score=m._score,nt._indexes=m._indexes,nt},Z=(p,m,y)=>{for(var I=new Set,b=0,A=K,w=0,F=p.spaceSearches,E=F.length,C=0,B=()=>{for(let ee=C-1;ee>=0;ee--)m._nextBeginningIndexes[Ie[ee*2+0]]=Ie[ee*2+1]},fe=!1,_=0;_<E;++_){J[_]=pe;var re=F[_];if(A=S(re,m),y){if(A===K)continue;fe=!0}else if(A===K)return B(),K;var U=_===E-1;if(!U){var de=A._indexes,$=!0;for(let N=0;N<de.len-1;N++)if(de[N+1]-de[N]!==1){$=!1;break}if($){var k=de[de.len-1]+1,Oe=m._nextBeginningIndexes[k-1];for(let N=k-1;N>=0&&Oe===m._nextBeginningIndexes[N];N--)m._nextBeginningIndexes[N]=k,Ie[C*2+0]=N,Ie[C*2+1]=Oe,C++}}b+=A._score/E,J[_]=A._score/E,A._indexes[0]<w&&(b-=(w-A._indexes[0])*2),w=A._indexes[0];for(var ye=0;ye<A._indexes.len;++ye)I.add(A._indexes[ye])}if(y&&!fe)return K;B();var oe=S(p,m,!0);if(oe!==K&&oe._score>b){if(y)for(var _=0;_<E;++_)J[_]=oe._score/E;return oe}y&&(A=m),A._score=b;var _=0;for(let ee of I)A._indexes[_++]=ee;return A._indexes.len=_,A},z=p=>p.replace(/\p{Script=Latin}+/gu,m=>m.normalize("NFD")).replace(/[\u0300-\u036f]/g,""),le=p=>{p=z(p);for(var m=p.length,y=p.toLowerCase(),I=[],b=0,A=!1,w=0;w<m;++w){var F=I[w]=y.charCodeAt(w);if(F===32){A=!0;continue}var E=F>=97&&F<=122?F-97:F>=48&&F<=57?26:F<=127?30:31;b|=1<<E}return{lowerCodes:I,bitflags:b,containsSpace:A,_lower:y}},R=p=>{for(var m=p.length,y=[],I=0,b=!1,A=!1,w=0;w<m;++w){var F=p.charCodeAt(w),E=F>=65&&F<=90,C=E||F>=97&&F<=122||F>=48&&F<=57,B=E&&!b||!A||!C;b=E,A=C,B&&(y[I++]=w)}return y},j=p=>{p=z(p);for(var m=p.length,y=R(p),I=[],b=y[0],A=0,w=0;w<m;++w)b>w?I[w]=b:(b=y[++A],I[w]=b===void 0?m:b);return I},Ne=new Map,ge=new Map,me=[],xe=[],Ie=[],he=[],J=[],Be=[],Ae=[],_e=(p,m)=>{var y=p[m];if(y!==void 0)return y;if(typeof m=="function")return m(p);var I=m;Array.isArray(m)||(I=m.split("."));for(var b=I.length,A=-1;p&&++A<b;)p=p[I[A]];return p},V=p=>typeof p=="object"&&typeof p._bitflags=="number",P=1/0,pe=-P,wt=[];wt.total=0;var K=null,Qe=r(""),In=p=>{var m=[],y=0,I={},b=A=>{for(var w=0,F=m[w],E=1;E<y;){var C=E+1;w=E,C<y&&m[C]._score<m[E]._score&&(w=C),m[w-1>>1]=m[w],E=1+(w<<1)}for(var B=w-1>>1;w>0&&F._score<m[B]._score;B=(w=B)-1>>1)m[w]=m[B];m[w]=F};return I.add=(A=>{var w=y;m[y++]=A;for(var F=w-1>>1;w>0&&A._score<m[F]._score;F=(w=F)-1>>1)m[w]=m[F];m[w]=A}),I.poll=(A=>{if(y!==0){var w=m[0];return m[0]=m[--y],b(),w}}),I.peek=(A=>{if(y!==0)return m[0]}),I.replaceTop=(A=>{m[0]=A,b()}),I},tt=In();return{single:e,go:n,prepare:r,cleanup:o}})});var nn=Xe((Vi,Ft)=>{"use strict";var yi=(function(){function t(e,n){var i=[],r=!0,o=!1,s=void 0;try{for(var a=e[Symbol.iterator](),d;!(r=(d=a.next()).done)&&(i.push(d.value),!(n&&i.length===n));r=!0);}catch(l){o=!0,s=l}finally{try{!r&&a.return&&a.return()}finally{if(o)throw s}}return i}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),ct="[\x1B\x9B][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-PRZcf-nqry=><]",tn="\0-\b\v-\x1B\x9B\xAD\u200B\u2028\u2029\uFEFF\uFE00-\uFE0F",xt=`
`+tn,wi=new RegExp("(?:"+ct+")|["+tn+"]","g"),Lt=new RegExp("(?:"+ct+")|["+xt+"]","g"),Mt=new RegExp("((?:"+ct+")|[	"+xt+"])?([^	"+xt+"]*)","g");Ft.exports={zeroWidthCharacters:Lt,ansiEscapeCodes:new RegExp(ct,"g"),strlen:t=>Array.from(t.replace(Lt,"")).length,isBlank:t=>t.replace(Lt,"").replace(/\s/g,"").length===0,blank:t=>Array.from(t.replace(wi,"")).map(e=>e==="	"||e===`
`?e:" ").join(""),partition(t){for(var e,n=[];Mt.lastIndex!==t.length&&(e=Mt.exec(t));)n.push([e[1]||"",e[2]]);return Mt.lastIndex=0,n},first(t,e){let n="",i=0;for(let o of Ft.exports.partition(t)){var r=yi(o,2);let s=r[0],a=r[1],d=Array.from(a).slice(0,e-i);n+=s+d.join(""),i+=d.length}return n}}});var on=Xe((Zi,rn)=>{var Si=[{name:"none",borders:{top:{left:"",center:" ",right:"",colSeparator:" "},middle:{left:"",center:" ",right:"",colSeparator:" "},bottom:{left:"",center:" ",right:"",colSeparator:" "},data:{left:"",center:" ",right:"",colSeparator:" "}}},{name:"compact",borders:{top:{left:"",center:"-",right:"",colSeparator:"-"},middle:{left:"",center:"-",right:"",colSeparator:" "},bottom:{left:"",center:"",right:"",colSeparator:""},data:{left:"",center:" ",right:"",colSeparator:" "}}},{name:"ramac",borders:{top:{left:"+",center:"-",right:"+",colSeparator:"+"},middle:{left:"+",center:"-",right:"+",colSeparator:"+"},bottom:{left:"+",center:"-",right:"+",colSeparator:"+"},data:{left:"|",center:" ",right:"|",colSeparator:"|"}}},{name:"ascii-table",borders:{top:{left:".",center:"-",right:".",colSeparator:"-"},middle:{left:"|",center:"-",right:"|",colSeparator:"-"},bottom:{left:".",center:"-",right:".",colSeparator:"-"},data:{left:"|",center:" ",right:"|",colSeparator:"|"}}},{name:"ascii-reStructuredText",borders:{top:{left:"+",center:"-",right:"+",colSeparator:"+"},middle:{left:"+",center:"=",right:"+",colSeparator:"+"},bottom:{left:"+",center:"-",right:"+",colSeparator:"+"},data:{left:"|",center:" ",right:"|",colSeparator:"|"}}},{name:"ascii-reStructuredText-simple",borders:{top:{left:"=",center:"=",right:"=",colSeparator:" "},middle:{left:"=",center:"=",right:"=",colSeparator:" "},bottom:{left:"=",center:"=",right:"=",colSeparator:" "},data:{left:" ",center:" ",right:" ",colSeparator:" "}}},{name:"ascii-dots",borders:{top:{left:".",center:".",right:".",colSeparator:"."},middle:{left:":",center:".",right:":",colSeparator:":"},bottom:{left:":",center:".",right:":",colSeparator:":"},data:{left:":",center:" ",right:":",colSeparator:":"}}},{name:"ascii-rounded",borders:{top:{left:".",center:"-",right:".",colSeparator:"."},middle:{left:":",center:"-",right:":",colSeparator:"+"},bottom:{left:"'",center:"-",right:"'",colSeparator:"'"},data:{left:"|",center:" ",right:"|",colSeparator:"|"}}},{name:"ascii-clean",borders:{top:{left:"",center:"-",right:"",colSeparator:"|"},middle:{left:"",center:"-",right:"",colSeparator:"|"},bottom:{left:"",center:"-",right:"",colSeparator:"|"},data:{left:"",center:" ",right:"",colSeparator:"|"}}},{name:"ascii-girder",borders:{top:{left:"//",center:"=",right:"\\\\",colSeparator:"[]"},middle:{left:"|]",center:"=",right:"[|",colSeparator:"[]"},bottom:{left:"\\\\",center:"=",right:"//",colSeparator:"[]"},data:{left:"||",center:" ",right:"||",colSeparator:"||"}}},{name:"unicode-single",borders:{top:{left:"\u250C",center:"\u2500",right:"\u2510",colSeparator:"\u252C"},middle:{left:"\u251C",center:"\u2500",right:"\u2524",colSeparator:"\u253C"},bottom:{left:"\u2514",center:"\u2500",right:"\u2518",colSeparator:"\u2534"},data:{left:"\u2502",center:" ",right:"\u2502",colSeparator:"\u2502"}}},{name:"unicode-double",borders:{top:{left:"\u2554",center:"\u2550",right:"\u2557",colSeparator:"\u2566"},middle:{left:"\u2560",center:"\u2550",right:"\u2563",colSeparator:"\u256C"},bottom:{left:"\u255A",center:"\u2550",right:"\u255D",colSeparator:"\u2569"},data:{left:"\u2551",center:" ",right:"\u2551",colSeparator:"\u2551"}}},{name:"unicode-mix",borders:{top:{left:"\u2554",center:"\u2550",right:"\u2557",colSeparator:"\u2564"},middle:{left:"\u255F",center:"\u2500",right:"\u2562",colSeparator:"\u253C"},bottom:{left:"\u255A",center:"\u2550",right:"\u255D",colSeparator:"\u2567"},data:{left:"\u2551",center:" ",right:"\u2551",colSeparator:"\u2502"}}},{name:"unicode-round",borders:{top:{left:"\u256D",center:"\u2500",right:"\u256E",colSeparator:"\u252C"},middle:{left:"\u251C",center:"\u2500",right:"\u2524",colSeparator:"\u253C"},bottom:{left:"\u2570",center:"\u2500",right:"\u256F",colSeparator:"\u2534"},data:{left:"\u2502",center:" ",right:"\u2502",colSeparator:"\u2502"}}},{name:"github-markdown",borders:{top:{left:"",center:"",right:"",colSeparator:""},middle:{left:"|",center:"-",right:"|",colSeparator:"|"},bottom:{left:"",center:"",right:"",colSeparator:""},data:{left:"|",center:" ",right:"|",colSeparator:"|"}}},{name:"reddit-markdown",borders:{top:{left:"",center:" ",right:"",colSeparator:" "},middle:{left:"",center:"-",right:"",colSeparator:"|"},bottom:{left:"",center:"",right:"",colSeparator:""},data:{left:"",center:" ",right:"",colSeparator:"|"}}}];rn.exports={styles:Si}});var an=Xe((Ji,sn)=>{var Q={LEFT:0,RIGHT:1,CENTER:2,AUTO:3},{strlen:ae,isBlank:Ai,partition:gt}=nn(),{styles:Ti}=on(),Dt=class t{constructor(e=""){this.styles=Ti,this.clear(),this.setTitle(e)}static isNumeric(e){return!isNaN(parseFloat(e))&&isFinite(e)}static padStart(e,n,i=" "){if(ae(e)>=n)return e;{let d=gt(e);var r;if(d.length>0){for(var o=0,s=1;s<d.length;s++)o+=ae(d[s][1]);var a=d[0][1];a=i.repeat(n-o-ae(a)).concat(a),d[0][1]=a,r="",d.forEach(l=>r+=l[0]+l[1])}else r=i.repeat(n);return r}}static padEnd(e,n,i=" "){if(ae(e)>=n)return e;{let d=gt(e);var r="";if(d.length>1){for(var o=0,s=0;s<d.length-2;s++)o+=ae(d[s][1]);var a=d[d.length-2][1];a=a.concat(i.repeat(n-o-ae(a))),d[d.length-2][1]=a,d.forEach(l=>r+=l[0]+l[1])}else r=e.concat(i.repeat(n-ae(e)));return r}}static align(e,n,i,r=" "){let o=""+n;return e==Q.RIGHT?t.padStart(o,i,r):e==Q.LEFT?t.padEnd(o,i,r):e==Q.CENTER?t.padEnd(t.padStart(o,ae(o)+Math.floor((i-ae(o))/2),r),i,r):t.alignAuto(n,i,r)}static alignLeft(e,n,i=" "){return this.align(Q.LEFT,e,n,i)}static alignRight(e,n,i=" "){return this.align(Q.RIGHT,e,n,i)}static alignCenter(e,n,i=" "){return this.align(Q.CENTER,e,n,i)}static alignAuto(e,n,i=" "){return t.isNumeric(e)?this.alignRight(e,n,i):typeof e=="string"?this.alignLeft(e,n,i):this.alignLeft(e,n,i)}static wordWrap(e,n){let i=gt(String(e));var r="";if(i.length>1)for(var o=0;o<i.length-1;o+=2){let[s,a]=i[o],d=i[o+1][0],l=t.wordWrapBasic(a,n);r+=s+l.split(`
`).join(d+`
`+s)+d}else r=t.wordWrapBasic(e,n);return r}static wordWrapBasic(e,n){e=""+e;for(var r=!1,o="";ae(e)>n;){r=!1;for(var s=n-1;s>=0;s--)if(Ai(e.charAt(s))){o+=e.substring(0,s).trimStart()+`
`,e=e.slice(s+1),r=!0;break}r||(o+=e.substring(0,n).trimStart()+`
`,e=e.slice(n))}return o+e.trimStart()}static truncateString(e,n){if(ae(e)>n){var r="",o=0;for(let[s,a]of gt(e)){let d=Array.from(a.substring(0,n-3).concat("...")).slice(0,n-o);r+=s+d.join(""),o+=d.length}return r}else return e}static arrayFill(e,n){let i=[];for(var r=0;r<e;r++)i.push(n);return i}static arrayResize(e,n,i){for(;n>e.length;)e.push(i)}setStyle(e){let n=this.styles.find(i=>i.name==e);return this.style=n||this.styles.find(i=>i.name=="ramac"),this}getStyle(){return this.style}getStyles(){return Array.from(this.styles)}addStyle(e){return this.styles.push(e),this}removeBorder(){return this.setStyle("none")}clear(){return this.setStyle("ramac"),this.setTitle(),this.setHeading(),this.clearRows(),this.setTitleAlignCenter(),this.setHeadingAlignCenter(),this.setCellMargin(1),this.dataAlign=void 0,this.colWidths=void 0,this.wrapping=void 0,this.setJustify(!1),this}clearRows(){return this.rows=[],this}setTitle(e=""){return this.title=e,this}getTitle(){return this.title?this.title:""}setTitleAlign(e){return this.titleAlignment=e,this}setTitleAlignLeft(){return this.setTitleAlign(Q.LEFT)}setTitleAlignRight(){return this.setTitleAlign(Q.RIGHT)}setTitleAlignCenter(){return this.setTitleAlign(Q.CENTER)}getTitleAlign(){return this.titleAlignment}setHeading(...e){this.heading=t.arrayFill(e.length);for(var n=0;n<e.length;n++)this.heading[n]=e[n];return this}getHeading(){return Array.from(this.heading)}setHeadingAlign(e){return this.headingAlign=e,this}setHeadingAlignLeft(){return this.setHeadingAlign(Q.LEFT)}setHeadingAlignRight(){return this.setHeadingAlign(Q.RIGHT)}setHeadingAlignCenter(){return this.setHeadingAlign(Q.CENTER)}getHeadingAlign(){return this.headingAlign}addRow(...e){let n=t.arrayFill(e.length);for(var i=0;i<e.length;i++)n[i]=e[i];return this.rows.push(n),this}addNonZeroRow(...e){var n=!0;let i=t.arrayFill(e.length);for(var r=0;r<e.length;r++){let o=e[r];t.isNumeric(o)&&o!=0&&(n=!1),i[r]=e[r]}return n||this.rows.push(i),this}addRowMatrix(e){return e.forEach(n=>this.rows.push(n)),this}getRows(){return Array.from(this.rows)}setCell(e,n,i){this.rows[e-1][n-1]=i}getCell(e,n){return this.getRows()[e-1][n-1]}setWidth(e,n){return this.colWidths?t.arrayResize(this.colWidths,e):this.colWidths=t.arrayFill(e),this.colWidths[e-1]=n,this}getWidth(e){var n;return this.colWidths&&e<=this.colWidths.length&&(n=this.colWidths[e-1]),n}setWidths(e){return this.colWidths=e,this}getWidths(){return this.colWidths?this.colWidths:[]}setCellMargin(e){return this.cellMargin=e,this}getCellMargin(){return this.cellMargin}setAlign(e,n){return this.dataAlign?this.dataAlign.concat(t.arrayFill(e-this.dataAlign.length,Q.AUTO)):this.dataAlign=t.arrayFill(e),this.dataAlign[e-1]=n,this}getAlign(e){var n=Q.AUTO;return this.dataAlign&&e<=this.dataAlign.length&&(n=this.dataAlign[e-1]),n}setAligns(e){return this.dataAlign=Array.from(e),this}getAligns(){return this.dataAlign||(this.getRows().length>0?this.dataAlign=t.arrayFill(this.getRows()[0].length,Q.AUTO):this.dataAlign=[]),Array.from(this.dataAlign)}setAlignLeft(e){return this.setAlign(e,Q.LEFT)}setAlignRight(e){return this.setAlign(e,Q.RIGHT)}setAlignCenter(e){return this.setAlign(e,Q.CENTER)}setWrapped(e,n=!0){return this.wrapping?this.wrapping.concat(t.arrayFill(e-this.wrapping.length,!1)):this.wrapping=t.arrayFill(e,!1),this.wrapping[e-1]=n,this}isWrapped(e){var n=!1;return this.wrapping&&e<=this.wrapping.length&&(n=this.wrapping[e-1]),n}setWrappings(e){return this.wrapping=Array.from(e),this}getWrappings(){return this.wrapping||(this.getRows().length>0?this.wrapping=t.arrayFill(this.getRows()[0].length,!1):this.wrapping=[]),Array.from(this.wrapping)}setJustify(e=!0){return this.justify=e,this}isJustify(){return this.justify?this.justify:!1}transpose(){if(this.getHeading().length==0&&this.getRows().length==0)return this;let e=this.getHeading().length>0?this.getHeading().length:this.getRows()[0].length,n=this.getRows().length,i=t.arrayFill(e),r=this.getHeading().length>0?1:0;for(var o=0;o<i.length;o++){i[o]=t.arrayFill(n+r),this.getHeading().length>0&&(i[o][0]=this.getHeading()[o]);for(var s=r;s<i[0].length;s++)i[o][s]=this.getCell(s+Math.abs(r-1),o+1)}return new t(this.getTitle()).setHeadingAlign(this.getHeadingAlign()).addRowMatrix(i)}toJSON(){return`{
   "title": ${JSON.stringify(this.getTitle())},
   "heading": ${JSON.stringify(this.getHeading())},
   "rows": ${JSON.stringify(this.getRows())},
   "formatting": {
       "titleAlign": ${JSON.stringify(this.getTitleAlign())},
       "headingAlign": ${JSON.stringify(this.getHeadingAlign())},
       "columns": {
           "aligns": ${JSON.stringify(this.getAligns())},
           "widths": ${JSON.stringify(this.getWidths())},
           "wrappings": ${JSON.stringify(this.getWrappings())}
       },
       "justify": ${JSON.stringify(this.isJustify())}
   }
}`}fromJSON(e){return this.clear(),this.setTitle(e.title),this.heading=Array.from(e.heading),this.addRowMatrix(e.rows),this.setTitleAlign(e.formatting.titleAlign),this.setHeadingAlign(e.formatting.headingAlign),this.setAligns(e.formatting.columns.aligns),this.setWidths(e.formatting.columns.widths),this.setWrappings(e.formatting.columns.wrappings),this.setJustify(e.formatting.justify),this}sort(e){return this.rows.sort(e),this}sortColumn(e,n=function(i,r){return i>r?1:-1}){return this.rows.sort(function(i,r){return n(i[e-1],r[e-1])}),this}sortColumnDesc(e){let n=function(i,r){return r>i?1:-1};return this.sortColumn(e,n)}getColumnsWidth(){var e;let n=this.getHeading();n.length>0?e=t.arrayFill(n.length,0):e=t.arrayFill(this.getRows()[0].length,0);for(var i=0;i<n.length;i++){let o="".padStart(this.getCellMargin())+n[i]+"".padStart(this.getCellMargin());ae(o)>e[i]&&(e[i]=ae(o))}this.getRows().forEach(o=>{for(var s=0;s<o.length;s++){let a="".padStart(this.getCellMargin())+o[s]+"".padStart(this.getCellMargin());ae(a)>e[s]&&(e[s]=ae(a))}});for(var r=0;r<e.length;r++)this.getWidth(r+1)&&(e[r]=this.getWidth(r+1));return this.isJustify()&&(e=t.arrayFill(e.length,Math.max(...e))),e}getHorizontalLine(e,n){for(var i=e.left,r=0;r<n.length;r++)i+="".padStart(n[r],e.center),r<n.length-1&&(i+=e.colSeparator);return i+=e.right,i=i.trim(),i!=""&&(i=i+`
`),i}getWrappedRows(e){let n=t.arrayFill(e.length);for(var i=1,r=0;r<e.length;r++){let l=e[r];this.getWidth(r+1)&&this.isWrapped(r+1)?(n[r]=t.wordWrap(l,this.getWidth(r+1)-this.getCellMargin()*2).split(`
`),n[r].length>i&&(i=n[r].length)):n[r]=[l]}let o=t.arrayFill(i);for(var s=0;s<i;s++)o[s]=t.arrayFill(e.length,"");for(var a=0;a<e.length;a++)for(var d=0;d<n[a].length;d++)o[d][a]=n[a][d];return o}getHeadingRowTruncated(e,n,i){for(var r=e.left,o=0;o<i.length;o++){let s=""+i[o],a=t.align(this.getHeadingAlign(),s,n[o]-this.getCellMargin()*2);r+="".padStart(this.getCellMargin())+t.truncateString(a,n[o]-this.getCellMargin()*2)+"".padStart(this.getCellMargin()),o<i.length-1&&(r+=e.colSeparator)}return r+=e.right+`
`,r}getHeadingRow(e,n){var i="";return this.getWrappedRows(this.getHeading()).forEach(o=>{i+=this.getHeadingRowTruncated(e,n,o)}),i}getDataRowTruncated(e,n,i){for(var r=e.left,o=0;o<n.length;o++){let s=""+i[o],a=t.align(this.getAlign(o+1),s,n[o]-this.getCellMargin()*2);r+="".padStart(this.getCellMargin())+t.truncateString(a,n[o]-this.getCellMargin()*2)+"".padStart(this.getCellMargin()),o<n.length-1&&(r+=e.colSeparator)}return r+=e.right+`
`,r}getDataRow(e,n,i){var r="";return this.getWrappedRows(i).forEach(s=>{r+=this.getDataRowTruncated(e,n,s)}),r}toString(){let e=this.getColumnsWidth(),n=this.getStyle(),i=e.reduce(function(o,s){return o+s},0)+(e.length-1)*ae(n.borders.data.colSeparator);var r="";if(this.getTitle().length>0){r+=n.borders.top.left+"".padStart(i,n.borders.top.center)+n.borders.top.right+`
`,r.trim()==""&&(r=""),r+=n.borders.data.left+t.align(this.getTitleAlign(),this.getTitle(),i)+n.borders.data.right+`
`;let o={left:n.borders.middle.left,right:n.borders.middle.right,center:n.borders.top.center,colSeparator:n.borders.top.colSeparator};(o.center!=""||o.colSeparator!="")&&(r+=this.getHorizontalLine(o,e))}else r+=this.getHorizontalLine(n.borders.top,e);return this.getHeading().length>0&&(r+=this.getHeadingRow(n.borders.data,e),r+=this.getHorizontalLine(n.borders.middle,e)),this.getRows().forEach(o=>{r+=this.getDataRow(n.borders.data,e,o)}),r+=this.getHorizontalLine(n.borders.bottom,e),r}};sn.exports={AsciiTable3:Dt,AlignmentEnum:Q}});var dn=Xe((Yi,ln)=>{ln.exports=an()});var qe=9e15,$e=1e9,At="0123456789abcdef",ot="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",st="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Tt={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-qe,maxE:qe,crypto:!1},Wt,De,D=!0,lt="[DecimalError] ",Re=lt+"Invalid argument: ",qt=lt+"Precision limit exceeded",zt=lt+"crypto unavailable",Vt="[object Decimal]",se=Math.floor,G=Math.pow,En=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Ln=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Mn=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Zt=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Te=1e7,M=7,xn=9007199254740991,Fn=ot.length-1,It=st.length-1,h={toStringTag:Vt};h.absoluteValue=h.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),T(t)};h.ceil=function(){return T(new this.constructor(this),this.e+1,2)};h.clampedTo=h.clamp=function(t,e){var n,i=this,r=i.constructor;if(t=new r(t),e=new r(e),!t.s||!e.s)return new r(NaN);if(t.gt(e))throw Error(Re+e);return n=i.cmp(t),n<0?t:i.cmp(e)>0?e:new r(i)};h.comparedTo=h.cmp=function(t){var e,n,i,r,o=this,s=o.d,a=(t=new o.constructor(t)).d,d=o.s,l=t.s;if(!s||!a)return!d||!l?NaN:d!==l?d:s===a?0:!s^d<0?1:-1;if(!s[0]||!a[0])return s[0]?d:a[0]?-l:0;if(d!==l)return d;if(o.e!==t.e)return o.e>t.e^d<0?1:-1;for(i=s.length,r=a.length,e=0,n=i<r?i:r;e<n;++e)if(s[e]!==a[e])return s[e]>a[e]^d<0?1:-1;return i===r?0:i>r^d<0?1:-1};h.cosine=h.cos=function(){var t,e,n=this,i=n.constructor;return n.d?n.d[0]?(t=i.precision,e=i.rounding,i.precision=t+Math.max(n.e,n.sd())+M,i.rounding=1,n=Dn(i,Xt(i,n)),i.precision=t,i.rounding=e,T(De==2||De==3?n.neg():n,t,e,!0)):new i(1):new i(NaN)};h.cubeRoot=h.cbrt=function(){var t,e,n,i,r,o,s,a,d,l,u=this,f=u.constructor;if(!u.isFinite()||u.isZero())return new f(u);for(D=!1,o=u.s*G(u.s*u,1/3),!o||Math.abs(o)==1/0?(n=te(u.d),t=u.e,(o=(t-n.length+1)%3)&&(n+=o==1||o==-2?"0":"00"),o=G(n,1/3),t=se((t+1)/3)-(t%3==(t<0?-1:2)),o==1/0?n="5e"+t:(n=o.toExponential(),n=n.slice(0,n.indexOf("e")+1)+t),i=new f(n),i.s=u.s):i=new f(o.toString()),s=(t=f.precision)+3;;)if(a=i,d=a.times(a).times(a),l=d.plus(u),i=q(l.plus(u).times(a),l.plus(d),s+2,1),te(a.d).slice(0,s)===(n=te(i.d)).slice(0,s))if(n=n.slice(s-3,s+1),n=="9999"||!r&&n=="4999"){if(!r&&(T(a,t+1,0),a.times(a).times(a).eq(u))){i=a;break}s+=4,r=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(T(i,t+1,1),e=!i.times(i).times(i).eq(u));break}return D=!0,T(i,t,f.rounding,e)};h.decimalPlaces=h.dp=function(){var t,e=this.d,n=NaN;if(e){if(t=e.length-1,n=(t-se(this.e/M))*M,t=e[t],t)for(;t%10==0;t/=10)n--;n<0&&(n=0)}return n};h.dividedBy=h.div=function(t){return q(this,new this.constructor(t))};h.dividedToIntegerBy=h.divToInt=function(t){var e=this,n=e.constructor;return T(q(e,new n(t),0,1,1),n.precision,n.rounding)};h.equals=h.eq=function(t){return this.cmp(t)===0};h.floor=function(){return T(new this.constructor(this),this.e+1,3)};h.greaterThan=h.gt=function(t){return this.cmp(t)>0};h.greaterThanOrEqualTo=h.gte=function(t){var e=this.cmp(t);return e==1||e===0};h.hyperbolicCosine=h.cosh=function(){var t,e,n,i,r,o=this,s=o.constructor,a=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return a;n=s.precision,i=s.rounding,s.precision=n+Math.max(o.e,o.sd())+4,s.rounding=1,r=o.d.length,r<32?(t=Math.ceil(r/3),e=(1/ut(4,t)).toString()):(t=16,e="2.3283064365386962890625e-10"),o=ze(s,1,o.times(e),new s(1),!0);for(var d,l=t,u=new s(8);l--;)d=o.times(o),o=a.minus(d.times(u.minus(d.times(u))));return T(o,s.precision=n,s.rounding=i,!0)};h.hyperbolicSine=h.sinh=function(){var t,e,n,i,r=this,o=r.constructor;if(!r.isFinite()||r.isZero())return new o(r);if(e=o.precision,n=o.rounding,o.precision=e+Math.max(r.e,r.sd())+4,o.rounding=1,i=r.d.length,i<3)r=ze(o,2,r,r,!0);else{t=1.4*Math.sqrt(i),t=t>16?16:t|0,r=r.times(1/ut(5,t)),r=ze(o,2,r,r,!0);for(var s,a=new o(5),d=new o(16),l=new o(20);t--;)s=r.times(r),r=r.times(a.plus(s.times(d.times(s).plus(l))))}return o.precision=e,o.rounding=n,T(r,e,n,!0)};h.hyperbolicTangent=h.tanh=function(){var t,e,n=this,i=n.constructor;return n.isFinite()?n.isZero()?new i(n):(t=i.precision,e=i.rounding,i.precision=t+7,i.rounding=1,q(n.sinh(),n.cosh(),i.precision=t,i.rounding=e)):new i(n.s)};h.inverseCosine=h.acos=function(){var t=this,e=t.constructor,n=t.abs().cmp(1),i=e.precision,r=e.rounding;return n!==-1?n===0?t.isNeg()?be(e,i,r):new e(0):new e(NaN):t.isZero()?be(e,i+4,r).times(.5):(e.precision=i+6,e.rounding=1,t=new e(1).minus(t).div(t.plus(1)).sqrt().atan(),e.precision=i,e.rounding=r,t.times(2))};h.inverseHyperbolicCosine=h.acosh=function(){var t,e,n=this,i=n.constructor;return n.lte(1)?new i(n.eq(1)?0:NaN):n.isFinite()?(t=i.precision,e=i.rounding,i.precision=t+Math.max(Math.abs(n.e),n.sd())+4,i.rounding=1,D=!1,n=n.times(n).minus(1).sqrt().plus(n),D=!0,i.precision=t,i.rounding=e,n.ln()):new i(n)};h.inverseHyperbolicSine=h.asinh=function(){var t,e,n=this,i=n.constructor;return!n.isFinite()||n.isZero()?new i(n):(t=i.precision,e=i.rounding,i.precision=t+2*Math.max(Math.abs(n.e),n.sd())+6,i.rounding=1,D=!1,n=n.times(n).plus(1).sqrt().plus(n),D=!0,i.precision=t,i.rounding=e,n.ln())};h.inverseHyperbolicTangent=h.atanh=function(){var t,e,n,i,r=this,o=r.constructor;return r.isFinite()?r.e>=0?new o(r.abs().eq(1)?r.s/0:r.isZero()?r:NaN):(t=o.precision,e=o.rounding,i=r.sd(),Math.max(i,t)<2*-r.e-1?T(new o(r),t,e,!0):(o.precision=n=i-r.e,r=q(r.plus(1),new o(1).minus(r),n+t,1),o.precision=t+4,o.rounding=1,r=r.ln(),o.precision=t,o.rounding=e,r.times(.5))):new o(NaN)};h.inverseSine=h.asin=function(){var t,e,n,i,r=this,o=r.constructor;return r.isZero()?new o(r):(e=r.abs().cmp(1),n=o.precision,i=o.rounding,e!==-1?e===0?(t=be(o,n+4,i).times(.5),t.s=r.s,t):new o(NaN):(o.precision=n+6,o.rounding=1,r=r.div(new o(1).minus(r.times(r)).sqrt().plus(1)).atan(),o.precision=n,o.rounding=i,r.times(2)))};h.inverseTangent=h.atan=function(){var t,e,n,i,r,o,s,a,d,l=this,u=l.constructor,f=u.precision,g=u.rounding;if(l.isFinite()){if(l.isZero())return new u(l);if(l.abs().eq(1)&&f+4<=It)return s=be(u,f+4,g).times(.25),s.s=l.s,s}else{if(!l.s)return new u(NaN);if(f+4<=It)return s=be(u,f+4,g).times(.5),s.s=l.s,s}for(u.precision=a=f+10,u.rounding=1,n=Math.min(28,a/M+2|0),t=n;t;--t)l=l.div(l.times(l).plus(1).sqrt().plus(1));for(D=!1,e=Math.ceil(a/M),i=1,d=l.times(l),s=new u(l),r=l;t!==-1;)if(r=r.times(d),o=s.minus(r.div(i+=2)),r=r.times(d),s=o.plus(r.div(i+=2)),s.d[e]!==void 0)for(t=e;s.d[t]===o.d[t]&&t--;);return n&&(s=s.times(2<<n-1)),D=!0,T(s,u.precision=f,u.rounding=g,!0)};h.isFinite=function(){return!!this.d};h.isInteger=h.isInt=function(){return!!this.d&&se(this.e/M)>this.d.length-2};h.isNaN=function(){return!this.s};h.isNegative=h.isNeg=function(){return this.s<0};h.isPositive=h.isPos=function(){return this.s>0};h.isZero=function(){return!!this.d&&this.d[0]===0};h.lessThan=h.lt=function(t){return this.cmp(t)<0};h.lessThanOrEqualTo=h.lte=function(t){return this.cmp(t)<1};h.logarithm=h.log=function(t){var e,n,i,r,o,s,a,d,l=this,u=l.constructor,f=u.precision,g=u.rounding,v=5;if(t==null)t=new u(10),e=!0;else{if(t=new u(t),n=t.d,t.s<0||!n||!n[0]||t.eq(1))return new u(NaN);e=t.eq(10)}if(n=l.d,l.s<0||!n||!n[0]||l.eq(1))return new u(n&&!n[0]?-1/0:l.s!=1?NaN:n?0:1/0);if(e)if(n.length>1)o=!0;else{for(r=n[0];r%10===0;)r/=10;o=r!==1}if(D=!1,a=f+v,s=Pe(l,a),i=e?at(u,a+10):Pe(t,a),d=q(s,i,a,1),je(d.d,r=f,g))do if(a+=10,s=Pe(l,a),i=e?at(u,a+10):Pe(t,a),d=q(s,i,a,1),!o){+te(d.d).slice(r+1,r+15)+1==1e14&&(d=T(d,f+1,0));break}while(je(d.d,r+=10,g));return D=!0,T(d,f,g)};h.minus=h.sub=function(t){var e,n,i,r,o,s,a,d,l,u,f,g,v=this,x=v.constructor;if(t=new x(t),!v.d||!t.d)return!v.s||!t.s?t=new x(NaN):v.d?t.s=-t.s:t=new x(t.d||v.s!==t.s?v:NaN),t;if(v.s!=t.s)return t.s=-t.s,v.plus(t);if(l=v.d,g=t.d,a=x.precision,d=x.rounding,!l[0]||!g[0]){if(g[0])t.s=-t.s;else if(l[0])t=new x(v);else return new x(d===3?-0:0);return D?T(t,a,d):t}if(n=se(t.e/M),u=se(v.e/M),l=l.slice(),o=u-n,o){for(f=o<0,f?(e=l,o=-o,s=g.length):(e=g,n=u,s=l.length),i=Math.max(Math.ceil(a/M),s)+2,o>i&&(o=i,e.length=1),e.reverse(),i=o;i--;)e.push(0);e.reverse()}else{for(i=l.length,s=g.length,f=i<s,f&&(s=i),i=0;i<s;i++)if(l[i]!=g[i]){f=l[i]<g[i];break}o=0}for(f&&(e=l,l=g,g=e,t.s=-t.s),s=l.length,i=g.length-s;i>0;--i)l[s++]=0;for(i=g.length;i>o;){if(l[--i]<g[i]){for(r=i;r&&l[--r]===0;)l[r]=Te-1;--l[r],l[i]+=Te}l[i]-=g[i]}for(;l[--s]===0;)l.pop();for(;l[0]===0;l.shift())--n;return l[0]?(t.d=l,t.e=dt(l,n),D?T(t,a,d):t):new x(d===3?-0:0)};h.modulo=h.mod=function(t){var e,n=this,i=n.constructor;return t=new i(t),!n.d||!t.s||t.d&&!t.d[0]?new i(NaN):!t.d||n.d&&!n.d[0]?T(new i(n),i.precision,i.rounding):(D=!1,i.modulo==9?(e=q(n,t.abs(),0,3,1),e.s*=t.s):e=q(n,t,0,i.modulo,1),e=e.times(t),D=!0,n.minus(e))};h.naturalExponential=h.exp=function(){return bt(this)};h.naturalLogarithm=h.ln=function(){return Pe(this)};h.negated=h.neg=function(){var t=new this.constructor(this);return t.s=-t.s,T(t)};h.plus=h.add=function(t){var e,n,i,r,o,s,a,d,l,u,f=this,g=f.constructor;if(t=new g(t),!f.d||!t.d)return!f.s||!t.s?t=new g(NaN):f.d||(t=new g(t.d||f.s===t.s?f:NaN)),t;if(f.s!=t.s)return t.s=-t.s,f.minus(t);if(l=f.d,u=t.d,a=g.precision,d=g.rounding,!l[0]||!u[0])return u[0]||(t=new g(f)),D?T(t,a,d):t;if(o=se(f.e/M),i=se(t.e/M),l=l.slice(),r=o-i,r){for(r<0?(n=l,r=-r,s=u.length):(n=u,i=o,s=l.length),o=Math.ceil(a/M),s=o>s?o+1:s+1,r>s&&(r=s,n.length=1),n.reverse();r--;)n.push(0);n.reverse()}for(s=l.length,r=u.length,s-r<0&&(r=s,n=u,u=l,l=n),e=0;r;)e=(l[--r]=l[r]+u[r]+e)/Te|0,l[r]%=Te;for(e&&(l.unshift(e),++i),s=l.length;l[--s]==0;)l.pop();return t.d=l,t.e=dt(l,i),D?T(t,a,d):t};h.precision=h.sd=function(t){var e,n=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Re+t);return n.d?(e=Jt(n.d),t&&n.e+1>e&&(e=n.e+1)):e=NaN,e};h.round=function(){var t=this,e=t.constructor;return T(new e(t),t.e+1,e.rounding)};h.sine=h.sin=function(){var t,e,n=this,i=n.constructor;return n.isFinite()?n.isZero()?new i(n):(t=i.precision,e=i.rounding,i.precision=t+Math.max(n.e,n.sd())+M,i.rounding=1,n=Bn(i,Xt(i,n)),i.precision=t,i.rounding=e,T(De>2?n.neg():n,t,e,!0)):new i(NaN)};h.squareRoot=h.sqrt=function(){var t,e,n,i,r,o,s=this,a=s.d,d=s.e,l=s.s,u=s.constructor;if(l!==1||!a||!a[0])return new u(!l||l<0&&(!a||a[0])?NaN:a?s:1/0);for(D=!1,l=Math.sqrt(+s),l==0||l==1/0?(e=te(a),(e.length+d)%2==0&&(e+="0"),l=Math.sqrt(e),d=se((d+1)/2)-(d<0||d%2),l==1/0?e="5e"+d:(e=l.toExponential(),e=e.slice(0,e.indexOf("e")+1)+d),i=new u(e)):i=new u(l.toString()),n=(d=u.precision)+3;;)if(o=i,i=o.plus(q(s,o,n+2,1)).times(.5),te(o.d).slice(0,n)===(e=te(i.d)).slice(0,n))if(e=e.slice(n-3,n+1),e=="9999"||!r&&e=="4999"){if(!r&&(T(o,d+1,0),o.times(o).eq(s))){i=o;break}n+=4,r=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(T(i,d+1,1),t=!i.times(i).eq(s));break}return D=!0,T(i,d,u.rounding,t)};h.tangent=h.tan=function(){var t,e,n=this,i=n.constructor;return n.isFinite()?n.isZero()?new i(n):(t=i.precision,e=i.rounding,i.precision=t+10,i.rounding=1,n=n.sin(),n.s=1,n=q(n,new i(1).minus(n.times(n)).sqrt(),t+10,0),i.precision=t,i.rounding=e,T(De==2||De==4?n.neg():n,t,e,!0)):new i(NaN)};h.times=h.mul=function(t){var e,n,i,r,o,s,a,d,l,u=this,f=u.constructor,g=u.d,v=(t=new f(t)).d;if(t.s*=u.s,!g||!g[0]||!v||!v[0])return new f(!t.s||g&&!g[0]&&!v||v&&!v[0]&&!g?NaN:!g||!v?t.s/0:t.s*0);for(n=se(u.e/M)+se(t.e/M),d=g.length,l=v.length,d<l&&(o=g,g=v,v=o,s=d,d=l,l=s),o=[],s=d+l,i=s;i--;)o.push(0);for(i=l;--i>=0;){for(e=0,r=d+i;r>i;)a=o[r]+v[i]*g[r-i-1]+e,o[r--]=a%Te|0,e=a/Te|0;o[r]=(o[r]+e)%Te|0}for(;!o[--s];)o.pop();return e?++n:o.shift(),t.d=o,t.e=dt(o,n),D?T(t,f.precision,f.rounding):t};h.toBinary=function(t,e){return Et(this,2,t,e)};h.toDecimalPlaces=h.toDP=function(t,e){var n=this,i=n.constructor;return n=new i(n),t===void 0?n:(ce(t,0,$e),e===void 0?e=i.rounding:ce(e,0,8),T(n,t+n.e+1,e))};h.toExponential=function(t,e){var n,i=this,r=i.constructor;return t===void 0?n=Ee(i,!0):(ce(t,0,$e),e===void 0?e=r.rounding:ce(e,0,8),i=T(new r(i),t+1,e),n=Ee(i,!0,t+1)),i.isNeg()&&!i.isZero()?"-"+n:n};h.toFixed=function(t,e){var n,i,r=this,o=r.constructor;return t===void 0?n=Ee(r):(ce(t,0,$e),e===void 0?e=o.rounding:ce(e,0,8),i=T(new o(r),t+r.e+1,e),n=Ee(i,!1,t+i.e+1)),r.isNeg()&&!r.isZero()?"-"+n:n};h.toFraction=function(t){var e,n,i,r,o,s,a,d,l,u,f,g,v=this,x=v.d,S=v.constructor;if(!x)return new S(v);if(l=n=new S(1),i=d=new S(0),e=new S(i),o=e.e=Jt(x)-v.e-1,s=o%M,e.d[0]=G(10,s<0?M+s:s),t==null)t=o>0?e:l;else{if(a=new S(t),!a.isInt()||a.lt(l))throw Error(Re+a);t=a.gt(e)?o>0?e:l:a}for(D=!1,a=new S(te(x)),u=S.precision,S.precision=o=x.length*M*2;f=q(a,e,0,1,1),r=n.plus(f.times(i)),r.cmp(t)!=1;)n=i,i=r,r=l,l=d.plus(f.times(r)),d=r,r=e,e=a.minus(f.times(r)),a=r;return r=q(t.minus(n),i,0,1,1),d=d.plus(r.times(l)),n=n.plus(r.times(i)),d.s=l.s=v.s,g=q(l,i,o,1).minus(v).abs().cmp(q(d,n,o,1).minus(v).abs())<1?[l,i]:[d,n],S.precision=u,D=!0,g};h.toHexadecimal=h.toHex=function(t,e){return Et(this,16,t,e)};h.toNearest=function(t,e){var n=this,i=n.constructor;if(n=new i(n),t==null){if(!n.d)return n;t=new i(1),e=i.rounding}else{if(t=new i(t),e===void 0?e=i.rounding:ce(e,0,8),!n.d)return t.s?n:t;if(!t.d)return t.s&&(t.s=n.s),t}return t.d[0]?(D=!1,n=q(n,t,0,e,1).times(t),D=!0,T(n)):(t.s=n.s,n=t),n};h.toNumber=function(){return+this};h.toOctal=function(t,e){return Et(this,8,t,e)};h.toPower=h.pow=function(t){var e,n,i,r,o,s,a=this,d=a.constructor,l=+(t=new d(t));if(!a.d||!t.d||!a.d[0]||!t.d[0])return new d(G(+a,l));if(a=new d(a),a.eq(1))return a;if(i=d.precision,o=d.rounding,t.eq(1))return T(a,i,o);if(e=se(t.e/M),e>=t.d.length-1&&(n=l<0?-l:l)<=xn)return r=Yt(d,a,n,i),t.s<0?new d(1).div(r):T(r,i,o);if(s=a.s,s<0){if(e<t.d.length-1)return new d(NaN);if((t.d[e]&1)==0&&(s=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=s,a}return n=G(+a,l),e=n==0||!isFinite(n)?se(l*(Math.log("0."+te(a.d))/Math.LN10+a.e+1)):new d(n+"").e,e>d.maxE+1||e<d.minE-1?new d(e>0?s/0:0):(D=!1,d.rounding=a.s=1,n=Math.min(12,(e+"").length),r=bt(t.times(Pe(a,i+n)),i),r.d&&(r=T(r,i+5,1),je(r.d,i,o)&&(e=i+10,r=T(bt(t.times(Pe(a,e+n)),e),e+5,1),+te(r.d).slice(i+1,i+15)+1==1e14&&(r=T(r,i+1,0)))),r.s=s,D=!0,d.rounding=o,T(r,i,o))};h.toPrecision=function(t,e){var n,i=this,r=i.constructor;return t===void 0?n=Ee(i,i.e<=r.toExpNeg||i.e>=r.toExpPos):(ce(t,1,$e),e===void 0?e=r.rounding:ce(e,0,8),i=T(new r(i),t,e),n=Ee(i,t<=i.e||i.e<=r.toExpNeg,t)),i.isNeg()&&!i.isZero()?"-"+n:n};h.toSignificantDigits=h.toSD=function(t,e){var n=this,i=n.constructor;return t===void 0?(t=i.precision,e=i.rounding):(ce(t,1,$e),e===void 0?e=i.rounding:ce(e,0,8)),T(new i(n),t,e)};h.toString=function(){var t=this,e=t.constructor,n=Ee(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()&&!t.isZero()?"-"+n:n};h.truncated=h.trunc=function(){return T(new this.constructor(this),this.e+1,1)};h.valueOf=h.toJSON=function(){var t=this,e=t.constructor,n=Ee(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()?"-"+n:n};function te(t){var e,n,i,r=t.length-1,o="",s=t[0];if(r>0){for(o+=s,e=1;e<r;e++)i=t[e]+"",n=M-i.length,n&&(o+=Ue(n)),o+=i;s=t[e],i=s+"",n=M-i.length,n&&(o+=Ue(n))}else if(s===0)return"0";for(;s%10===0;)s/=10;return o+s}function ce(t,e,n){if(t!==~~t||t<e||t>n)throw Error(Re+t)}function je(t,e,n,i){var r,o,s,a;for(o=t[0];o>=10;o/=10)--e;return--e<0?(e+=M,r=0):(r=Math.ceil((e+1)/M),e%=M),o=G(10,M-e),a=t[r]%o|0,i==null?e<3?(e==0?a=a/100|0:e==1&&(a=a/10|0),s=n<4&&a==99999||n>3&&a==49999||a==5e4||a==0):s=(n<4&&a+1==o||n>3&&a+1==o/2)&&(t[r+1]/o/100|0)==G(10,e-2)-1||(a==o/2||a==0)&&(t[r+1]/o/100|0)==0:e<4?(e==0?a=a/1e3|0:e==1?a=a/100|0:e==2&&(a=a/10|0),s=(i||n<4)&&a==9999||!i&&n>3&&a==4999):s=((i||n<4)&&a+1==o||!i&&n>3&&a+1==o/2)&&(t[r+1]/o/1e3|0)==G(10,e-3)-1,s}function it(t,e,n){for(var i,r=[0],o,s=0,a=t.length;s<a;){for(o=r.length;o--;)r[o]*=e;for(r[0]+=At.indexOf(t.charAt(s++)),i=0;i<r.length;i++)r[i]>n-1&&(r[i+1]===void 0&&(r[i+1]=0),r[i+1]+=r[i]/n|0,r[i]%=n)}return r.reverse()}function Dn(t,e){var n,i,r;if(e.isZero())return e;i=e.d.length,i<32?(n=Math.ceil(i/3),r=(1/ut(4,n)).toString()):(n=16,r="2.3283064365386962890625e-10"),t.precision+=n,e=ze(t,1,e.times(r),new t(1));for(var o=n;o--;){var s=e.times(e);e=s.times(s).minus(s).times(8).plus(1)}return t.precision-=n,e}var q=(function(){function t(i,r,o){var s,a=0,d=i.length;for(i=i.slice();d--;)s=i[d]*r+a,i[d]=s%o|0,a=s/o|0;return a&&i.unshift(a),i}function e(i,r,o,s){var a,d;if(o!=s)d=o>s?1:-1;else for(a=d=0;a<o;a++)if(i[a]!=r[a]){d=i[a]>r[a]?1:-1;break}return d}function n(i,r,o,s){for(var a=0;o--;)i[o]-=a,a=i[o]<r[o]?1:0,i[o]=a*s+i[o]-r[o];for(;!i[0]&&i.length>1;)i.shift()}return function(i,r,o,s,a,d){var l,u,f,g,v,x,S,Z,z,le,R,j,Ne,ge,me,xe,Ie,he,J,Be,Ae=i.constructor,_e=i.s==r.s?1:-1,V=i.d,P=r.d;if(!V||!V[0]||!P||!P[0])return new Ae(!i.s||!r.s||(V?P&&V[0]==P[0]:!P)?NaN:V&&V[0]==0||!P?_e*0:_e/0);for(d?(v=1,u=i.e-r.e):(d=Te,v=M,u=se(i.e/v)-se(r.e/v)),J=P.length,Ie=V.length,z=new Ae(_e),le=z.d=[],f=0;P[f]==(V[f]||0);f++);if(P[f]>(V[f]||0)&&u--,o==null?(ge=o=Ae.precision,s=Ae.rounding):a?ge=o+(i.e-r.e)+1:ge=o,ge<0)le.push(1),x=!0;else{if(ge=ge/v+2|0,f=0,J==1){for(g=0,P=P[0],ge++;(f<Ie||g)&&ge--;f++)me=g*d+(V[f]||0),le[f]=me/P|0,g=me%P|0;x=g||f<Ie}else{for(g=d/(P[0]+1)|0,g>1&&(P=t(P,g,d),V=t(V,g,d),J=P.length,Ie=V.length),xe=J,R=V.slice(0,J),j=R.length;j<J;)R[j++]=0;Be=P.slice(),Be.unshift(0),he=P[0],P[1]>=d/2&&++he;do g=0,l=e(P,R,J,j),l<0?(Ne=R[0],J!=j&&(Ne=Ne*d+(R[1]||0)),g=Ne/he|0,g>1?(g>=d&&(g=d-1),S=t(P,g,d),Z=S.length,j=R.length,l=e(S,R,Z,j),l==1&&(g--,n(S,J<Z?Be:P,Z,d))):(g==0&&(l=g=1),S=P.slice()),Z=S.length,Z<j&&S.unshift(0),n(R,S,j,d),l==-1&&(j=R.length,l=e(P,R,J,j),l<1&&(g++,n(R,J<j?Be:P,j,d))),j=R.length):l===0&&(g++,R=[0]),le[f++]=g,l&&R[0]?R[j++]=V[xe]||0:(R=[V[xe]],j=1);while((xe++<Ie||R[0]!==void 0)&&ge--);x=R[0]!==void 0}le[0]||le.shift()}if(v==1)z.e=u,Wt=x;else{for(f=1,g=le[0];g>=10;g/=10)f++;z.e=f+u*v-1,T(z,a?o+z.e+1:o,s,x)}return z}})();function T(t,e,n,i){var r,o,s,a,d,l,u,f,g,v=t.constructor;e:if(e!=null){if(f=t.d,!f)return t;for(r=1,a=f[0];a>=10;a/=10)r++;if(o=e-r,o<0)o+=M,s=e,u=f[g=0],d=u/G(10,r-s-1)%10|0;else if(g=Math.ceil((o+1)/M),a=f.length,g>=a)if(i){for(;a++<=g;)f.push(0);u=d=0,r=1,o%=M,s=o-M+1}else break e;else{for(u=a=f[g],r=1;a>=10;a/=10)r++;o%=M,s=o-M+r,d=s<0?0:u/G(10,r-s-1)%10|0}if(i=i||e<0||f[g+1]!==void 0||(s<0?u:u%G(10,r-s-1)),l=n<4?(d||i)&&(n==0||n==(t.s<0?3:2)):d>5||d==5&&(n==4||i||n==6&&(o>0?s>0?u/G(10,r-s):0:f[g-1])%10&1||n==(t.s<0?8:7)),e<1||!f[0])return f.length=0,l?(e-=t.e+1,f[0]=G(10,(M-e%M)%M),t.e=-e||0):f[0]=t.e=0,t;if(o==0?(f.length=g,a=1,g--):(f.length=g+1,a=G(10,M-o),f[g]=s>0?(u/G(10,r-s)%G(10,s)|0)*a:0),l)for(;;)if(g==0){for(o=1,s=f[0];s>=10;s/=10)o++;for(s=f[0]+=a,a=1;s>=10;s/=10)a++;o!=a&&(t.e++,f[0]==Te&&(f[0]=1));break}else{if(f[g]+=a,f[g]!=Te)break;f[g--]=0,a=1}for(o=f.length;f[--o]===0;)f.pop()}return D&&(t.e>v.maxE?(t.d=null,t.e=NaN):t.e<v.minE&&(t.e=0,t.d=[0])),t}function Ee(t,e,n){if(!t.isFinite())return Qt(t);var i,r=t.e,o=te(t.d),s=o.length;return e?(n&&(i=n-s)>0?o=o.charAt(0)+"."+o.slice(1)+Ue(i):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(t.e<0?"e":"e+")+t.e):r<0?(o="0."+Ue(-r-1)+o,n&&(i=n-s)>0&&(o+=Ue(i))):r>=s?(o+=Ue(r+1-s),n&&(i=n-r-1)>0&&(o=o+"."+Ue(i))):((i=r+1)<s&&(o=o.slice(0,i)+"."+o.slice(i)),n&&(i=n-s)>0&&(r+1===s&&(o+="."),o+=Ue(i))),o}function dt(t,e){var n=t[0];for(e*=M;n>=10;n/=10)e++;return e}function at(t,e,n){if(e>Fn)throw D=!0,n&&(t.precision=n),Error(qt);return T(new t(ot),e,1,!0)}function be(t,e,n){if(e>It)throw Error(qt);return T(new t(st),e,n,!0)}function Jt(t){var e=t.length-1,n=e*M+1;if(e=t[e],e){for(;e%10==0;e/=10)n--;for(e=t[0];e>=10;e/=10)n++}return n}function Ue(t){for(var e="";t--;)e+="0";return e}function Yt(t,e,n,i){var r,o=new t(1),s=Math.ceil(i/M+4);for(D=!1;;){if(n%2&&(o=o.times(e),Ht(o.d,s)&&(r=!0)),n=se(n/2),n===0){n=o.d.length-1,r&&o.d[n]===0&&++o.d[n];break}e=e.times(e),Ht(e.d,s)}return D=!0,o}function $t(t){return t.d[t.d.length-1]&1}function Gt(t,e,n){for(var i,r,o=new t(e[0]),s=0;++s<e.length;){if(r=new t(e[s]),!r.s){o=r;break}i=o.cmp(r),(i===n||i===0&&o.s===n)&&(o=r)}return o}function bt(t,e){var n,i,r,o,s,a,d,l=0,u=0,f=0,g=t.constructor,v=g.rounding,x=g.precision;if(!t.d||!t.d[0]||t.e>17)return new g(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(e==null?(D=!1,d=x):d=e,a=new g(.03125);t.e>-2;)t=t.times(a),f+=5;for(i=Math.log(G(2,f))/Math.LN10*2+5|0,d+=i,n=o=s=new g(1),g.precision=d;;){if(o=T(o.times(t),d,1),n=n.times(++u),a=s.plus(q(o,n,d,1)),te(a.d).slice(0,d)===te(s.d).slice(0,d)){for(r=f;r--;)s=T(s.times(s),d,1);if(e==null)if(l<3&&je(s.d,d-i,v,l))g.precision=d+=10,n=o=a=new g(1),u=0,l++;else return T(s,g.precision=x,v,D=!0);else return g.precision=x,s}s=a}}function Pe(t,e){var n,i,r,o,s,a,d,l,u,f,g,v=1,x=10,S=t,Z=S.d,z=S.constructor,le=z.rounding,R=z.precision;if(S.s<0||!Z||!Z[0]||!S.e&&Z[0]==1&&Z.length==1)return new z(Z&&!Z[0]?-1/0:S.s!=1?NaN:Z?0:S);if(e==null?(D=!1,u=R):u=e,z.precision=u+=x,n=te(Z),i=n.charAt(0),Math.abs(o=S.e)<15e14){for(;i<7&&i!=1||i==1&&n.charAt(1)>3;)S=S.times(t),n=te(S.d),i=n.charAt(0),v++;o=S.e,i>1?(S=new z("0."+n),o++):S=new z(i+"."+n.slice(1))}else return l=at(z,u+2,R).times(o+""),S=Pe(new z(i+"."+n.slice(1)),u-x).plus(l),z.precision=R,e==null?T(S,R,le,D=!0):S;for(f=S,d=s=S=q(S.minus(1),S.plus(1),u,1),g=T(S.times(S),u,1),r=3;;){if(s=T(s.times(g),u,1),l=d.plus(q(s,new z(r),u,1)),te(l.d).slice(0,u)===te(d.d).slice(0,u))if(d=d.times(2),o!==0&&(d=d.plus(at(z,u+2,R).times(o+""))),d=q(d,new z(v),u,1),e==null)if(je(d.d,u-x,le,a))z.precision=u+=x,l=s=S=q(f.minus(1),f.plus(1),u,1),g=T(S.times(S),u,1),r=a=1;else return T(d,z.precision=R,le,D=!0);else return z.precision=R,d;d=l,r+=2}}function Qt(t){return String(t.s*t.s/0)}function rt(t,e){var n,i,r;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(i=e.search(/e/i))>0?(n<0&&(n=i),n+=+e.slice(i+1),e=e.substring(0,i)):n<0&&(n=e.length),i=0;e.charCodeAt(i)===48;i++);for(r=e.length;e.charCodeAt(r-1)===48;--r);if(e=e.slice(i,r),e){if(r-=i,t.e=n=n-i-1,t.d=[],i=(n+1)%M,n<0&&(i+=M),i<r){for(i&&t.d.push(+e.slice(0,i)),r-=M;i<r;)t.d.push(+e.slice(i,i+=M));e=e.slice(i),i=M-e.length}else i-=r;for(;i--;)e+="0";t.d.push(+e),D&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function Nn(t,e){var n,i,r,o,s,a,d,l,u;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),Zt.test(e))return rt(t,e)}else if(e==="Infinity"||e==="NaN")return+e||(t.s=NaN),t.e=NaN,t.d=null,t;if(Ln.test(e))n=16,e=e.toLowerCase();else if(En.test(e))n=2;else if(Mn.test(e))n=8;else throw Error(Re+e);for(o=e.search(/p/i),o>0?(d=+e.slice(o+1),e=e.substring(2,o)):e=e.slice(2),o=e.indexOf("."),s=o>=0,i=t.constructor,s&&(e=e.replace(".",""),a=e.length,o=a-o,r=Yt(i,new i(n),o,o*2)),l=it(e,n,Te),u=l.length-1,o=u;l[o]===0;--o)l.pop();return o<0?new i(t.s*0):(t.e=dt(l,u),t.d=l,D=!1,s&&(t=q(t,r,a*4)),d&&(t=t.times(Math.abs(d)<54?G(2,d):Ke.pow(2,d))),D=!0,t)}function Bn(t,e){var n,i=e.d.length;if(i<3)return e.isZero()?e:ze(t,2,e,e);n=1.4*Math.sqrt(i),n=n>16?16:n|0,e=e.times(1/ut(5,n)),e=ze(t,2,e,e);for(var r,o=new t(5),s=new t(16),a=new t(20);n--;)r=e.times(e),e=e.times(o.plus(r.times(s.times(r).minus(a))));return e}function ze(t,e,n,i,r){var o,s,a,d,l=1,u=t.precision,f=Math.ceil(u/M);for(D=!1,d=n.times(n),a=new t(i);;){if(s=q(a.times(d),new t(e++*e++),u,1),a=r?i.plus(s):i.minus(s),i=q(s.times(d),new t(e++*e++),u,1),s=a.plus(i),s.d[f]!==void 0){for(o=f;s.d[o]===a.d[o]&&o--;);if(o==-1)break}o=a,a=i,i=s,s=o,l++}return D=!0,s.d.length=f+1,s}function ut(t,e){for(var n=t;--e;)n*=t;return n}function Xt(t,e){var n,i=e.s<0,r=be(t,t.precision,1),o=r.times(.5);if(e=e.abs(),e.lte(o))return De=i?4:1,e;if(n=e.divToInt(r),n.isZero())De=i?3:2;else{if(e=e.minus(n.times(r)),e.lte(o))return De=$t(n)?i?2:3:i?4:1,e;De=$t(n)?i?1:4:i?3:2}return e.minus(r).abs()}function Et(t,e,n,i){var r,o,s,a,d,l,u,f,g,v=t.constructor,x=n!==void 0;if(x?(ce(n,1,$e),i===void 0?i=v.rounding:ce(i,0,8)):(n=v.precision,i=v.rounding),!t.isFinite())u=Qt(t);else{for(u=Ee(t),s=u.indexOf("."),x?(r=2,e==16?n=n*4-3:e==8&&(n=n*3-2)):r=e,s>=0&&(u=u.replace(".",""),g=new v(1),g.e=u.length-s,g.d=it(Ee(g),10,r),g.e=g.d.length),f=it(u,10,r),o=d=f.length;f[--d]==0;)f.pop();if(!f[0])u=x?"0p+0":"0";else{if(s<0?o--:(t=new v(t),t.d=f,t.e=o,t=q(t,g,n,i,0,r),f=t.d,o=t.e,l=Wt),s=f[n],a=r/2,l=l||f[n+1]!==void 0,l=i<4?(s!==void 0||l)&&(i===0||i===(t.s<0?3:2)):s>a||s===a&&(i===4||l||i===6&&f[n-1]&1||i===(t.s<0?8:7)),f.length=n,l)for(;++f[--n]>r-1;)f[n]=0,n||(++o,f.unshift(1));for(d=f.length;!f[d-1];--d);for(s=0,u="";s<d;s++)u+=At.charAt(f[s]);if(x){if(d>1)if(e==16||e==8){for(s=e==16?4:3,--d;d%s;d++)u+="0";for(f=it(u,r,e),d=f.length;!f[d-1];--d);for(s=1,u="1.";s<d;s++)u+=At.charAt(f[s])}else u=u.charAt(0)+"."+u.slice(1);u=u+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)u="0"+u;u="0."+u}else if(++o>d)for(o-=d;o--;)u+="0";else o<d&&(u=u.slice(0,o)+"."+u.slice(o))}u=(e==16?"0x":e==2?"0b":e==8?"0o":"")+u}return t.s<0?"-"+u:u}function Ht(t,e){if(t.length>e)return t.length=e,!0}function _n(t){return new this(t).abs()}function On(t){return new this(t).acos()}function Cn(t){return new this(t).acosh()}function Un(t,e){return new this(t).plus(e)}function Pn(t){return new this(t).asin()}function Rn(t){return new this(t).asinh()}function $n(t){return new this(t).atan()}function Hn(t){return new this(t).atanh()}function kn(t,e){t=new this(t),e=new this(e);var n,i=this.precision,r=this.rounding,o=i+4;return!t.s||!e.s?n=new this(NaN):!t.d&&!e.d?(n=be(this,o,1).times(e.s>0?.25:.75),n.s=t.s):!e.d||t.isZero()?(n=e.s<0?be(this,i,r):new this(0),n.s=t.s):!t.d||e.isZero()?(n=be(this,o,1).times(.5),n.s=t.s):e.s<0?(this.precision=o,this.rounding=1,n=this.atan(q(t,e,o,1)),e=be(this,o,1),this.precision=i,this.rounding=r,n=t.s<0?n.minus(e):n.plus(e)):n=this.atan(q(t,e,o,1)),n}function Wn(t){return new this(t).cbrt()}function qn(t){return T(t=new this(t),t.e+1,2)}function zn(t,e,n){return new this(t).clamp(e,n)}function Vn(t){if(!t||typeof t!="object")throw Error(lt+"Object expected");var e,n,i,r=t.defaults===!0,o=["precision",1,$e,"rounding",0,8,"toExpNeg",-qe,0,"toExpPos",0,qe,"maxE",0,qe,"minE",-qe,0,"modulo",0,9];for(e=0;e<o.length;e+=3)if(n=o[e],r&&(this[n]=Tt[n]),(i=t[n])!==void 0)if(se(i)===i&&i>=o[e+1]&&i<=o[e+2])this[n]=i;else throw Error(Re+n+": "+i);if(n="crypto",r&&(this[n]=Tt[n]),(i=t[n])!==void 0)if(i===!0||i===!1||i===0||i===1)if(i)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(zt);else this[n]=!1;else throw Error(Re+n+": "+i);return this}function Zn(t){return new this(t).cos()}function Jn(t){return new this(t).cosh()}function jt(t){var e,n,i;function r(o){var s,a,d,l=this;if(!(l instanceof r))return new r(o);if(l.constructor=r,kt(o)){l.s=o.s,D?!o.d||o.e>r.maxE?(l.e=NaN,l.d=null):o.e<r.minE?(l.e=0,l.d=[0]):(l.e=o.e,l.d=o.d.slice()):(l.e=o.e,l.d=o.d?o.d.slice():o.d);return}if(d=typeof o,d==="number"){if(o===0){l.s=1/o<0?-1:1,l.e=0,l.d=[0];return}if(o<0?(o=-o,l.s=-1):l.s=1,o===~~o&&o<1e7){for(s=0,a=o;a>=10;a/=10)s++;D?s>r.maxE?(l.e=NaN,l.d=null):s<r.minE?(l.e=0,l.d=[0]):(l.e=s,l.d=[o]):(l.e=s,l.d=[o]);return}if(o*0!==0){o||(l.s=NaN),l.e=NaN,l.d=null;return}return rt(l,o.toString())}if(d==="string")return(a=o.charCodeAt(0))===45?(o=o.slice(1),l.s=-1):(a===43&&(o=o.slice(1)),l.s=1),Zt.test(o)?rt(l,o):Nn(l,o);if(d==="bigint")return o<0?(o=-o,l.s=-1):l.s=1,rt(l,o.toString());throw Error(Re+o)}if(r.prototype=h,r.ROUND_UP=0,r.ROUND_DOWN=1,r.ROUND_CEIL=2,r.ROUND_FLOOR=3,r.ROUND_HALF_UP=4,r.ROUND_HALF_DOWN=5,r.ROUND_HALF_EVEN=6,r.ROUND_HALF_CEIL=7,r.ROUND_HALF_FLOOR=8,r.EUCLID=9,r.config=r.set=Vn,r.clone=jt,r.isDecimal=kt,r.abs=_n,r.acos=On,r.acosh=Cn,r.add=Un,r.asin=Pn,r.asinh=Rn,r.atan=$n,r.atanh=Hn,r.atan2=kn,r.cbrt=Wn,r.ceil=qn,r.clamp=zn,r.cos=Zn,r.cosh=Jn,r.div=Yn,r.exp=Gn,r.floor=Qn,r.hypot=Xn,r.ln=jn,r.log=Kn,r.log10=ti,r.log2=ei,r.max=ni,r.min=ii,r.mod=ri,r.mul=oi,r.pow=si,r.random=ai,r.round=li,r.sign=di,r.sin=ui,r.sinh=fi,r.sqrt=ci,r.sub=gi,r.sum=mi,r.tan=hi,r.tanh=pi,r.trunc=vi,t===void 0&&(t={}),t&&t.defaults!==!0)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<i.length;)t.hasOwnProperty(n=i[e++])||(t[n]=this[n]);return r.config(t),r}function Yn(t,e){return new this(t).div(e)}function Gn(t){return new this(t).exp()}function Qn(t){return T(t=new this(t),t.e+1,3)}function Xn(){var t,e,n=new this(0);for(D=!1,t=0;t<arguments.length;)if(e=new this(arguments[t++]),e.d)n.d&&(n=n.plus(e.times(e)));else{if(e.s)return D=!0,new this(1/0);n=e}return D=!0,n.sqrt()}function kt(t){return t instanceof Ke||t&&t.toStringTag===Vt||!1}function jn(t){return new this(t).ln()}function Kn(t,e){return new this(t).log(e)}function ei(t){return new this(t).log(2)}function ti(t){return new this(t).log(10)}function ni(){return Gt(this,arguments,-1)}function ii(){return Gt(this,arguments,1)}function ri(t,e){return new this(t).mod(e)}function oi(t,e){return new this(t).mul(e)}function si(t,e){return new this(t).pow(e)}function ai(t){var e,n,i,r,o=0,s=new this(1),a=[];if(t===void 0?t=this.precision:ce(t,1,$e),i=Math.ceil(t/M),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(i));o<i;)r=e[o],r>=429e7?e[o]=crypto.getRandomValues(new Uint32Array(1))[0]:a[o++]=r%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(i*=4);o<i;)r=e[o]+(e[o+1]<<8)+(e[o+2]<<16)+((e[o+3]&127)<<24),r>=214e7?crypto.randomBytes(4).copy(e,o):(a.push(r%1e7),o+=4);o=i/4}else throw Error(zt);else for(;o<i;)a[o++]=Math.random()*1e7|0;for(i=a[--o],t%=M,i&&t&&(r=G(10,M-t),a[o]=(i/r|0)*r);a[o]===0;o--)a.pop();if(o<0)n=0,a=[0];else{for(n=-1;a[0]===0;n-=M)a.shift();for(i=1,r=a[0];r>=10;r/=10)i++;i<M&&(n-=M-i)}return s.e=n,s.d=a,s}function li(t){return T(t=new this(t),t.e+1,this.rounding)}function di(t){return t=new this(t),t.d?t.d[0]?t.s:0*t.s:t.s||NaN}function ui(t){return new this(t).sin()}function fi(t){return new this(t).sinh()}function ci(t){return new this(t).sqrt()}function gi(t,e){return new this(t).sub(e)}function mi(){var t=0,e=arguments,n=new this(e[t]);for(D=!1;n.s&&++t<e.length;)n=n.plus(e[t]);return D=!0,T(n,this.precision,this.rounding)}function hi(t){return new this(t).tan()}function pi(t){return new this(t).tanh()}function vi(t){return T(t=new this(t),t.e+1,1)}h[Symbol.for("nodejs.util.inspect.custom")]=h.toString;h[Symbol.toStringTag]="Decimal";var Ke=h.constructor=jt(Tt);ot=new Ke(ot);st=new Ke(st);var L=Ke;var Je=Rt(en()),Bt=Rt(dn());L.set({precision:20,rounding:L.ROUND_HALF_UP});var hn=(i=>(i.STANDARD="STANDARD",i.SLOW="SLOW",i.RAPID="RAPID",i))(hn||{});var pn=(i=>(i.DILUTE_INITIAL="DILUTE_INITIAL",i.DILUTE_ALL="DILUTE_ALL",i.DILUTE_NONE="DILUTE_NONE",i))(pn||{}),vt=2,He=1,vn={STANDARD:[1,2.5,5,10,20,40,80,120,160,240,300].map(t=>new L(t)),SLOW:[.5,1,1.5,2.5,5,10,20,30,40,60,80,100,120,140,160,190,220,260,300].map(t=>new L(t)),RAPID:[5,10,20,40,80,160,300].map(t=>new L(t))},Ii=[.2,.25,.3,.35,.4,.45,.5,1,2,5,10,12,14,16,18,20,25,30].map(t=>new L(t)),bi=[.5,1,1.5,2,2.5,3,3.5,4,4.5,5,6,7,8,9,10,14,16,18,20,25,30].map(t=>new L(t)),Ei=[.5,1,1.5,2,2.5,3,4,5,7,9,10,11,12].map(t=>new L(t)),un=new L(500),we;we={minMeasurableMass:new L(.2),minMeasurableVolume:new L(.2),minServingsForMix:new L(3),PROTEIN_TOLERANCE:new L(.05),DEFAULT_FOOD_A_DILUTION_THRESHOLD:new L(.2),DEFAULT_FOOD_B_THRESHOLD:new L(.2),MAX_SOLID_CONCENTRATION:new L(.05)};var c=null,Nt=[],_t=[],yn=[],Le="",wn="",Ve=null,ue=-1,Ge="";function Se(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function O(t,e){return t==null?"":(typeof t=="number"?t:t.toNumber()).toFixed(e)}function ne(t,e){if(t==null)return"";let n=typeof t=="number"?t:t.toNumber();return e==="g"?n.toFixed(vt):n%1===0?n.toFixed(0):n.toFixed(He)}function mt(t){return t.type==="LIQUID"?"ml":"g"}function Li(t,e,n){let i=[],r=e.type==="SOLID"?Ii:bi,o=e.type==="SOLID"?t.dividedBy(n.MAX_SOLID_CONCENTRATION.times(e.getMgPerUnit())):null;for(let s of r){let a=s;for(let d of Ei){let l=d;if(e.type==="SOLID"){let u=a.times(e.getMgPerUnit()),f=u.dividedBy(t);if(f.lessThan(n.minServingsForMix))continue;let g=l.times(f),v=g;if(a.lessThan(n.minMeasurableMass)||l.lessThan(n.minMeasurableVolume)||v.greaterThan(un)||v.lessThan(n.minMeasurableVolume)||u.dividedBy(g).times(l).dividedBy(t).minus(1).abs().greaterThan(n.PROTEIN_TOLERANCE))continue;i.push({mixFoodAmount:a,mixWaterAmount:v,dailyAmount:l,mixTotalVolume:g,servings:f})}else{let u=a.times(e.getMgPerUnit()),f=u.dividedBy(t);if(f.lessThan(n.minServingsForMix))continue;let g=l.times(f),v=g.minus(a);if(v.lessThan(0)||a.lessThan(n.minMeasurableVolume)||l.lessThan(n.minMeasurableVolume)||v.greaterThan(un)||v.lessThan(n.minMeasurableVolume)||u.dividedBy(g).times(l).dividedBy(t).minus(1).abs().greaterThan(n.PROTEIN_TOLERANCE))continue;i.push({mixFoodAmount:a,mixWaterAmount:v,dailyAmount:l,mixTotalVolume:g,servings:f})}}}return i.sort((s,a)=>{if(e.type==="SOLID"&&o){let l=s.dailyAmount.greaterThanOrEqualTo(o),u=a.dailyAmount.greaterThanOrEqualTo(o);if(l&&!u)return-1;if(!l&&u)return 1}let d=s.mixFoodAmount.comparedTo(a.mixFoodAmount);return d!==0||(d=s.dailyAmount.comparedTo(a.dailyAmount),d!==0)||(d=s.mixTotalVolume.comparedTo(a.mixTotalVolume),d!==0)?d:s.mixWaterAmount.comparedTo(a.mixWaterAmount)}),i}function Ot(t,e,n,i,r,o){let s=t,a=s.dividedBy(n.getMgPerUnit()),d=n.type==="SOLID"?"g":"ml",l=!1;if(i==="DILUTE_INITIAL"?l=a.lessThan(r):i==="DILUTE_ALL"?l=!0:l=!1,l){let u=Li(s,n,o);if(u.length===0)return null;let f=u[0];return{stepIndex:e,targetMg:s,method:"DILUTE",dailyAmount:f.dailyAmount,dailyAmountUnit:"ml",mixFoodAmount:f.mixFoodAmount,mixWaterAmount:f.mixWaterAmount,servings:f.servings,food:"A"}}else return{stepIndex:e,targetMg:s,method:"DIRECT",dailyAmount:a,dailyAmountUnit:d,food:"A"}}function Sn(t,e){let n="STANDARD",i="DILUTE_INITIAL",r=t.type==="SOLID"?"g":"ml",o=we.DEFAULT_FOOD_A_DILUTION_THRESHOLD,s=vn[n],a=[];for(let d=0;d<s.length;d++){let l=Ot(s[d],d+1,t,i,o,e);if(l)a.push(l);else{let u=s[d],f=u.dividedBy(t.getMgPerUnit());a.push({stepIndex:d+1,targetMg:u,method:"DIRECT",dailyAmount:f,dailyAmountUnit:r,food:"A"})}}return{dosingStrategy:n,foodA:t,foodAStrategy:i,diThreshold:o,steps:a,config:e}}function An(t){if(!t.foodB)return t.steps.length;for(let e=0;e<t.steps.length;e++)if(t.steps[e].food==="B")return e;return t.steps.length}function Ye(t,e,n){let i=n.amount.times(e.getMgPerUnit());t.foodB=e,t.foodBThreshold=n;let r=-1;for(let f=0;f<t.steps.length;f++)if(t.steps[f].targetMg.greaterThanOrEqualTo(i)){r=f;break}if(r===-1)return;let o=[];for(let f=r+1;f<t.steps.length;f++)o.push(t.steps[f].targetMg);let s=t.steps[r].targetMg,a=[],d=e.type==="SOLID"?"g":"ml",l=s,u=l.dividedBy(e.getMgPerUnit());a.push({stepIndex:r+2,targetMg:l,method:"DIRECT",dailyAmount:u,dailyAmountUnit:d,food:"B"});for(let f of o){let g=f.dividedBy(e.getMgPerUnit());a.push({stepIndex:0,targetMg:f,method:"DIRECT",dailyAmount:g,dailyAmountUnit:d,food:"B"})}t.steps=t.steps.slice(0,r+1),t.steps.push(...a);for(let f=0;f<t.steps.length;f++)t.steps[f].stepIndex=f+1}function Tn(t){let e=[];if(t.steps.length<5&&e.push({severity:"red",code:"R1",message:"Protocol < 5 steps, which is quite rapid for a full OIT protocol."}),t.foodA.getMgPerUnit().lessThanOrEqualTo(new L(0))&&e.push({severity:"red",code:"R7",message:`${Se(t.foodA.name)} protein concentration must be > 0 to be considered for OIT`}),t.foodB?.getMgPerUnit().lessThanOrEqualTo(new L(0))&&e.push({severity:"red",code:"R7",message:`${Se(t.foodB?.name||"")} protein concentration must be > 0 to be considered for OIT`}),t.foodB){let n=!1;for(let i of t.steps)i.food==="B"&&(n=!0);n===!1&&e.push({severity:"yellow",code:"Y5",message:`${Se(t.foodB.name)} has no transition point. Decrease the threshold if you want to transition.`})}for(let n of t.steps){let r=n.food==="B"?t.foodB:t.foodA;if(n.targetMg.lessThanOrEqualTo(new L(0))&&e.push({severity:"red",code:"R8",message:`Step ${n.stepIndex}: A target protein of ${O(n.targetMg,1)} mg is NOT valid. It must be >0.`,stepIndex:n.stepIndex}),n.method==="DILUTE"){let o=mt(r),s=new L(ne(n.mixFoodAmount,o)),a=new L(ne(n.mixWaterAmount,"ml")),d=new L(ne(n.dailyAmount,"ml")),l=s.times(r.getMgPerUnit()),u=r.type==="SOLID"?a:s.plus(a);u.isZero()&&(u=new L(1),console.log("mixTotalVolumeBasedOnRounded is 0",u));let f=l.times(d).dividedBy(u);if(!n.targetMg.isZero()){let v=f.dividedBy(n.targetMg).minus(1).abs();v.greaterThan(we.PROTEIN_TOLERANCE)&&e.push({severity:"red",code:"R2",message:`Step ${n.stepIndex}: Protein mismatch. Target ${O(n.targetMg,1)} mg but calculated ${O(f,1)} mg: ${O(v.times(100),0)}% difference.`,stepIndex:n.stepIndex})}if(n.servings.lessThan(new L(1))){let v=n.mixFoodAmount.times(r.getMgPerUnit());e.push({severity:"red",code:"R5",message:`Step ${n.stepIndex}: ${ne(n.mixFoodAmount,mt(r))} ${mt(r)} of food only makes ${O(v,1)} mg of total protein. However, target protein is ${O(n.targetMg,1)} mg.`,stepIndex:n.stepIndex})}let g=r.type==="SOLID"?n.mixWaterAmount:n.mixFoodAmount.plus(n.mixWaterAmount);g.lessThan(n.dailyAmount)&&e.push({severity:"red",code:"R6",message:`Step ${n.stepIndex}: Total volume of dilution is ${O(g,He)} ml; however, daily amount is ${O(n.dailyAmount,He)} ml, which is impossible`,stepIndex:n.stepIndex}),n.dailyAmount.lessThanOrEqualTo(0)&&e.push({severity:"red",code:"R9",message:`Step ${n.stepIndex}: Daily amount cannot be <= 0 ml`,stepIndex:n.stepIndex}),n.mixFoodAmount.lessThanOrEqualTo(0)&&e.push({severity:"red",code:"R9",message:`Step ${n.stepIndex}: Amount of food to mix cannot be <= 0 ${mt(r)}`,stepIndex:n.stepIndex}),n.mixWaterAmount.lessThan(0)&&e.push({severity:"red",code:"R9",message:`Step ${n.stepIndex}: Amount of water to mix cannot be < 0 ml`,stepIndex:n.stepIndex}),r.type==="SOLID"&&s.lessThan(t.config.minMeasurableMass)&&e.push({severity:"yellow",code:"Y3",message:`Step ${n.stepIndex}: Measuring ${O(n.mixFoodAmount,vt)} g of food is impractical. Aim for value \u2265 ${t.config.minMeasurableMass} g`,stepIndex:n.stepIndex}),r.type==="LIQUID"&&s.lessThan(t.config.minMeasurableVolume)&&e.push({severity:"yellow",code:"Y3",message:`Step ${n.stepIndex}: Measuring ${O(n.mixFoodAmount,He)} ml of food is impractical. Aim for value \u2265 ${t.config.minMeasurableVolume} ml`,stepIndex:n.stepIndex}),d.lessThan(t.config.minMeasurableVolume)&&e.push({severity:"yellow",code:"Y3",message:`Step ${n.stepIndex}: Measuring a daily amount of ${O(n.dailyAmount,He)} ml is impractical. Aim for value \u2265 ${t.config.minMeasurableVolume} ml`,stepIndex:n.stepIndex}),a.lessThan(t.config.minMeasurableVolume)&&e.push({severity:"yellow",code:"Y3",message:`Step ${n.stepIndex}: Measuring ${O(n.mixWaterAmount,He)} ml of water is impractical. Aim for value \u2265 ${t.config.minMeasurableVolume} ml`,stepIndex:n.stepIndex}),n.servings.lessThan(t.config.minServingsForMix)&&n.servings.greaterThan(new L(1))&&e.push({severity:"yellow",code:"Y1",message:`Step ${n.stepIndex}: Only ${O(n.servings,1)} servings (< ${we.minServingsForMix} - impractical). Consider increasing mix amounts.`,stepIndex:n.stepIndex}),r.type==="SOLID"&&n.mixFoodAmount.dividedBy(n.mixWaterAmount).greaterThan(new L(we.MAX_SOLID_CONCENTRATION))&&e.push({severity:"yellow",code:"Y4",message:`Step ${n.stepIndex}: at ${O(n.mixFoodAmount,vt)} g of food in ${O(n.mixWaterAmount,He)} ml of water, the w/v is > ${O(we.MAX_SOLID_CONCENTRATION.times(100),0)}%. The assumption that the food contributes non-negligibly to the total volume of dilution is likely violated. Consider increasing the Daily Amount`,stepIndex:n.stepIndex})}else if(n.method==="DIRECT"){let o=n.dailyAmountUnit,s=new L(ne(n.dailyAmount,o)),a=s.times(r.getMgPerUnit());if(!n.targetMg.isZero()){let d=a.dividedBy(n.targetMg).minus(1).abs();d.greaterThan(we.PROTEIN_TOLERANCE)&&e.push({severity:"red",code:"R2",message:`Step ${n.stepIndex}: Protein mismatch. Target ${O(n.targetMg,1)} mg but calculated ${O(a,1)} mg: ${O(d.times(100),0)}% difference.`,stepIndex:n.stepIndex})}r.type==="SOLID"&&s.lessThan(t.config.minMeasurableMass)&&e.push({severity:"yellow",code:"Y3",message:`Step ${n.stepIndex}: Measuring ${O(n.dailyAmount,vt)} g of food is impractical. Aim for \u2265 ${t.config.minMeasurableMass} g`,stepIndex:n.stepIndex}),r.type==="LIQUID"&&s.lessThan(t.config.minMeasurableVolume)&&e.push({severity:"yellow",code:"Y3",message:`Step ${n.stepIndex}: Measuring ${O(n.dailyAmount,He)} ml of food is impractical. Aim for \u2265 ${t.config.minMeasurableVolume} ml`,stepIndex:n.stepIndex})}}for(let n=1;n<t.steps.length;n++)t.steps[n].targetMg.lessThan(t.steps[n-1].targetMg)&&e.push({severity:"yellow",code:"Y2",message:`Steps must be ascending or equal \u2014 check step ${t.steps[n].stepIndex} vs step ${t.steps[n-1].stepIndex}.`,stepIndex:t.steps[n].stepIndex});return e}function et(){if(!c)return;let t=vn[c.dosingStrategy],e=[];for(let n=0;n<t.length;n++){let i=Ot(t[n],n+1,c.foodA,c.foodAStrategy,c.diThreshold,c.config);i&&e.push(i)}c.steps=e,c.foodB&&c.foodBThreshold&&Ye(c,c.foodB,c.foodBThreshold),X(),ie()}function Ze(){if(!c)return;let t=c.steps.map(i=>i.targetMg),e=c.steps.map(i=>i.food),n=[];for(let i=0;i<t.length;i++){let r=t[i],o=e[i]==="B",s=o?c.foodB:c.foodA,a=o?"DILUTE_NONE":c.foodAStrategy,d=Ot(r,i+1,s,a,c.diThreshold,c.config);d&&(d.food=e[i],n.push(d))}c.steps=n,X(),ie()}function Mi(t,e){if(!c)return;let n=c.steps[t-1];if(!n)return;try{n.targetMg=new L(e)}catch{console.error("Invalid number format for targetMg:",e);return}let r=n.food==="B"?c.foodB:c.foodA;if(n.method==="DIRECT")n.dailyAmount=n.targetMg.dividedBy(r.getMgPerUnit());else{let o=n.mixFoodAmount.times(r.getMgPerUnit());if(n.servings=o.dividedBy(n.targetMg),r.type==="SOLID"){let s=n.dailyAmount.times(n.servings);n.mixWaterAmount=s}else{let s=n.dailyAmount.times(n.servings);n.mixWaterAmount=s.minus(n.mixFoodAmount)}}X(),ie()}function xi(t,e){if(!c)return;let n=c.steps[t-1];if(!n)return;n.dailyAmount=new L(e);let r=n.food==="B"?c.foodB:c.foodA;if(n.method==="DIRECT")n.targetMg=n.dailyAmount.times(r.getMgPerUnit());else{let o=n.mixFoodAmount.times(r.getMgPerUnit());if(n.servings=o.dividedBy(n.targetMg),r.type==="SOLID"){let s=n.dailyAmount.times(n.servings);n.mixWaterAmount=s}else{let s=n.dailyAmount.times(n.servings);n.mixWaterAmount=s.minus(n.mixFoodAmount)}}X(),ie()}function Fi(t,e){if(!c)return;let n=c.steps[t-1];if(!n||n.method!=="DILUTE")return;n.mixFoodAmount=new L(e);let r=n.food==="B"?c.foodB:c.foodA,o=n.mixFoodAmount.times(r.getMgPerUnit());if(n.servings=o.dividedBy(n.targetMg),r.type==="SOLID"){let s=n.dailyAmount.times(n.servings);n.mixWaterAmount=s}else{let s=n.dailyAmount.times(n.servings);n.mixWaterAmount=s.minus(n.mixFoodAmount)}X(),ie()}function Di(t){if(!c)return;let e=c.steps[t-1];if(!e)return;let n={stepIndex:e.stepIndex+1,targetMg:e.targetMg,method:e.method,dailyAmount:e.dailyAmount,dailyAmountUnit:e.dailyAmountUnit,food:e.food};e.method==="DILUTE"&&(n.mixFoodAmount=e.mixFoodAmount,n.mixWaterAmount=e.mixWaterAmount,n.servings=e.servings),c.steps.splice(t,0,n);for(let i=0;i<c.steps.length;i++)c.steps[i].stepIndex=i+1;X(),ie()}function Ni(t){if(c&&!(c.steps.length<=1)){c.steps.splice(t-1,1);for(let e=0;e<c.steps.length;e++)c.steps[e].stepIndex=e+1;X(),ie()}}function ht(t){if(!c)return;let e=t?c.foodB:c.foodA;e.type=e.type==="SOLID"?"LIQUID":"SOLID";for(let n of c.steps)if(n.food==="B"===t)if(n.method==="DILUTE"){n.dailyAmountUnit="ml";let r=n.mixFoodAmount.times(e.getMgPerUnit());if(n.servings=r.dividedBy(n.targetMg),e.type==="SOLID"){let o=n.dailyAmount.times(n.servings);n.mixWaterAmount=o}else{let o=n.dailyAmount.times(n.servings);n.mixWaterAmount=o.minus(n.mixFoodAmount)}}else n.dailyAmountUnit=e.type==="SOLID"?"g":"ml";Me(),X(),ie()}function Ct(){let t=document.querySelector(".dosing-strategy-container"),e=document.querySelector(".warnings-container");t&&t.classList.remove("oit-hidden-on-init"),e&&e.classList.remove("oit-hidden-on-init")}function Me(){if(!c)return;let t=document.querySelector(".food-a-container"),e=document.querySelector(".food-b-container"),n=`
    <div class="food-a-settings">
      <input
        type="text"
        class="food-name-input"
        id="food-a-name"
        value="${Se(c.foodA.name)}"
      />
      <div class="setting-row">
        <label>Protein:</label>
      <div class="input-unit-group">
        <input
          type="number"
          min="0"
          max="${c.foodA.servingSize}"
          id="food-a-protein"
          value="${c.foodA.gramsInServing.toFixed(1)}"
          step="0.1"
        />
        <span>g per</span>
        <input
          type="number"
          min="0"
          id="food-a-serving-size"
          value="${c.foodA.servingSize.toFixed(1)}"
          step="0.1"
        />
        <span>${c.foodA.type==="SOLID"?"g":"ml"}</span>
      </div>
      </div>
      <div class="setting-row">
        <label>Form:</label>
        <div class="toggle-group">
          <button class="toggle-btn ${c.foodA.type==="SOLID"?"active":""}" data-action="toggle-food-a-solid">Solid</button>
          <button class="toggle-btn ${c.foodA.type==="LIQUID"?"active":""}" data-action="toggle-food-a-liquid">Liquid</button>
        </div>
      </div>
      <div class="setting-row">
        <label>Dilution strategy:</label>
        <div class="toggle-group">
          <button class="toggle-btn ${c.foodAStrategy==="DILUTE_INITIAL"?"active":""}" data-action="food-a-strategy-initial">Initial dilution</button>
          <button class="toggle-btn ${c.foodAStrategy==="DILUTE_ALL"?"active":""}" data-action="food-a-strategy-all">Dilution throughout</button>
          <button class="toggle-btn ${c.foodAStrategy==="DILUTE_NONE"?"active":""}" data-action="food-a-strategy-none">No dilutions</button>
        </div>
      </div>
      ${c.foodAStrategy==="DILUTE_INITIAL"?`
      <div class="setting-row threshold-setting">
        <label>Directly dose when neat amount \u2265</label>
        <div class="input-unit-group">
          <input
            type="number"
            id="food-a-threshold"
            min="0"
            value="${ne(c.diThreshold,c.foodA.type==="SOLID"?"g":"ml")}"
            step="0.1"
          />
          <span>${c.foodA.type==="SOLID"?"g":"ml"}</span>
        </div>
      </div>
      `:""}
    </div>
  `,i=t.querySelector(".food-a-settings");if(i?i.outerHTML=n:t.insertAdjacentHTML("beforeend",n),c.foodB){let r=`
      <div class="food-b-settings">
        <input
          type="text"
          class="food-name-input"
          id="food-b-name"
          value="${Se(c.foodB.name)}"
        />
        <div class="setting-row">
          <label>Protein:</label>
          <div class="input-unit-group">
            <input
              type="number"
              id="food-b-protein"
              min="0"
              max="${c.foodB.servingSize}"
              value="${c.foodB.gramsInServing.toFixed(1)}"
              step="0.1"
            />
            <span>g per</span>
            <input
              type="number"
              id="food-b-serving-size"
              min="0"
              value="${c.foodB.servingSize.toFixed(1)}"
              step="0.1"
            />
            <span>${c.foodB.type==="SOLID"?"g":"ml"}</span>
          </div>
        </div>
        <div class="setting-row">
          <label>Form:</label>
          <div class="toggle-group">
            <button class="toggle-btn ${c.foodB.type==="SOLID"?"active":""}" data-action="toggle-food-b-solid">Solid</button>
            <button class="toggle-btn ${c.foodB.type==="LIQUID"?"active":""}" data-action="toggle-food-b-liquid">Liquid</button>
          </div>
        </div>
        <div class="setting-row threshold-setting">
          <label>Transition when daily amount \u2265</label>
          <div class="input-unit-group">
            <input
              type="number"
              id="food-b-threshold"
              value="${ne(c.foodBThreshold.amount,c.foodBThreshold.unit)}"
              step="0.1"
              min="0"
            />
            <span>${c.foodBThreshold.unit}</span>
          </div>
        </div>
      </div>
    `,o=e.querySelector(".food-b-settings");o?o.outerHTML=r:e.insertAdjacentHTML("beforeend",r)}else{let r=e.querySelector(".food-b-settings");r&&r.remove()}Pi()}function yt(){if(!c)return;let t=document.querySelector(".dosing-strategy-container"),e=`
    <h3>Dosing Strategy (resets all steps on change)</h3>
    <div class="setting-row">
      <div class="toggle-group">
        <button class="toggle-btn ${c.dosingStrategy==="STANDARD"?"active":""}" data-strategy="STANDARD">Standard</button>
        <button class="toggle-btn ${c.dosingStrategy==="SLOW"?"active":""}" data-strategy="SLOW">Slow</button>
        <button class="toggle-btn ${c.dosingStrategy==="RAPID"?"active":""}" data-strategy="RAPID">Rapid</button>
      </div>
    </div>
  `;t.innerHTML=e,t.querySelectorAll("[data-strategy]").forEach(n=>{n.addEventListener("click",i=>{let r=i.target.getAttribute("data-strategy");c&&r!==c.dosingStrategy&&(c.dosingStrategy=r,et(),yt())})})}function X(){if(!c)return;let t=document.querySelector(".output-container table"),e=`
    <thead>
      <tr>
        <th>Step</th>
        <th>Protein (mg)</th>
        <th>Method</th>
        <th>Amount for mixture</th>
        <th>Water for mixture</th>
        <th>Daily amount</th>
      </tr>
    </thead>
    <tbody>
  `,n=!0,i=Tn(c),r=new Map;for(let a of i)if(a.stepIndex!==void 0){let d=r.get(a.stepIndex);(!d||a.severity==="red"&&d==="yellow")&&r.set(a.stepIndex,a.severity)}for(let a of c.steps){let d=a.food==="B",l=d?c.foodB:c.foodA;d&&n?(e+=`
        <tr class="food-section-header">
          <td colspan="6">${Se(c.foodB.name)}</td>
        </tr>
      `,n=!1):!d&&a.stepIndex===1&&(e+=`
        <tr class="food-section-header">
          <td colspan="6">${Se(c.foodA.name)}</td>
        </tr>
      `);let u=r.get(a.stepIndex),f=u?`warning-highlight-${u}`:"";if(e+=`<tr class="${f}">`,e+=`
      <td>
        <div class="actions-cell">
          <button class="btn-add-step" data-step="${a.stepIndex}">+</button>
          <button class="btn-remove-step" data-step="${a.stepIndex}">\u2212</button>
          <span class="step-number">${a.stepIndex}</span>
        </div>
      </td>
    `,e+=`
      <td>
        <input
          class="editable"
          type="number"
          data-step="${a.stepIndex}"
          data-field="targetMg"
          value="${O(a.targetMg,1)}"
          step="0.1"
          min="0"
        />
      </td>
    `,e+=`
      <td class="method-cell">${a.method}</td>
    `,a.method==="DILUTE"){let g=l.type==="SOLID"?"g":"ml";e+=`
        <td>
          <input
            class="editable"
            type="number"
            data-step="${a.stepIndex}"
            data-field="mixFoodAmount"
            min="0"
            value="${ne(a.mixFoodAmount,g)}"
            step="0.01"
          />
          <span> ${g}</span>
        </td>
      `}else e+='<td class="na-cell">n/a</td>';a.method==="DILUTE"?e+=`
        <td class="non-editable">
          ${ne(a.mixWaterAmount,"ml")} ml
          <span style="color: var(--oit-text-secondary); font-size: 0.85rem;"> (${O(a.servings,1)} servings)</span>
        </td>
      `:e+='<td class="na-cell">n/a</td>',e+=`
      <td>
        <input
          class="editable"
          type="number"
          data-step="${a.stepIndex}"
          data-field="dailyAmount"
          value="${ne(a.dailyAmount,a.dailyAmountUnit)}"
          step="0.1"
          min="0"
        />
        <span> ${a.dailyAmountUnit}</span>
      </td>
    `,e+="</tr>"}e+="</tbody>",t.innerHTML=e;let o=document.querySelector(".bottom-section");if(!o.querySelector(".export-container")){let a=`
      <div class="export-container">
        <div class="export-buttons">
          <button class="btn-export" id="export-ascii">Copy ASCII</button>
          <button class="btn-export" id="export-pdf">Export PDF</button>
        </div>
        <div class="custom-note-container">
          <label for="custom-note">Notes:</label>
          <textarea
            id="custom-note"
            class="custom-note-textarea"
            placeholder="Add any custom notes or instructions ..."
            rows="8"
          >${Se(Le)}</textarea>
        </div>
      </div>
    `;o.insertAdjacentHTML("afterbegin",a),$i(),Hi()}Ri()}function ie(){if(!c)return;let t=Tn(c),e=document.querySelector(".warnings-container");if(t.length===0){e.innerHTML=`
      <div class="no-warnings">
      \u2713 Protocol passes internal checks: see <a href="${wn}" target="_blank"> here </a> for the issues we check for.<br><br>THIS DOES NOT GUARANTEE THE PROTOCOL IS SAFE.
      </div>
    `;return}let n=t.filter(o=>o.severity==="red"),i=t.filter(o=>o.severity==="yellow"),r="";n.length>0&&(r+=`
      <div class="warning-section red-warnings">
        <h4>Critical Issues (Red)</h4>
        <ul>
          ${n.map(o=>`<li><strong>${o.message}</strong></li>`).join("")}
        </ul>
      </div>
    `),i.length>0&&(r+=`
      <div class="warning-section yellow-warnings">
        <h4>Cautions (Yellow)</h4>
        <ul>
          ${i.map(o=>`<li>${o.message}</li>`).join("")}
        </ul>
      </div>
    `),e.innerHTML=r}function fn(t,e){if(!t.trim())return[];if(e==="food")return[...Je.default.go(t,_t,{key:"prepared",limit:50,threshold:-1e4})];{let n=Je.default.go(t,_t,{key:"prepared",limit:25,threshold:-1e4});return[...Je.default.go(t,yn,{key:"prepared",limit:25,threshold:-1e4}),...n]}}function cn(t,e,n){let r=document.getElementById(t).parentElement,o=r.querySelector(".search-dropdown");if(o&&o.remove(),e.length===0&&!n.trim())return;let s=document.createElement("div");s.className="search-dropdown",ue=-1,Ge=t;let a=document.createElement("div");a.className="search-result-item",a.setAttribute("data-index","0"),a.innerHTML=`<strong>Custom:</strong> ${Se(n||"New food")}`,a.addEventListener("click",()=>{Oi(n||"New Food",t),We(t)}),s.appendChild(a);let d=e.slice(0,50);for(let l=0;l<d.length;l++){let u=d[l],f=document.createElement("div");if(f.className="search-result-item",f.setAttribute("data-index",String(l+1)),u.obj.name)f.innerHTML=`<strong>Protocol:</strong> ${Se(u.obj.name)}`,f.addEventListener("click",()=>{Ci(u.obj),We(t)});else{let g=u.obj;f.innerHTML=`
        ${Se(g.Food)}
        <span class="food-type"> - ${Se(g.Type)} - Protein: ${g["Mean protein in grams"].toFixed(1)} g/${g["Serving size"]} ${g.Type==="Solid"?"g":"ml"}</span>
      `,f.addEventListener("click",()=>{t==="food-a-search"?Bi(g):_i(g),We(t)})}s.appendChild(f)}r.appendChild(s)}function We(t){let i=document.getElementById(t).parentElement.querySelector(".search-dropdown");i&&i.remove(),ue=-1,Ge=""}function pt(t){if(!Ge)return;let e=document.getElementById(Ge);if(!e)return;let i=e.parentElement.querySelector(".search-dropdown");if(!i)return;let r=Array.from(i.querySelectorAll(".search-result-item"));r.length!==0&&(ue>=0&&ue<r.length&&r[ue].classList.remove("highlighted"),t==="down"?ue=(ue+1)%r.length:ue=ue<=0?r.length-1:ue-1,r[ue].classList.add("highlighted"),r[ue].scrollIntoView({block:"nearest",behavior:"smooth"}))}function gn(){if(!Ge||ue<0)return;let t=document.getElementById(Ge);if(!t)return;let n=t.parentElement.querySelector(".search-dropdown");if(!n)return;let i=Array.from(n.querySelectorAll(".search-result-item"));ue<i.length&&i[ue].click()}function Bi(t){let e={name:t.Food,type:t.Type==="Solid"?"SOLID":"LIQUID",gramsInServing:new L(t["Mean protein in grams"]),servingSize:new L(t["Serving size"]),getMgPerUnit:function(){return this.gramsInServing.times(1e3).dividedBy(this.servingSize)}};c=Sn(e,we),Ct(),Me(),yt(),X(),ie(),Ut(),document.getElementById("food-a-search").value=""}function _i(t){if(!c)return;let e={name:t.Food,type:t.Type==="Solid"?"SOLID":"LIQUID",gramsInServing:new L(t["Mean protein in grams"]),servingSize:new L(t["Serving size"]),getMgPerUnit:function(){return this.gramsInServing.times(1e3).dividedBy(this.servingSize)}},n={unit:e.type==="SOLID"?"g":"ml",amount:we.DEFAULT_FOOD_B_THRESHOLD};Ye(c,e,n),Me(),X(),ie(),document.getElementById("food-b-search").value=""}function Oi(t,e){let n={name:t||"Custom Food",type:"SOLID",gramsInServing:new L(10),servingSize:new L(100),getMgPerUnit:function(){return this.gramsInServing.times(1e3).dividedBy(this.servingSize)}};if(e==="food-a-search")c=Sn(n,we),Ct(),Me(),yt(),X(),ie(),Ut();else{if(!c)return;let i={unit:"g",amount:we.DEFAULT_FOOD_B_THRESHOLD};Ye(c,n,i),Me(),X(),ie()}document.getElementById(e).value=""}function Ci(t){let e={name:t.food_a.name,type:t.food_a.type==="SOLID"?"SOLID":"LIQUID",gramsInServing:new L(t.food_a.gramsInServing),servingSize:new L(t.food_a.servingSize),getMgPerUnit:function(){return this.gramsInServing.times(1e3).dividedBy(this.servingSize)}},n={dosingStrategy:hn[t.dosing_strategy],foodA:e,foodAStrategy:pn[t.food_a_strategy],diThreshold:new L(t.di_threshold),steps:[],config:we};t.custom_note&&(Le=t.custom_note);let i=[];n.foodAStrategy==="DILUTE_INITIAL"?i=t.table_di:n.foodAStrategy==="DILUTE_NONE"?i=t.table_dn:n.foodAStrategy==="DILUTE_ALL"&&(i=t.table_da);for(let r=0;r<i.length;r++){let o=i[r],s={stepIndex:r+1,targetMg:new L(o.protein),method:o.method==="DILUTE"?"DILUTE":"DIRECT",dailyAmount:new L(o.daily_amount),dailyAmountUnit:o.method==="DILUTE"?"ml":o.food===e.name?e.type==="SOLID"?"g":"ml":"g",food:o.food===e.name?"A":"B"};if(o.method==="DILUTE"){s.mixFoodAmount=new L(o.mix_amount),s.mixWaterAmount=new L(o.water_amount);let a=o.food===e.name?e:n.foodB,d=s.mixFoodAmount.times(a.getMgPerUnit());s.servings=d.dividedBy(s.targetMg)}n.steps.push(s)}t.food_b&&(n.foodB={name:t.food_b.name,type:t.food_b.type==="SOLID"?"SOLID":"LIQUID",gramsInServing:new L(t.food_b.gramsInServing),servingSize:new L(t.food_b.servingSize),getMgPerUnit:function(){return this.gramsInServing.times(1e3).dividedBy(this.servingSize)}},t.food_b_threshold&&(n.foodBThreshold={unit:n.foodB.type==="SOLID"?"g":"ml",amount:new L(t.food_b_threshold)})),c=n,Ct(),Me(),yt(),X(),ie(),Ut(),document.getElementById("food-a-search").value=""}function Ui(){c&&(c.foodB=void 0,c.foodBThreshold=void 0,et(),Me(),X(),ie())}function Ut(){let t=document.querySelector(".food-b-container");if(!t)return;if(c&&c.foodA){t.classList.remove("disabled");let n=document.getElementById("food-b-search"),i=document.getElementById("clear-food-b");n&&(n.disabled=!1),i&&(i.disabled=!1)}else{t.classList.add("disabled");let n=document.getElementById("food-b-search"),i=document.getElementById("clear-food-b");n&&(n.disabled=!0,n.value=""),i&&(i.disabled=!0)}}function Pi(){let t=document.getElementById("food-a-name");t&&t.addEventListener("input",d=>{c&&(c.foodA.name=d.target.value,X())});let e=document.getElementById("food-a-serving-size");e&&e.addEventListener("change",d=>{if(c){let l=parseFloat(d.target.value);l<=0&&(l=1),l>1e3&&(l=1e3),Number.isNaN(l)&&(l=1),d.target.value=l.toFixed(1),c.foodA.servingSize=new L(l),Ze()}});let n=document.getElementById("food-a-protein");n&&n.addEventListener("change",d=>{if(c){let l=parseFloat(d.target.value);l<0&&(l=0),l>c.foodA.servingSize.toNumber()&&(l=c.foodA.servingSize.toNumber()),Number.isNaN(l)&&(l=0),d.target.value=l.toFixed(1),c.foodA.gramsInServing=new L(l),Ze()}});let i=document.getElementById("food-a-threshold");i&&i.addEventListener("change",d=>{c&&(c.diThreshold=new L(d.target.value),Ze())});let r=document.getElementById("food-b-name");r&&r.addEventListener("input",d=>{c&&c.foodB&&(c.foodB.name=d.target.value,X())});let o=document.getElementById("food-b-serving-size");o&&o.addEventListener("change",d=>{if(c&&c.foodB){let l=parseFloat(d.target.value);if(l<=0&&(l=1),l>1e3&&(l=1e3),Number.isNaN(l)&&(l=1),d.target.value=l.toFixed(1),c.foodB.servingSize=new L(l),c.foodBThreshold){let u=c.foodB,f=c.foodBThreshold;c.foodB=void 0,c.foodBThreshold=void 0,et(),Ye(c,u,f),X(),ie()}}});let s=document.getElementById("food-b-protein");s&&s.addEventListener("change",d=>{if(c&&c.foodB){let l=parseFloat(d.target.value);if(l<0&&(l=0),l>c.foodB.servingSize.toNumber()&&(l=c.foodB.servingSize.toNumber()),Number.isNaN(l)&&(l=0),d.target.value=l.toFixed(1),c.foodB.gramsInServing=new L(l),c.foodBThreshold){let u=c.foodB,f=c.foodBThreshold;c.foodB=void 0,c.foodBThreshold=void 0,et(),Ye(c,u,f),X(),ie()}}});let a=document.getElementById("food-b-threshold");a&&a.addEventListener("change",d=>{if(c&&c.foodB&&c.foodBThreshold){c.foodBThreshold.amount=new L(d.target.value);let l=c.foodB,u=c.foodBThreshold;c.foodB=void 0,c.foodBThreshold=void 0,et(),Ye(c,l,u),X(),ie()}}),document.querySelectorAll("[data-action]").forEach(d=>{d.addEventListener("click",l=>{let u=l.target.getAttribute("data-action");if(c)switch(u){case"toggle-food-a-solid":c.foodA.type!=="SOLID"&&ht(!1);break;case"toggle-food-a-liquid":c.foodA.type!=="LIQUID"&&ht(!1);break;case"toggle-food-b-solid":c.foodB&&c.foodB.type!=="SOLID"&&ht(!0);break;case"toggle-food-b-liquid":c.foodB&&c.foodB.type!=="LIQUID"&&ht(!0);break;case"food-a-strategy-initial":c.foodAStrategy="DILUTE_INITIAL",Ze(),Me();break;case"food-a-strategy-all":c.foodAStrategy="DILUTE_ALL",Ze(),Me();break;case"food-a-strategy-none":c.foodAStrategy="DILUTE_NONE",Ze(),Me();break}})})}function Ri(){document.querySelectorAll("input.editable").forEach(t=>{t.addEventListener("blur",e=>{let n=e.target,i=parseInt(n.getAttribute("data-step")),r=n.getAttribute("data-field"),o=parseFloat(n.value);isNaN(o)||(o<0&&(o=0,n.value=o.toString()),r==="targetMg"?Mi(i,o):r==="dailyAmount"?xi(i,o):r==="mixFoodAmount"&&Fi(i,o))}),t.addEventListener("keydown",e=>{e.key==="Enter"&&e.target.blur()})}),document.querySelectorAll(".btn-add-step").forEach(t=>{t.addEventListener("click",e=>{let n=parseInt(e.target.getAttribute("data-step"));Di(n)})}),document.querySelectorAll(".btn-remove-step").forEach(t=>{t.addEventListener("click",e=>{let n=parseInt(e.target.getAttribute("data-step"));Ni(n)})})}function $i(){let t=document.getElementById("export-ascii");t&&t.addEventListener("click",Wi);let e=document.getElementById("export-pdf");e&&e.addEventListener("click",async()=>{let n=document.getElementById("export-pdf");n&&(n.textContent="Generating...",n.setAttribute("disabled","true"));try{let{jsPDF:i}=await import("./chunks/jspdf.es.min-UZJMZOSM.js"),{applyPlugin:r}=await import("./chunks/jspdf.plugin.autotable-HWF2UTYE.js");r(i),ki(i)}catch(i){console.error("Failed to load PDF libraries or generate PDF: ",i),alert("Error generating PDF. Please check the console for details.")}finally{n&&(n.textContent="Export PDF",n.removeAttribute("disabled"))}})}function Hi(){let t=document.getElementById("custom-note");if(!t)return;t.value=Le;let e=null;t.addEventListener("input",n=>{e!==null&&clearTimeout(e),e=window.setTimeout(()=>{let i=n.target.value,r=document.createElement("div");r.textContent=i,Le=r.textContent||""},300)})}function ki(t){if(!c)return;let e=new t({unit:"pt",format:"letter"}),n=40;e.setFontSize(18),e.setFont("helvetica","bold"),e.text("Oral Immunotherapy Protocol",40,n),n+=30;let i=c.foodA.type==="SOLID"?"g":"ml",r=An(c),o=c.steps.length;if(r>0){let u=[];for(let f=0;f<r;f++){let g=c.steps[f],v=c.foodA,x=`${ne(g.dailyAmount,g.dailyAmountUnit)} ${g.dailyAmountUnit}`,S="N/A";if(g.method==="DILUTE"){let Z=v.type==="SOLID"?"g":"ml";S=`${ne(g.mixFoodAmount,Z)} ${Z} food + ${ne(g.mixWaterAmount,"ml")} ml water`}f===o-1?u.push([g.stepIndex,`${O(g.targetMg,1)} mg`,g.method,S,x,"Continue long term"]):u.push([g.stepIndex,`${O(g.targetMg,1)} mg`,g.method,S,x,"2-4 weeks"])}e.setFontSize(14),e.setFont("helvetica","bold"),e.text(`${c.foodA.name}`,40,n),n+=20,e.setFontSize(10),e.setFont("helvetica","normal"),e.text(`Protein: ${O(c.foodA.gramsInServing,2)} g per ${c.foodA.servingSize} ${i} serving.`,40,n),n+=15,e.autoTable({startY:n,head:[["Step","Protein","Method","How to make mix","Daily Amount","Interval"]],body:u,theme:"striped",headStyles:{fillColor:[220,220,220],textColor:[0,0,0],fontStyle:"bold"},styles:{fontSize:9,cellPadding:6,overflow:"linebreak",valign:"middle",halign:"left"},columnStyles:{0:{halign:"center"},1:{halign:"center"},2:{halign:"center"}},margin:{left:40,right:40}}),n=e.lastAutoTable.finalY+20}if(c.foodB&&r<o){let u=c.foodB.type==="SOLID"?"g":"ml",f=[];for(let g=r;g<o;g++){let v=c.steps[g],x=`${ne(v.dailyAmount,v.dailyAmountUnit)} ${v.dailyAmountUnit}`,S="N/A";v.method==="DILUTE"&&console.log("A step for food B should never be diluted by design.",v),g===o-1?f.push([v.stepIndex,`${O(v.targetMg,1)} mg`,v.method,S,x,"Continue long term"]):f.push([v.stepIndex,`${O(v.targetMg,1)} mg`,v.method,S,x,"2-4 weeks"])}n>650&&(e.addPage(),n=40),n+=10,e.setFontSize(14),e.setFont("helvetica","bold"),e.text(`${c.foodB.name}`,40,n),n+=20,e.setFontSize(10),e.setFont("helvetica","normal"),e.text(`Protein: ${O(c.foodB.gramsInServing,2)} g per ${c.foodB.servingSize} ${u} serving`,40,n),n+=15,e.autoTable({startY:n,head:[["Step","Protein","Method","How to make mix","Daily Amount","Interval"]],body:f,theme:"striped",headStyles:{fillColor:[220,220,220],textColor:[0,0,0],fontStyle:"bold"},styles:{fontSize:9,cellPadding:6,overflow:"linebreak",valign:"middle",halign:"left"},columnStyles:{0:{halign:"center"},1:{halign:"center"},2:{halign:"center"}},margin:{left:40,right:40}}),n=e.lastAutoTable.finalY+20}if(Le&&Le.trim()){n>650&&(e.addPage(),n=40),e.setFontSize(14),e.setFont("helvetica","bold"),e.text("Notes",40,n),n+=15,e.setFontSize(10),e.setFont("helvetica","normal");let f=e.splitTextToSize(Le.trim(),520);for(let g of f)n>730&&(e.addPage(),n=40),e.text(g,40,n),n+=14}let s=e.internal.getNumberOfPages();for(let u=1;u<=s;u++)e.setPage(u),e.setFontSize(8),e.setFont("helvetica","italic"),e.setTextColor(100),e.text("",40,760),e.text("Always verify calculations before clinical use.",40,772),e.setTextColor(0);let a=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)||window.matchMedia&&window.matchMedia("(pointer: coarse)").matches||("ontouchstart"in window||navigator.maxTouchPoints>0)&&window.innerWidth<=1024,d=e.output("blob"),l=URL.createObjectURL(d);if(a){let u=document.createElement("a");u.href=l,u.download="protocol.pdf",u.style.display="none",document.body.appendChild(u),u.click(),document.body.removeChild(u),setTimeout(()=>{URL.revokeObjectURL(l)},100)}else{if(!window.open(l,"_blank")){let f=document.createElement("a");f.href=l,f.download="protocol.pdf",f.style.display="none",document.body.appendChild(f),f.click(),document.body.removeChild(f)}setTimeout(()=>{URL.revokeObjectURL(l)},1e3)}}function Wi(){if(!c)return;let t="",e="",n="",i=c.foodA.type==="SOLID"?"Solid":"Liquid",r=c.foodA.type==="SOLID"?"g":"ml";if(e+=`${c.foodA.name} (${i}). Protein: ${O(c.foodA.getMgPerUnit(),1)} mg/${r}`,c.foodB){let l=c.foodB.type==="SOLID"?"Solid":"Liquid",u=c.foodB.type==="SOLID"?"g":"ml";n+=`${c.foodB.name} (${l}). Protein: ${O(c.foodB.getMgPerUnit(),1)} mg/${u}`}let o=c.steps.length,s=An(c),a=new Bt.AsciiTable3(c.foodA.name),d=new Bt.AsciiTable3(c.foodB?.name);a.setHeading("Step","Protein","Method","Daily Amount","Mix Details"),d.setHeading("Step","Protein","Method","Daily Amount","Mix Details");for(let l of c.steps){let u=l.food==="B",f=u?c.foodB:c.foodA,g;u?g=d:g=a;let v=`${ne(l.dailyAmount,l.dailyAmountUnit)} ${l.dailyAmountUnit}`,x="N/A";if(l.method==="DILUTE"){let S=f.type==="SOLID"?"g":"ml";x=`${ne(l.mixFoodAmount,S)} ${S} food + ${ne(l.mixWaterAmount,"ml")} ml water`}g.addRow(l.stepIndex,`${O(l.targetMg,1)} mg`,l.method,x,v)}c.foodB?t+=e+`
`+n+`

`:t+=e+`

`,s>0&&(t+=a.toString()),s<o&&(t+=`--- TRANSITION TO: ---
`,t+=d.toString()),Le&&Le.trim()&&(t+=`========================================
`,t+=`NOTES
`,t+=`========================================
`,t+=`${Le.trim()}`),navigator.clipboard.writeText(t).catch(()=>{alert(`Failed to copy to clipboard. Please copy manually:

`+t)})}async function qi(){try{let t=await fetch("/tool_assets/typed_foods_rough.json"),e=await fetch("/tool_assets/custom_foods.json"),n=await t.json(),i=await e.json(),r=[...n,...i];_t=r.map(s=>({...s,prepared:Je.default.prepare(s.Food)})),Nt=await(await fetch("/tool_assets/oit_protocols.json")).json(),yn=Nt.map(s=>({...s,prepared:Je.default.prepare(s.name)})),console.log(`Loaded ${r.length} foods and ${Nt.length} protocols`)}catch(t){console.error("Error loading databases:",t),alert("Error loading food and protocol databases. Some features may not work.")}}async function mn(){await qi();let t=document.getElementById("url-container");t&&(wn=t.dataset.targetUrl);let e=document.getElementById("food-a-search");e&&(e.addEventListener("input",r=>{let o=r.target.value;Ve&&clearTimeout(Ve),Ve=window.setTimeout(()=>{let s=fn(o,"protocol");cn("food-a-search",s,o)},150)}),e.addEventListener("keydown",r=>{e.parentElement?.querySelector(".search-dropdown")&&(r.key==="ArrowDown"?(r.preventDefault(),pt("down")):r.key==="ArrowUp"?(r.preventDefault(),pt("up")):r.key==="Enter"?(r.preventDefault(),gn()):r.key==="Escape"&&We("food-a-search"))}),e.addEventListener("blur",()=>{setTimeout(()=>We("food-a-search"),200)}));let n=document.getElementById("food-b-search");n&&(n.addEventListener("input",r=>{let o=r.target.value;Ve&&clearTimeout(Ve),Ve=window.setTimeout(()=>{let s=fn(o,"food");cn("food-b-search",s,o)},150)}),n.addEventListener("keydown",r=>{n.parentElement?.querySelector(".search-dropdown")&&(r.key==="ArrowDown"?(r.preventDefault(),pt("down")):r.key==="ArrowUp"?(r.preventDefault(),pt("up")):r.key==="Enter"?(r.preventDefault(),gn()):r.key==="Escape"&&We("food-b-search"))}),n.addEventListener("blur",()=>{setTimeout(()=>We("food-b-search"),200)}));let i=document.getElementById("clear-food-b");i&&i.addEventListener("click",Ui),console.log("OIT Calculator initialized")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",mn):mn();
/*! Bundled license information:

ascii-table3/src/ascii-table3.js:
  (*!
   * Module exports.
   *)

decimal.js/decimal.mjs:
  (*!
   *  decimal.js v10.6.0
   *  An arbitrary-precision Decimal type for JavaScript.
   *  https://github.com/MikeMcl/decimal.js
   *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
   *  MIT Licence
   *)
*/
