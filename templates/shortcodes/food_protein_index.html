{% set data = load_data(path="static/tool_assets/cnf_extracted.csv") %}
<div class="food_protein_index">
  <!-- Search Bar -->
  <div class="search-container">
    <input type="text" id="food-search" placeholder="Search for foods..." class="search-input">
    <button id="clear-search" class="clear-btn">Clear</button>
  </div>
  <!-- Food Group Filter Buttons -->
  <div class="filter-container">
    <button class="filter-btn active" data-group="all">All Foods</button>
    {% set food_groups = [] %}
        {% for record in data.records %}
            {% if record[1] not in food_groups %}
                {% set_global food_groups = food_groups | concat(with=record[1]) %}
            {% endif %}
        {% endfor %}
        {% for group in food_groups | sort %}
    <button class="filter-btn" data-group="{{ group }}">{{ group }}</button>
    {% endfor %}
  </div>
  <!-- Results Count -->
  <div class="results-info">
    <span id="results-count">{{ data.records | length }} foods</span>
  </div>
  <!-- Food Table -->
  <div class="table-container">
    <table class="food-table" id="food-table">
      <thead>
        <tr>
          {% for header in data.headers %}
          <th>{{ header }}</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody id="food-table-body">
        {% for record in data.records %}
        <tr data-group="{{ record[1] }}" class="food-row">
          <td class="food-name">{{ record[0] }}</td>
          <td class="food-group" data-group="{{ record[1] }}">{{ record[1] }}</td>
          <td class="mean-value">{{ record[2] }}</td>
          <td class="standard-error">
            {% if record[3] %}
                                {{ record[3] }}
                            {% else %}
            <span class="no-data">â€”</span>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <!-- No Results Message -->
  <div id="no-results" class="no-results" style="display: none;">
    <p>No foods match your search criteria.</p>
  </div>
</div>
<!-- Load external scripts -->
<script src="https://cdn.jsdelivr.net/npm/fuzzysort@3.1.0/fuzzysort.min.js"></script>
<script src="/js/food_protein_index.js"></script>